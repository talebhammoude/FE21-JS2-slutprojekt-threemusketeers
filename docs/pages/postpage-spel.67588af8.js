!function(){function e(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r={},i={},a=n.parcelRequire9600;null==a&&((a=function(e){if(e in r)return r[e].exports;if(e in i){var t=i[e];delete i[e];var n={id:e,exports:{}};return r[e]=n,t.call(n.exports,n,n.exports),n.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){i[e]=t},n.parcelRequire9600=a),a.register("8k41w",(function(t,n){e(t.exports,"Post",(function(){return r}));var r=function(e,t,n,r){this.username=e,this.text=t,this.category=n,this.time=r}})),a.register("88RRX",(function(t,n){e(t.exports,"getFirestore",(function(){return a("221Dt").getFirestore})),e(t.exports,"addDoc",(function(){return a("221Dt").addDoc})),e(t.exports,"collection",(function(){return a("221Dt").collection})),e(t.exports,"deleteDoc",(function(){return a("221Dt").deleteDoc})),e(t.exports,"doc",(function(){return a("221Dt").doc})),e(t.exports,"query",(function(){return a("221Dt").query})),e(t.exports,"where",(function(){return a("221Dt").where})),e(t.exports,"orderBy",(function(){return a("221Dt").orderBy})),e(t.exports,"getDocs",(function(){return a("221Dt").getDocs})),a("221Dt")})),a.register("221Dt",(function(n,r){e(n.exports,"collection",(function(){return ms})),e(n.exports,"doc",(function(){return ks})),e(n.exports,"getFirestore",(function(){return Ts})),e(n.exports,"query",(function(){return no})),e(n.exports,"where",(function(){return io})),e(n.exports,"orderBy",(function(){return so})),e(n.exports,"getDocs",(function(){return vo})),e(n.exports,"deleteDoc",(function(){return yo})),e(n.exports,"addDoc",(function(){return po}));var i=a("8TSCy"),s=a("2TvXO"),o=a("MjY8E"),u=a("6ExWU"),c=a("kZfxc"),l=a("2xDiJ"),h=a("6RwJk"),f=(a("6qd2L"),"@firebase/firestore"),d=function(){"use strict";function e(t){i.classCallCheck(this,e),this.uid=t}return i.createClass(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),e}();d.UNAUTHENTICATED=new d(null),d.GOOGLE_CREDENTIALS=new d("google-credentials-uid"),d.FIRST_PARTY=new d("first-party-uid"),d.MOCK_USER=new d("mock-user");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var v="9.8.0",y=new c.Logger("@firebase/firestore");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p(){return y.logLevel}function g(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(y.logLevel<=c.LogLevel.DEBUG){var a,s=n.map(w);(a=y).debug.apply(a,["Firestore (".concat(v,"): ").concat(e)].concat(i.toConsumableArray(s)))}}function m(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(y.logLevel<=c.LogLevel.ERROR){var a,s=n.map(w);(a=y).error.apply(a,["Firestore (".concat(v,"): ").concat(e)].concat(i.toConsumableArray(s)))}}function k(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(y.logLevel<=c.LogLevel.WARN){var a,s=n.map(w);(a=y).warn.apply(a,["Firestore (".concat(v,"): ").concat(e)].concat(i.toConsumableArray(s)))}}function w(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(v,") INTERNAL ASSERTION FAILED: ")+e;throw m(t),new Error(t)}function T(e,t){e||C()}function b(e,t){return e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var E={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},S=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e,r){var a;return i.classCallCheck(this,n),(a=t.call(this,e,r)).code=e,a.message=r,a.toString=function(){return"".concat(a.name,": [code=").concat(a.code,"]: ").concat(a.message)},i.possibleConstructorReturn(a)}return n}(l.FirebaseError),I=function e(){"use strict";var t=this;i.classCallCheck(this,e),this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},x=function e(t,n){"use strict";i.classCallCheck(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))},A=function(){"use strict";function e(){i.classCallCheck(this,e)}return i.createClass(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(d.UNAUTHENTICATED)}))}},{key:"shutdown",value:function(){}}]),e}(),N=function(){"use strict";function e(t){i.classCallCheck(this,e),this.t=t,this.currentUser=d.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return i.createClass(e,[{key:"start",value:function(e,n){var r=this,a=this.i,o=function(e){return r.i!==a?(a=r.i,n(e)):Promise.resolve()},u=new I;this.o=function(){var t=r;r.i++,r.currentUser=r.u(),u.resolve(),u=new I,e.enqueueRetryable((function(){return o(t.currentUser)}))};var c=function(){var n=u,a=r;e.enqueueRetryable(i.asyncToGenerator(t(s).mark((function e(){return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.promise;case 2:return e.next=4,o(a.currentUser);case 4:case"end":return e.stop()}}),e)}))))},l=function(e){g("FirebaseAuthCredentialsProvider","Auth detected"),r.auth=e,r.auth.addAuthTokenListener(r.o),c()};this.t.onInit((function(e){return l(e)})),setTimeout((function(){if(!r.auth){var e=r.t.getImmediate({optional:!0});e?l(e):(g("FirebaseAuthCredentialsProvider","Auth not yet detected"),u.resolve(),u=new I)}}),0),c()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return e.i!==t?(g("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(T("string"==typeof n.accessToken),new x(n.accessToken,e.currentUser)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return T(null===e||"string"==typeof e),new d(e)}}]),e}(),_=function e(t,n,r){"use strict";i.classCallCheck(this,e),this.type="FirstParty",this.user=d.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);var a=t.auth.getAuthHeaderValueForFirstParty([]);a&&this.headers.set("Authorization",a),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)},D=function(){"use strict";function e(t,n,r){i.classCallCheck(this,e),this.h=t,this.l=n,this.m=r}return i.createClass(e,[{key:"getToken",value:function(){return Promise.resolve(new _(this.h,this.l,this.m))}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(d.FIRST_PARTY)}))}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),R=function e(t){"use strict";i.classCallCheck(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)},L=function(){"use strict";function e(t){i.classCallCheck(this,e),this.g=t,this.forceRefresh=!1,this.appCheck=null,this.p=null}return i.createClass(e,[{key:"start",value:function(e,t){var n=this;this.o=function(r){e.enqueueRetryable((function(){return function(e){null!=e.error&&g("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.p;return n.p=e.token,g("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()}(r)}))};var r=function(e){g("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.g.onInit((function(e){return r(e)})),setTimeout((function(){if(!n.appCheck){var e=n.g.getImmediate({optional:!0});e?r(e):g("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((function(t){return t?(T("string"==typeof t.token),e.p=t.token,new R(t.token)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}(),M=function(){"use strict";function e(t,n){var r=this;i.classCallCheck(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.I(e)},this.T=function(e){return n.writeSequenceNumber(e)})}return i.createClass(e,[{key:"I",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.T&&this.T(e),e}}]),e}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function V(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */M.A=-1;var O=function(){"use strict";function e(){i.classCallCheck(this,e)}return i.createClass(e,null,[{key:"R",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=V(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n}}]),e}();function P(e,t){return e<t?-1:e>t?1:0}function U(e,t,n){return e.length===t.length&&e.every((function(e,r){return n(e,t[r])}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var F=function(){"use strict";function e(t,n){if(i.classCallCheck(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new S(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new S(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new S(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new S(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return i.createClass(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?P(this.nanoseconds,e.nanoseconds):P(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}(),q=function(){"use strict";function e(t){i.classCallCheck(this,e),this.timestamp=t}return i.createClass(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new F(0,0))}},{key:"max",value:function(){return new e(new F(253402300799,999999999))}}]),e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function B(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function G(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function j(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var K=function(){"use strict";function e(t,n,r){i.classCallCheck(this,e),void 0===n?n=0:n>t.length&&C(),void 0===r?r=t.length-n:r>t.length-n&&C(),this.segments=t,this.offset=n,this.len=r}return i.createClass(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach((function(e){n.push(e)})):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),a=t.get(r);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),e}(),z=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(){return i.classCallCheck(this,n),t.apply(this,arguments)}return i.createClass(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var a=[],s=!0,o=!1,u=void 0;try{for(var c,l=t[Symbol.iterator]();!(s=(c=l.next()).done);s=!0){var h,f=c.value;if(f.indexOf("//")>=0)throw new S(E.INVALID_ARGUMENT,"Invalid segment (".concat(f,"). Paths must not contain // in them."));(h=a).push.apply(h,i.toConsumableArray(f.split("/").filter((function(e){return e.length>0}))))}}catch(e){o=!0,u=e}finally{try{s||null==l.return||l.return()}finally{if(o)throw u}}return new n(a)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(K),H=/^[_a-zA-Z][_a-zA-Z0-9]*$/,W=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(){return i.classCallCheck(this,n),t.apply(this,arguments)}return i.createClass(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().map((function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e})).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return H.test(e)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],r="",i=0,a=function(){if(0===r.length)throw new S(E.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""},s=!1;i<e.length;){var o=e[i];if("\\"===o){if(i+1===e.length)throw new S(E.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new S(E.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else"`"===o?(s=!s,i++):"."!==o||s?(r+=o,i++):(a(),i++)}if(a(),s)throw new S(E.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}(K),X=function(){"use strict";function e(t){i.classCallCheck(this,e),this.fields=t,t.sort(W.comparator)}return i.createClass(e,[{key:"covers",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.fields[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){if(i.value.isPrefixOf(e))return!0}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return!1}},{key:"isEqual",value:function(e){return U(this.fields,e.fields,(function(e,t){return e.isEqual(t)}))}}]),e}();var Q=Symbol.iterator,Y=function(){"use strict";function e(t){i.classCallCheck(this,e),this.binaryString=t}return i.createClass(e,[{key:Q,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){var e;return e=this.binaryString,btoa(e)}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return P(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(t){return new e(atob(t))}},{key:"fromUint8Array",value:function(t){return new e(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(t))}}]),e}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Y.EMPTY_BYTE_STRING=new Y("");var J=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Z(e){if(T(!!e),"string"==typeof e){var t=0,n=J.exec(e);if(T(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:$(e.seconds),nanos:$(e.nanos)}}function $(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function ee(e){return"string"==typeof e?Y.fromBase64String(e):Y.fromUint8Array(e)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function te(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ne(e){var t=e.mapValue.fields.__previous_value__;return te(t)?ne(t):t}function re(e){var t=Z(e.mapValue.fields.__local_write_time__.timestampValue);return new F(t.seconds,t.nanos)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ie=function e(t,n,r,a,s,o,u,c){"use strict";i.classCallCheck(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=a,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.useFetchStreams=c},ae=function(){"use strict";function e(t,n){i.classCallCheck(this,e),this.projectId=t,this.database=n||"(default)"}return i.createClass(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}],[{key:"empty",value:function(){return new e("","")}}]),e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function se(e){return null==e}function oe(e){return 0===e&&1/e==-1/0}function ue(e){return"number"==typeof e&&Number.isInteger(e)&&!oe(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ce=function(){"use strict";function e(t){i.classCallCheck(this,e),this.path=t}return i.createClass(e,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===z.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(z.fromString(t))}},{key:"fromName",value:function(t){return new e(z.fromString(t).popFirst(5))}},{key:"empty",value:function(){return new e(z.emptyPath())}},{key:"comparator",value:function(e,t){return z.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new z(t.slice()))}}]),e}(),le={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function he(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?te(e)?4:Se(e)?9007199254740991:10:C()}function fe(e,t){if(e===t)return!0;var n,r=he(e);if(r!==he(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return re(e).isEqual(re(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=Z(e.timestampValue),r=Z(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return n=t,ee(e.bytesValue).isEqual(ee(n.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return $(e.geoPointValue.latitude)===$(t.geoPointValue.latitude)&&$(e.geoPointValue.longitude)===$(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return $(e.integerValue)===$(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=$(e.doubleValue),r=$(t.doubleValue);return n===r?oe(n)===oe(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return U(e.arrayValue.values||[],t.arrayValue.values||[],fe);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(B(n)!==B(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!fe(n[i],r[i])))return!1;return!0}(e,t);default:return C()}}function de(e,t){return void 0!==(e.values||[]).find((function(e){return fe(e,t)}))}function ve(e,t){if(e===t)return 0;var n,r,i,a,s=he(e),o=he(t);if(s!==o)return P(s,o);switch(s){case 0:case 9007199254740991:return 0;case 1:return P(e.booleanValue,t.booleanValue);case 2:return r=t,i=$((n=e).integerValue||n.doubleValue),a=$(r.integerValue||r.doubleValue),i<a?-1:i>a?1:i===a?0:isNaN(i)?isNaN(a)?0:-1:1;case 3:return ye(e.timestampValue,t.timestampValue);case 4:return ye(re(e),re(t));case 5:return P(e.stringValue,t.stringValue);case 6:return function(e,t){var n=ee(e),r=ee(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var a=P(n[i],r[i]);if(0!==a)return a}return P(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=P($(e.latitude),$(t.latitude));return 0!==n?n:P($(e.longitude),$(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var a=ve(n[i],r[i]);if(a)return a}return P(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===le.mapValue&&t===le.mapValue)return 0;if(e===le.mapValue)return 1;if(t===le.mapValue)return-1;var n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(var s=0;s<r.length&&s<a.length;++s){var o=P(r[s],a[s]);if(0!==o)return o;var u=ve(n[r[s]],i[a[s]]);if(0!==u)return u}return P(r.length,a.length)}(e.mapValue,t.mapValue);default:throw C()}}function ye(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return P(e,t);var n=Z(e),r=Z(t),i=P(n.seconds,r.seconds);return 0!==i?i:P(n.nanos,r.nanos)}function pe(e){return ge(e)}function ge(e){var t,n,r,i;return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?(r=e.timestampValue,i=Z(r),"time(".concat(i.seconds,",").concat(i.nanos,")")):"stringValue"in e?e.stringValue:"bytesValue"in e?ee(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,ce.fromName(n).toString()):"geoPointValue"in e?"geo(".concat((t=e.geoPointValue).latitude,",").concat(t.longitude,")"):"arrayValue"in e?function(e){var t="[",n=!0,r=!0,i=!1,a=void 0;try{for(var s,o=(e.values||[])[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value;n?n=!1:t+=",",t+=ge(u)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return t+"]"}(e.arrayValue):"mapValue"in e?function(e){var t=Object.keys(e.fields||{}).sort(),n="{",r=!0,i=!0,a=!1,s=void 0;try{for(var o,u=t[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var c=o.value;r?r=!1:n+=",",n+="".concat(c,":").concat(ge(e.fields[c]))}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}return n+"}"}(e.mapValue):C()}function me(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function ke(e){return!!e&&"integerValue"in e}function we(e){return!!e&&"arrayValue"in e}function Ce(e){return!!e&&"nullValue"in e}function Te(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function be(e){return!!e&&"mapValue"in e}function Ee(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return G(e.mapValue.fields,(function(e,n){return t.mapValue.fields[e]=Ee(n)})),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Ee(e.arrayValue.values[r]);return n}return Object.assign({},e)}function Se(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ie=function(){"use strict";function e(t){i.classCallCheck(this,e),this.value=t}return i.createClass(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!be(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ee(t)}},{key:"setAll",value:function(e){var t=this,n=W.emptyPath(),r={},i=[];e.forEach((function(e,a){if(!n.isImmediateParentOf(a)){var s=t.getFieldsMap(n);t.applyChanges(s,r,i),r={},i=[],n=a.popLast()}e?r[a.lastSegment()]=Ee(e):i.push(a.lastSegment())}));var a=this.getFieldsMap(n);this.applyChanges(a,r,i)}},{key:"delete",value:function(e){var t=this.field(e.popLast());be(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return fe(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];be(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){G(t,(function(t,n){return e[t]=n}));var r=!0,i=!1,a=void 0;try{for(var s,o=n[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value;delete e[u]}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}}},{key:"clone",value:function(){return new e(Ee(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function xe(e){var t=[];return G(e.fields,(function(e,n){var r=new W([e]);if(be(n)){var i=xe(n.mapValue).fields,a=!0,s=!1,o=void 0;if(0===i.length)t.push(r);else try{for(var u,c=i[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;t.push(r.child(l))}}catch(e){s=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw o}}}else t.push(r)})),new X(t)
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var Ae=function(){"use strict";function e(t,n,r,a,s,o){i.classCallCheck(this,e),this.key=t,this.documentType=n,this.version=r,this.readTime=a,this.data=s,this.documentState=o}return i.createClass(e,[{key:"convertToFoundDocument",value:function(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=Ie.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=Ie.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,q.min(),q.min(),Ie.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r){return new e(t,1,n,q.min(),r,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,q.min(),Ie.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,q.min(),Ie.empty(),2)}}]),e}(),Ne=function e(t,n,r,a){"use strict";i.classCallCheck(this,e),this.indexId=t,this.collectionGroup=n,this.fields=r,this.indexState=a};Ne.UNKNOWN_ID=-1;function _e(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=q.fromTimestamp(1e9===r?new F(n+1,0):new F(n,r));return new Re(i,ce.empty(),t)}function De(e){return new Re(e.readTime,e.key,-1)}var Re=function(){"use strict";function e(t,n,r){i.classCallCheck(this,e),this.readTime=t,this.documentKey=n,this.largestBatchId=r}return i.createClass(e,null,[{key:"min",value:function(){return new e(q.min(),ce.empty(),-1)}},{key:"max",value:function(){return new e(q.max(),ce.empty(),-1)}}]),e}();function Le(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=ce.comparator(e.documentKey,t.documentKey))?n:P(e.largestBatchId,t.largestBatchId)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Me=function(){"use strict";function e(t,n){i.classCallCheck(this,e),this.comparator=t,this.root=n||Oe.EMPTY}return i.createClass(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Oe.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Oe.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal((function(t,n){return e(t,n),!1}))}},{key:"toString",value:function(){var e=[];return this.inorderTraversal((function(t,n){return e.push("".concat(t,":").concat(n)),!1})),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new Ve(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new Ve(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new Ve(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new Ve(this.root,e,this.comparator,!0)}}]),e}(),Ve=function(){"use strict";function e(t,n,r,a){i.classCallCheck(this,e),this.isReverse=a,this.nodeStack=[];for(var s=1;!t.isEmpty();)if(s=n?r(t.key,n):1,n&&a&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(0===s){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return i.createClass(e,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),e}(),Oe=function(){"use strict";function e(t,n,r,a,s){i.classCallCheck(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=a?a:e.EMPTY,this.right=null!=s?s:e.EMPTY,this.size=this.left.size+1+this.right.size}return i.createClass(e,[{key:"copy",value:function(t,n,r,i,a){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=a?a:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed())throw C();if(this.right.isRed())throw C();var e=this.left.check();if(e!==this.right.check())throw C();return e+(this.isRed()?0:1)}}]),e}();Oe.EMPTY=null,Oe.RED=!0,Oe.BLACK=!1,Oe.EMPTY=new(function(){"use strict";function e(){i.classCallCheck(this,e),this.size=0}return i.createClass(e,[{key:"key",get:function(){throw C()}},{key:"value",get:function(){throw C()}},{key:"color",get:function(){throw C()}},{key:"left",get:function(){throw C()}},{key:"right",get:function(){throw C()}},{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new Oe(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Pe=function(){"use strict";function e(t){i.classCallCheck(this,e),this.comparator=t,this.data=new Me(this.comparator)}return i.createClass(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new Ue(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new Ue(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach((function(e){t=t.add(e)})),t}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach((function(t){e.push(t)})),e}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){return e.push(t)})),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),Ue=function(){"use strict";function e(t){i.classCallCheck(this,e),this.iter=t}return i.createClass(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Fe=function e(t){"use strict";var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;i.classCallCheck(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=a,this.limit=s,this.startAt=o,this.endAt=u,this.P=null};function qe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new Fe(e,t,n,r,i,a,s)}function Be(e){var t=b(e);if(null===t.P){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map((function(e){var t;return(t=e).field.canonicalString()+t.op.toString()+pe(t.value)})).join(","),n+="|ob:",n+=t.orderBy.map((function(e){return(t=e).field.canonicalString()+t.dir;var t})).join(","),se(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((function(e){return pe(e)})).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((function(e){return pe(e)})).join(",")),t.P=n}return t.P}function Ge(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!tt(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(i=e.filters[r],a=t.filters[r],i.op!==a.op||!i.field.isEqual(a.field)||!fe(i.value,a.value))return!1;var i,a;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!rt(e.startAt,t.startAt)&&rt(e.endAt,t.endAt)}function je(e){return ce.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}var Ke=function(e){"use strict";i.inherits(n,(function e(){i.classCallCheck(this,e)}));var t=i.createSuper(n);function n(e,r,a){var s;return i.classCallCheck(this,n),(s=t.call(this)).field=e,s.op=r,s.value=a,i.possibleConstructorReturn(s)}return i.createClass(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.v(ve(t,this.value)):null!==t&&he(this.value)===he(t)&&this.v(ve(t,this.value))}},{key:"v",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return C()}}},{key:"S",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}],[{key:"create",value:function(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.V(e,t,r):new ze(e,t,r):"array-contains"===t?new Qe(e,r):"in"===t?new Ye(e,r):"not-in"===t?new Je(e,r):"array-contains-any"===t?new Ze(e,r):new n(e,t,r)}},{key:"V",value:function(e,t,n){return"in"===t?new He(e,n):new We(e,n)}}]),n}(),ze=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e,r,a){var s;return i.classCallCheck(this,n),(s=t.call(this,e,r,a)).key=ce.fromName(a.referenceValue),i.possibleConstructorReturn(s)}return i.createClass(n,[{key:"matches",value:function(e){var t=ce.comparator(e.key,this.key);return this.v(t)}}]),n}(Ke),He=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e,r){var a;return i.classCallCheck(this,n),(a=t.call(this,e,"in",r)).keys=Xe("in",r),i.possibleConstructorReturn(a)}return i.createClass(n,[{key:"matches",value:function(e){return this.keys.some((function(t){return t.isEqual(e.key)}))}}]),n}(Ke),We=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e,r){var a;return i.classCallCheck(this,n),(a=t.call(this,e,"not-in",r)).keys=Xe("not-in",r),i.possibleConstructorReturn(a)}return i.createClass(n,[{key:"matches",value:function(e){return!this.keys.some((function(t){return t.isEqual(e.key)}))}}]),n}(Ke);function Xe(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(e){return ce.fromName(e.referenceValue)}))}var Qe=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e,r){return i.classCallCheck(this,n),t.call(this,e,"array-contains",r)}return i.createClass(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return we(t)&&de(t.arrayValue,this.value)}}]),n}(Ke),Ye=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e,r){return i.classCallCheck(this,n),t.call(this,e,"in",r)}return i.createClass(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&de(this.value.arrayValue,t)}}]),n}(Ke),Je=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e,r){return i.classCallCheck(this,n),t.call(this,e,"not-in",r)}return i.createClass(n,[{key:"matches",value:function(e){if(de(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!de(this.value.arrayValue,t)}}]),n}(Ke),Ze=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e,r){return i.classCallCheck(this,n),t.call(this,e,"array-contains-any",r)}return i.createClass(n,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!we(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(e){return de(t.value.arrayValue,e)}))}}]),n}(Ke),$e=function e(t,n){"use strict";i.classCallCheck(this,e),this.position=t,this.inclusive=n},et=function e(t){"use strict";var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";i.classCallCheck(this,e),this.field=t,this.dir=n};function tt(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function nt(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var a=t[i],s=e.position[i];if(r=a.field.isKeyField()?ce.comparator(ce.fromName(s.referenceValue),n.key):ve(s,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function rt(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!fe(e.position[n],t.position[n]))return!1;return!0}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var it=function e(t){"use strict";var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;i.classCallCheck(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=a,this.limit=s,this.limitType=o,this.startAt=u,this.endAt=c,this.D=null,this.C=null,this.startAt,this.endAt};function at(e,t,n,r,i,a,s,o){return new it(e,t,n,r,i,a,s,o)}function st(e){return new it(e)}function ot(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function ut(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e.filters[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;if(s.S())return s.field}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return null}function ct(e){return null!==e.collectionGroup}function lt(e){var t=b(e);if(null===t.D){t.D=[];var n=ut(t),r=ot(t);if(null!==n&&null===r)n.isKeyField()||t.D.push(new et(n)),t.D.push(new et(W.keyField(),"asc"));else{var i=!1,a=!0,s=!1,o=void 0;try{for(var u,c=t.explicitOrderBy[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;t.D.push(l),l.field.isKeyField()&&(i=!0)}}catch(e){s=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw o}}if(!i){var h=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.D.push(new et(W.keyField(),h))}}}return t.D}function ht(e){var t=b(e);if(!t.C)if("F"===t.limitType)t.C=qe(t.path,t.collectionGroup,lt(t),t.filters,t.limit,t.startAt,t.endAt);else{var n=[],r=!0,i=!1,a=void 0;try{for(var s,o=lt(t)[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value,c="desc"===u.dir?"asc":"desc";n.push(new et(u.field,c))}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}var l=t.endAt?new $e(t.endAt.position,t.endAt.inclusive):null,h=t.startAt?new $e(t.startAt.position,t.startAt.inclusive):null;t.C=qe(t.path,t.collectionGroup,n,t.filters,t.limit,l,h)}return t.C}function ft(e,t,n){return new it(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function dt(e,t){return Ge(ht(e),ht(t))&&e.limitType===t.limitType}function vt(e){return"".concat(Be(ht(e)),"|lt:").concat(e.limitType)}function yt(e){return"Query(target=".concat((t=ht(e),n=t.path.canonicalString(),null!==t.collectionGroup&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=", filters: [".concat(t.filters.map((function(e){var t;return"".concat((t=e).field.canonicalString()," ").concat(t.op," ").concat(pe(t.value))})).join(", "),"]")),se(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=", orderBy: [".concat(t.orderBy.map((function(e){return"".concat((t=e).field.canonicalString()," (").concat(t.dir,")");var t})).join(", "),"]")),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((function(e){return pe(e)})).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((function(e){return pe(e)})).join(",")),"Target(".concat(n,")")),"; limitType=").concat(e.limitType,")");var t,n}function pt(e,t){return t.isFoundDocument()&&(i=e,s=(a=t).key.path,null!==i.collectionGroup?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):ce.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s))&&function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,s=e.explicitOrderBy[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;if(!o.field.isKeyField()&&null===t.data.field(o.field))return!1}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return!0}(e,t)&&function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,s=e.filters[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){if(!a.value.matches(t))return!1}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return!0}(e,t)&&(r=t,!((n=e).startAt&&!function(e,t,n){var r=nt(e,t,n);return e.inclusive?r<=0:r<0}(n.startAt,lt(n),r)||n.endAt&&!function(e,t,n){var r=nt(e,t,n);return e.inclusive?r>=0:r>0}(n.endAt,lt(n),r)));var n,r,i,a,s}function gt(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function mt(e){return function(t,n){var r=!1,i=!0,a=!1,s=void 0;try{for(var o,u=lt(e)[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var c=o.value,l=kt(c,t,n);if(0!==l)return l;r=r||c.field.isKeyField()}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}return 0}}function kt(e,t,n){var r,i,a,s,o=e.field.isKeyField()?ce.comparator(t.key,n.key):(r=e.field,i=n,a=t.data.field(r),s=i.data.field(r),null!==a&&null!==s?ve(a,s):C());switch(e.dir){case"asc":return o;case"desc":return-1*o;default:return C()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wt(e,t){if(e.N){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:oe(t)?"-0":t}}function Ct(e){return{integerValue:""+e}}function Tt(e,t){return ue(t)?Ct(t):wt(e,t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bt=function e(){"use strict";i.classCallCheck(this,e),this._=void 0};function Et(e,t,n){return e instanceof xt?(i=t,a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:(r=n).seconds,nanos:r.nanoseconds}}}},i&&(a.fields.__previous_value__=i),{mapValue:a}):e instanceof At?Nt(e,t):e instanceof _t?Dt(e,t):function(e,t){var n=It(e,t),r=Lt(n)+Lt(e.k);return ke(n)&&ke(e.k)?Ct(r):wt(e.M,r)}(e,t);var r,i,a}function St(e,t,n){return e instanceof At?Nt(e,t):e instanceof _t?Dt(e,t):n}function It(e,t){var n,r;return e instanceof Rt?ke(n=t)||(r=n)&&"doubleValue"in r?t:{integerValue:0}:null}var xt=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(){return i.classCallCheck(this,n),t.apply(this,arguments)}return n}(bt),At=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e){var r;return i.classCallCheck(this,n),(r=t.call(this)).elements=e,i.possibleConstructorReturn(r)}return n}(bt);function Nt(e,t){var n=Mt(t),r=!0,i=!1,a=void 0;try{for(var s,o=function(e,t){var r=t.value;n.some((function(e){return fe(e,r)}))||n.push(r)},u=e.elements[Symbol.iterator]();!(r=(s=u.next()).done);r=!0)o(0,s)}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return{arrayValue:{values:n}}}var _t=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e){var r;return i.classCallCheck(this,n),(r=t.call(this)).elements=e,i.possibleConstructorReturn(r)}return n}(bt);function Dt(e,t){var n=Mt(t),r=!0,i=!1,a=void 0;try{for(var s,o=function(e,t){var r=t.value;n=n.filter((function(e){return!fe(e,r)}))},u=e.elements[Symbol.iterator]();!(r=(s=u.next()).done);r=!0)o(0,s)}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return{arrayValue:{values:n}}}var Rt=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e,r){var a;return i.classCallCheck(this,n),(a=t.call(this)).M=e,a.k=r,i.possibleConstructorReturn(a)}return n}(bt);function Lt(e){return $(e.integerValue||e.doubleValue)}function Mt(e){return we(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vt=function e(t,n){"use strict";i.classCallCheck(this,e),this.version=t,this.transformResults=n},Ot=function(){"use strict";function e(t,n){i.classCallCheck(this,e),this.updateTime=t,this.exists=n}return i.createClass(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function Pt(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var Ut=function e(){"use strict";i.classCallCheck(this,e)};function Ft(e,t,n){var r,i,a,s,o;e instanceof Kt?(i=t,a=n,s=(r=e).value.clone(),o=Wt(r.fieldTransforms,i,a.transformResults),s.setAll(o),i.convertToFoundDocument(a.version,s).setHasCommittedMutations()):e instanceof zt?function(e,t,n){if(Pt(e.precondition,t)){var r=Wt(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Ht(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function qt(e,t,n){var r;e instanceof Kt?function(e,t,n){if(Pt(e.precondition,t)){var r=e.value.clone(),i=Xt(e.fieldTransforms,n,t);r.setAll(i),t.convertToFoundDocument(jt(t),r).setHasLocalMutations()}}(e,t,n):e instanceof zt?function(e,t,n){if(Pt(e.precondition,t)){var r=Xt(e.fieldTransforms,n,t),i=t.data;i.setAll(Ht(e)),i.setAll(r),t.convertToFoundDocument(jt(t),i).setHasLocalMutations()}}(e,t,n):(r=t,Pt(e.precondition,r)&&r.convertToNoDocument(q.min()))}function Bt(e,t){var n=null,r=!0,i=!1,a=void 0;try{for(var s,o=e.fieldTransforms[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value,c=t.data.field(u.field),l=It(u.transform,c||null);null!=l&&(null==n&&(n=Ie.empty()),n.set(u.field,l))}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n||null}function Gt(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(n=e.fieldTransforms,r=t.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&U(n,r,(function(e,t){return function(e,t){return e.field.isEqual(t.field)&&(n=e.transform,r=t.transform,n instanceof At&&r instanceof At||n instanceof _t&&r instanceof _t?U(n.elements,r.elements,fe):n instanceof Rt&&r instanceof Rt?fe(n.k,r.k):n instanceof xt&&r instanceof xt);var n,r}(e,t)}))))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask));var n,r}function jt(e){return e.isFoundDocument()?e.version:q.min()}var Kt=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e,r,a){var s,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return i.classCallCheck(this,n),(s=t.call(this)).key=e,s.value=r,s.precondition=a,s.fieldTransforms=o,s.type=0,i.possibleConstructorReturn(s)}return n}(Ut),zt=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e,r,a,s){var o,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return i.classCallCheck(this,n),(o=t.call(this)).key=e,o.data=r,o.fieldMask=a,o.precondition=s,o.fieldTransforms=u,o.type=1,i.possibleConstructorReturn(o)}return n}(Ut);function Ht(e){var t=new Map;return e.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}})),t}function Wt(e,t,n){var r=new Map;T(e.length===n.length);for(var i=0;i<n.length;i++){var a=e[i],s=a.transform,o=t.data.field(a.field);r.set(a.field,St(s,o,n[i]))}return r}function Xt(e,t,n){var r=new Map,i=!0,a=!1,s=void 0;try{for(var o,u=e[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var c=o.value,l=c.transform,h=n.data.field(c.field);r.set(c.field,Et(l,h,t))}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}return r}var Qt,Yt,Jt=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e,r){var a;return i.classCallCheck(this,n),(a=t.call(this)).key=e,a.precondition=r,a.type=2,a.fieldTransforms=[],i.possibleConstructorReturn(a)}return n}(Ut),Zt=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e,r){var a;return i.classCallCheck(this,n),(a=t.call(this)).key=e,a.precondition=r,a.type=3,a.fieldTransforms=[],i.possibleConstructorReturn(a)}return n}(Ut),$t=function e(t){"use strict";i.classCallCheck(this,e),this.count=t};function en(e){switch(e){default:return C();case E.CANCELLED:case E.UNKNOWN:case E.DEADLINE_EXCEEDED:case E.RESOURCE_EXHAUSTED:case E.INTERNAL:case E.UNAVAILABLE:case E.UNAUTHENTICATED:return!1;case E.INVALID_ARGUMENT:case E.NOT_FOUND:case E.ALREADY_EXISTS:case E.PERMISSION_DENIED:case E.FAILED_PRECONDITION:case E.ABORTED:case E.OUT_OF_RANGE:case E.UNIMPLEMENTED:case E.DATA_LOSS:return!0}}function tn(e){if(void 0===e)return m("GRPC error has no .code"),E.UNKNOWN;switch(e){case Qt.OK:return E.OK;case Qt.CANCELLED:return E.CANCELLED;case Qt.UNKNOWN:return E.UNKNOWN;case Qt.DEADLINE_EXCEEDED:return E.DEADLINE_EXCEEDED;case Qt.RESOURCE_EXHAUSTED:return E.RESOURCE_EXHAUSTED;case Qt.INTERNAL:return E.INTERNAL;case Qt.UNAVAILABLE:return E.UNAVAILABLE;case Qt.UNAUTHENTICATED:return E.UNAUTHENTICATED;case Qt.INVALID_ARGUMENT:return E.INVALID_ARGUMENT;case Qt.NOT_FOUND:return E.NOT_FOUND;case Qt.ALREADY_EXISTS:return E.ALREADY_EXISTS;case Qt.PERMISSION_DENIED:return E.PERMISSION_DENIED;case Qt.FAILED_PRECONDITION:return E.FAILED_PRECONDITION;case Qt.ABORTED:return E.ABORTED;case Qt.OUT_OF_RANGE:return E.OUT_OF_RANGE;case Qt.UNIMPLEMENTED:return E.UNIMPLEMENTED;case Qt.DATA_LOSS:return E.DATA_LOSS;default:return C()}}(Yt=Qt||(Qt={}))[Yt.OK=0]="OK",Yt[Yt.CANCELLED=1]="CANCELLED",Yt[Yt.UNKNOWN=2]="UNKNOWN",Yt[Yt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Yt[Yt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Yt[Yt.NOT_FOUND=5]="NOT_FOUND",Yt[Yt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Yt[Yt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Yt[Yt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Yt[Yt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Yt[Yt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Yt[Yt.ABORTED=10]="ABORTED",Yt[Yt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Yt[Yt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Yt[Yt.INTERNAL=13]="INTERNAL",Yt[Yt.UNAVAILABLE=14]="UNAVAILABLE",Yt[Yt.DATA_LOSS=15]="DATA_LOSS";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var nn=function(){"use strict";function e(t,n){i.classCallCheck(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}return i.createClass(e,[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r=!0,a=!1,s=void 0;try{for(var o,u=n[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var c=i.slicedToArray(o.value,2),l=c[0],h=c[1];if(this.equalsFn(l,e))return h}}catch(e){a=!0,s=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw s}}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(e){G(this.inner,(function(t,n){var r=!0,a=!1,s=void 0;try{for(var o,u=n[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var c=i.slicedToArray(o.value,2),l=c[0],h=c[1];e(l,h)}}catch(e){a=!0,s=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw s}}}))}},{key:"isEmpty",value:function(){return j(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),e}(),rn=new Me(ce.comparator);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function an(){return rn}var sn=new Me(ce.comparator);function on(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=sn,i=!0,a=!1,s=void 0;try{for(var o,u=t[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var c=o.value;r=r.insert(c.key,c)}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}return r}function un(){return new nn((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)}))}var cn=new Me(ce.comparator),ln=new Pe(ce.comparator);function hn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=ln,i=!0,a=!1,s=void 0;try{for(var o,u=t[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var c=o.value;r=r.add(c)}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}return r}var fn=new Pe(P);function dn(){return fn}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vn=function(){"use strict";function e(t,n,r,a,s){i.classCallCheck(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=s}return i.createClass(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n){var r=new Map;return r.set(t,yn.createSynthesizedTargetChangeForCurrentChange(t,n)),new e(q.min(),r,dn(),an(),hn())}}]),e}(),yn=function(){"use strict";function e(t,n,r,a,s){i.classCallCheck(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=s}return i.createClass(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n){return new e(Y.EMPTY_BYTE_STRING,n,hn(),hn(),hn())}}]),e}(),pn=function e(t,n,r,a){"use strict";i.classCallCheck(this,e),this.O=t,this.removedTargetIds=n,this.key=r,this.F=a},gn=function e(t,n){"use strict";i.classCallCheck(this,e),this.targetId=t,this.$=n},mn=function e(t,n){"use strict";var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Y.EMPTY_BYTE_STRING,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;i.classCallCheck(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=a},kn=function(){"use strict";function e(){i.classCallCheck(this,e),this.B=0,this.L=Tn(),this.U=Y.EMPTY_BYTE_STRING,this.q=!1,this.K=!0}return i.createClass(e,[{key:"current",get:function(){return this.q}},{key:"resumeToken",get:function(){return this.U}},{key:"G",get:function(){return 0!==this.B}},{key:"j",get:function(){return this.K}},{key:"W",value:function(e){e.approximateByteSize()>0&&(this.K=!0,this.U=e)}},{key:"H",value:function(){var e=hn(),t=hn(),n=hn();return this.L.forEach((function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:C()}})),new yn(this.U,this.q,e,t,n)}},{key:"J",value:function(){this.K=!1,this.L=Tn()}},{key:"Y",value:function(e,t){this.K=!0,this.L=this.L.insert(e,t)}},{key:"X",value:function(e){this.K=!0,this.L=this.L.remove(e)}},{key:"Z",value:function(){this.B+=1}},{key:"tt",value:function(){this.B-=1}},{key:"et",value:function(){this.K=!0,this.q=!0}}]),e}(),wn=function(){"use strict";function e(t){i.classCallCheck(this,e),this.nt=t,this.st=new Map,this.it=an(),this.rt=Cn(),this.ot=new Pe(P)}return i.createClass(e,[{key:"ut",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e.O[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;e.F&&e.F.isFoundDocument()?this.at(s,e.F):this.ct(s,e.key,e.F)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}var o=!0,u=!1,c=void 0;try{for(var l,h=e.removedTargetIds[Symbol.iterator]();!(o=(l=h.next()).done);o=!0){var f=l.value;this.ct(f,e.key,e.F)}}catch(e){u=!0,c=e}finally{try{o||null==h.return||h.return()}finally{if(u)throw c}}}},{key:"ht",value:function(e){var t=this;this.forEachTarget(e,(function(n){var r=t.lt(n);switch(e.state){case 0:t.ft(n)&&r.W(e.resumeToken);break;case 1:r.tt(),r.G||r.J(),r.W(e.resumeToken);break;case 2:r.tt(),r.G||t.removeTarget(n);break;case 3:t.ft(n)&&(r.et(),r.W(e.resumeToken));break;case 4:t.ft(n)&&(t.dt(n),r.W(e.resumeToken));break;default:C()}}))}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.st.forEach((function(e,r){n.ft(r)&&t(r)}))}},{key:"_t",value:function(e){var t=e.targetId,n=e.$.count,r=this.wt(t);if(r){var i=r.target;if(je(i))if(0===n){var a=new ce(i.path);this.ct(t,a,Ae.newNoDocument(a,q.min()))}else T(1===n);else this.gt(t)!==n&&(this.dt(t),this.ot=this.ot.add(t))}}},{key:"yt",value:function(e){var t=this,n=new Map;this.st.forEach((function(r,i){var a=t.wt(i);if(a){if(r.current&&je(a.target)){var s=new ce(a.target.path);null!==t.it.get(s)||t.It(i,s)||t.ct(i,s,Ae.newNoDocument(s,e))}r.j&&(n.set(i,r.H()),r.J())}}));var r=hn();this.rt.forEach((function(e,n){var i=t,a=!0;n.forEachWhile((function(e){var t=i.wt(e);return!t||2===t.purpose||(a=!1,!1)})),a&&(r=r.add(e))})),this.it.forEach((function(t,n){return n.setReadTime(e)}));var i=new vn(e,n,this.ot,this.it,r);return this.it=an(),this.rt=Cn(),this.ot=new Pe(P),i}},{key:"at",value:function(e,t){if(this.ft(e)){var n=this.It(e,t.key)?2:0;this.lt(e).Y(t.key,n),this.it=this.it.insert(t.key,t),this.rt=this.rt.insert(t.key,this.Tt(t.key).add(e))}}},{key:"ct",value:function(e,t,n){if(this.ft(e)){var r=this.lt(e);this.It(e,t)?r.Y(t,1):r.X(t),this.rt=this.rt.insert(t,this.Tt(t).delete(e)),n&&(this.it=this.it.insert(t,n))}}},{key:"removeTarget",value:function(e){this.st.delete(e)}},{key:"gt",value:function(e){var t=this.lt(e).H();return this.nt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"Z",value:function(e){this.lt(e).Z()}},{key:"lt",value:function(e){var t=this.st.get(e);return t||(t=new kn,this.st.set(e,t)),t}},{key:"Tt",value:function(e){var t=this.rt.get(e);return t||(t=new Pe(P),this.rt=this.rt.insert(e,t)),t}},{key:"ft",value:function(e){var t=null!==this.wt(e);return t||g("WatchChangeAggregator","Detected inactive target",e),t}},{key:"wt",value:function(e){var t=this.st.get(e);return t&&t.G?null:this.nt.Et(e)}},{key:"dt",value:function(e){var t=this;this.st.set(e,new kn),this.nt.getRemoteKeysForTarget(e).forEach((function(n){t.ct(e,n,null)}))}},{key:"It",value:function(e,t){return this.nt.getRemoteKeysForTarget(e).has(t)}}]),e}();function Cn(){return new Me(ce.comparator)}function Tn(){return new Me(ce.comparator)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bn={asc:"ASCENDING",desc:"DESCENDING"},En={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Sn=function e(t,n){"use strict";i.classCallCheck(this,e),this.databaseId=t,this.N=n};function In(e,t){return e.N?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function xn(e,t){return e.N?t.toBase64():t.toUint8Array()}function An(e,t){return In(e,t.toTimestamp())}function Nn(e){return T(!!e),q.fromTimestamp((t=Z(e),new F(t.seconds,t.nanos)));var t}function _n(e,t){return(n=e,new z(["projects",n.projectId,"databases",n.database])).child("documents").child(t).canonicalString();var n}function Dn(e){var t=z.fromString(e);return T(Qn(t)),t}function Rn(e,t){return _n(e.databaseId,t.path)}function Ln(e,t){var n=Dn(t);if(n.get(1)!==e.databaseId.projectId)throw new S(E.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new S(E.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new ce(Pn(n))}function Mn(e,t){return _n(e.databaseId,t)}function Vn(e){var t=Dn(e);return 4===t.length?z.emptyPath():Pn(t)}function On(e){return new z(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Pn(e){return T(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Un(e,t,n){return{name:Rn(e,t),fields:n.value.mapValue.fields}}function Fn(e,t){var n,r,i;if(t instanceof Kt)n={update:Un(e,t.key,t.value)};else if(t instanceof Jt)n={delete:Rn(e,t.key)};else if(t instanceof zt)n={update:Un(e,t.key,t.data),updateMask:(r=t.fieldMask,i=[],r.fields.forEach((function(e){return i.push(e.canonicalString())})),{fieldPaths:i})};else{if(!(t instanceof Zt))return C();n={verify:Rn(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((function(e){return function(e,t){var n=t.transform;if(n instanceof xt)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof At)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof _t)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Rt)return{fieldPath:t.field.canonicalString(),increment:n.k};throw C()}(0,e)}))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:An(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:C()}(e,t.precondition)),n}function qn(e,t){return{documents:[Mn(e,t.path)]}}function Bn(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=Mn(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=Mn(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length){var t=e.map((function(e){return function(e){if("=="===e.op){if(Te(e.value))return{unaryFilter:{field:Hn(e.field),op:"IS_NAN"}};if(Ce(e.value))return{unaryFilter:{field:Hn(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Te(e.value))return{unaryFilter:{field:Hn(e.field),op:"IS_NOT_NAN"}};if(Ce(e.value))return{unaryFilter:{field:Hn(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Hn(e.field),op:zn(e.op),value:e.value}}}(e)}));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(t.filters);i&&(n.structuredQuery.where=i);var a=function(e){if(0!==e.length)return e.map((function(e){return{field:Hn((t=e).field),direction:Kn(t.dir)};var t}))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);var s,o,u,c=(s=e,o=t.limit,s.N||se(o)?o:{value:o});return null!==c&&(n.structuredQuery.limit=c),t.startAt&&(n.structuredQuery.startAt={before:(u=t.startAt).inclusive,values:u.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function Gn(e){var t=Vn(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){T(1===r);var a=n.from[0];a.allDescendants?i=a.collectionId:t=t.child(a.collectionId)}var s=[];n.where&&(s=jn(n.where));var o=[];n.orderBy&&(o=n.orderBy.map((function(e){return new et(Wn((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t})));var u,c,l=null;n.limit&&(u=n.limit,l=se(c="object"==typeof u?u.value:u)?null:c);var h=null;n.startAt&&(h=function(e){var t=!!e.before,n=e.values||[];return new $e(n,t)}(n.startAt));var f=null;return n.endAt&&(f=function(e){var t=!e.before,n=e.values||[];return new $e(n,t)}(n.endAt)),at(t,i,o,s,l,"F",h,f)}function jn(e){return e?void 0!==e.unaryFilter?[Xn(e)]:void 0!==e.fieldFilter?[(t=e,Ke.create(Wn(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return C()}}(t.fieldFilter.op),t.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return jn(e)})).reduce((function(e,t){return e.concat(t)})):C():[];var t}function Kn(e){return bn[e]}function zn(e){return En[e]}function Hn(e){return{fieldPath:e.canonicalString()}}function Wn(e){return W.fromServerFormat(e.fieldPath)}function Xn(e){switch(e.unaryFilter.op){case"IS_NAN":var t=Wn(e.unaryFilter.field);return Ke.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=Wn(e.unaryFilter.field);return Ke.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Wn(e.unaryFilter.field);return Ke.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Wn(e.unaryFilter.field);return Ke.create(i,"!=",{nullValue:"NULL_VALUE"});default:return C()}}function Qn(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yn=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Jn=(i.toConsumableArray(Yn).concat(["documentOverlays"]),["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"]),Zn=(i.toConsumableArray(Jn).concat(["indexConfiguration","indexState","indexEntries"]),"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."),$n=function(){"use strict";function e(){i.classCallCheck(this,e),this.onCommittedListeners=[]}return i.createClass(e,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach((function(e){return e()}))}}]),e}(),er=function(){"use strict";function e(t){var n=this;i.classCallCheck(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)}),(function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)}))}return i.createClass(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&C(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e((function(e,i){var a=r;r.nextCallback=function(n){a.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){a.wrapFailure(n,t).next(e,i)}}))}},{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.next(t,n)}))}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.reject(n)}}],[{key:"resolve",value:function(t){return new e((function(e,n){e(t)}))}},{key:"reject",value:function(t){return new e((function(e,n){n(t)}))}},{key:"waitFor",value:function(t){return new e((function(e,n){var r=0,i=0,a=!1;t.forEach((function(t){++r,t.next((function(){++i,a&&i===r&&e()}),(function(e){return n(e)}))})),a=!0,i===r&&e()}))}},{key:"or",value:function(t){var n=e.resolve(!1),r=!0,i=!1,a=void 0;try{for(var s,o=function(t,r){var i=r.value;n=n.next((function(t){return t?e.resolve(t):i()}))},u=t[Symbol.iterator]();!(r=(s=u.next()).done);r=!0)o(0,s)}catch(e){i=!0,a=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach((function(e,i){r.push(t.call(n,e,i))})),this.waitFor(r)}}]),e}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tr(e){return"IndexedDbTransactionError"===e.name}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var nr=function(){"use strict";function e(t,n,r,a){i.classCallCheck(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=a}return i.createClass(e,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&Ft(i,e,n[r])}}},{key:"applyToLocalView",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.baseMutations[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;s.key.isEqual(e.key)&&qt(s,e,this.localWriteTime)}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}var o=!0,u=!1,c=void 0;try{for(var l,h=this.mutations[Symbol.iterator]();!(o=(l=h.next()).done);o=!0){var f=l.value;f.key.isEqual(e.key)&&qt(f,e,this.localWriteTime)}}catch(e){u=!0,c=e}finally{try{o||null==h.return||h.return()}finally{if(u)throw c}}}},{key:"applyToLocalDocumentSet",value:function(e){var t=this;this.mutations.forEach((function(n){var r=e.get(n.key),i=r;t.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(q.min())}))}},{key:"keys",value:function(){return this.mutations.reduce((function(e,t){return e.add(t.key)}),hn())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&U(this.mutations,e.mutations,(function(e,t){return Gt(e,t)}))&&U(this.baseMutations,e.baseMutations,(function(e,t){return Gt(e,t)}))}}]),e}(),rr=function(){"use strict";function e(t,n,r,a){i.classCallCheck(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=a}return i.createClass(e,null,[{key:"from",value:function(t,n,r){T(t.mutations.length===r.length);for(var i=cn,a=t.mutations,s=0;s<a.length;s++)i=i.insert(a[s].key,r[s].version);return new e(t,n,r,i)}}]),e}(),ir=function(){"use strict";function e(t,n){i.classCallCheck(this,e),this.largestBatchId=t,this.mutation=n}return i.createClass(e,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),e}(),ar=function(){"use strict";function e(t,n,r,a){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:q.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:q.min(),u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Y.EMPTY_BYTE_STRING;i.classCallCheck(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u}return i.createClass(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}]),e}(),sr=function e(t){"use strict";i.classCallCheck(this,e),this.Jt=t};function or(e){var t=Gn({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?ft(t,t.limit,"L"):t}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ur=function(){"use strict";function e(){i.classCallCheck(this,e)}return i.createClass(e,[{key:"Zt",value:function(e,t){this.te(e,t),t.ee()}},{key:"te",value:function(e,t){if("nullValue"in e)this.ne(t,5);else if("booleanValue"in e)this.ne(t,10),t.se(e.booleanValue?1:0);else if("integerValue"in e)this.ne(t,15),t.se($(e.integerValue));else if("doubleValue"in e){var n=$(e.doubleValue);isNaN(n)?this.ne(t,13):(this.ne(t,15),oe(n)?t.se(0):t.se(n))}else if("timestampValue"in e){var r=e.timestampValue;this.ne(t,20),"string"==typeof r?t.ie(r):(t.ie("".concat(r.seconds||"")),t.se(r.nanos||0))}else if("stringValue"in e)this.re(e.stringValue,t),this.oe(t);else if("bytesValue"in e)this.ne(t,30),t.ue(ee(e.bytesValue)),this.oe(t);else if("referenceValue"in e)this.ae(e.referenceValue,t);else if("geoPointValue"in e){var i=e.geoPointValue;this.ne(t,45),t.se(i.latitude||0),t.se(i.longitude||0)}else"mapValue"in e?Se(e)?this.ne(t,Number.MAX_SAFE_INTEGER):(this.ce(e.mapValue,t),this.oe(t)):"arrayValue"in e?(this.he(e.arrayValue,t),this.oe(t)):C()}},{key:"re",value:function(e,t){this.ne(t,25),this.le(e,t)}},{key:"le",value:function(e,t){t.ie(e)}},{key:"ce",value:function(e,t){var n=e.fields||{};this.ne(t,55);var r=!0,i=!1,a=void 0;try{for(var s,o=Object.keys(n)[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value;this.re(u,t),this.te(n[u],t)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}}},{key:"he",value:function(e,t){var n=e.values||[];this.ne(t,50);var r=!0,i=!1,a=void 0;try{for(var s,o=n[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value;this.te(u,t)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}}},{key:"ae",value:function(e,t){var n=this;this.ne(t,37),ce.fromName(e).path.forEach((function(e){n.ne(t,60),n.le(e,t)}))}},{key:"ne",value:function(e,t){e.se(t)}},{key:"oe",value:function(e){e.se(2)}}]),e}();ur.fe=new ur;
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var cr=function(){"use strict";function e(){i.classCallCheck(this,e),this.qe=new lr}return i.createClass(e,[{key:"addToCollectionParentIndex",value:function(e,t){return this.qe.add(t),er.resolve()}},{key:"getCollectionParents",value:function(e,t){return er.resolve(this.qe.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return er.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return er.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return er.resolve(null)}},{key:"getIndexType",value:function(e,t){return er.resolve(0)}},{key:"getFieldIndexes",value:function(e,t){return er.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return er.resolve(null)}},{key:"getMinOffset",value:function(e,t){return er.resolve(Re.min())}},{key:"updateCollectionGroup",value:function(e,t,n){return er.resolve()}},{key:"updateIndexEntries",value:function(e,t){return er.resolve()}}]),e}(),lr=function(){"use strict";function e(){i.classCallCheck(this,e),this.index={}}return i.createClass(e,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Pe(z.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new Pe(z.comparator)).toArray()}}]),e}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new Uint8Array(0);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var hr=function(){"use strict";function e(t,n,r){i.classCallCheck(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return i.createClass(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hr.DEFAULT_COLLECTION_PERCENTILE=10,hr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,hr.DEFAULT=new hr(41943040,hr.DEFAULT_COLLECTION_PERCENTILE,hr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),hr.DISABLED=new hr(-1,0,0);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var fr=function(){"use strict";function e(t){i.classCallCheck(this,e),this.mn=t}return i.createClass(e,[{key:"next",value:function(){return this.mn+=2,this.mn}}],[{key:"gn",value:function(){return new e(0)}},{key:"yn",value:function(){return new e(-1)}}]),e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dr(e){return vr.apply(this,arguments)}function vr(){return(vr=
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
i.asyncToGenerator(t(s).mark((function e(n){return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.code===E.FAILED_PRECONDITION&&n.message===Zn){e.next=2;break}throw n;case 2:g("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var yr=function(){"use strict";function e(){i.classCallCheck(this,e),this.changes=new nn((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),this.changesApplied=!1}return i.createClass(e,[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,Ae.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?er.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var pr=function(){"use strict";function e(t,n,r){i.classCallCheck(this,e),this.ds=t,this.Bs=n,this.indexManager=r}return i.createClass(e,[{key:"Ls",value:function(e,t){var n=this;return this.Bs.getAllMutationBatchesAffectingDocumentKey(e,t).next((function(r){return n.Us(e,t,r)}))}},{key:"Us",value:function(e,t,n){return this.ds.getEntry(e,t).next((function(e){var t=!0,r=!1,i=void 0;try{for(var a,s=n[Symbol.iterator]();!(t=(a=s.next()).done);t=!0){a.value.applyToLocalView(e)}}catch(e){r=!0,i=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw i}}return e}))}},{key:"qs",value:function(e,t){e.forEach((function(e,n){var r=!0,i=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){s.value.applyToLocalView(n)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}}))}},{key:"Ks",value:function(e,t){var n=this;return this.ds.getEntries(e,t).next((function(t){return n.Gs(e,t).next((function(){return t}))}))}},{key:"Gs",value:function(e,t){var n=this;return this.Bs.getAllMutationBatchesAffectingDocumentKeys(e,t).next((function(e){return n.qs(t,e)}))}},{key:"Qs",value:function(e,t,n){return r=t,ce.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.js(e,t.path):ct(t)?this.Ws(e,t,n):this.zs(e,t,n);var r}},{key:"js",value:function(e,t){return this.Ls(e,new ce(t)).next((function(e){var t=on();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}},{key:"Ws",value:function(e,t,n){var r=this,i=t.collectionGroup,a=on();return this.indexManager.getCollectionParents(e,i).next((function(s){return er.forEach(s,(function(s){var o,u,c=(o=t,u=s.child(i),new it(u,null,o.explicitOrderBy.slice(),o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt));return r.zs(e,c,n).next((function(e){e.forEach((function(e,t){a=a.insert(e,t)}))}))})).next((function(){return a}))}))}},{key:"zs",value:function(e,t,n){var r,i=this;return this.ds.getAllFromCollection(e,t.path,n).next((function(n){return r=n,i.Bs.getAllMutationBatchesAffectingQuery(e,t)})).next((function(e){var t=!0,n=!1,i=void 0,a=!0,s=!1,o=void 0;try{for(var u,c=e[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;try{for(var h,f=l.mutations[Symbol.iterator]();!(t=(h=f.next()).done);t=!0){var d=h.value,v=d.key,y=r.get(v);null==y&&(y=Ae.newInvalidDocument(v),r=r.insert(v,y)),qt(d,y,l.localWriteTime),y.isFoundDocument()||(r=r.remove(v))}}catch(e){n=!0,i=e}finally{try{t||null==f.return||f.return()}finally{if(n)throw i}}}}catch(e){s=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw o}}})).next((function(){return r.forEach((function(e,n){pt(t,n)||(r=r.remove(e))})),r}))}}]),e}(),gr=function(){"use strict";function e(t,n,r,a){i.classCallCheck(this,e),this.targetId=t,this.fromCache=n,this.Hs=r,this.Js=a}return i.createClass(e,null,[{key:"Ys",value:function(t,n){var r=hn(),i=hn(),a=!0,s=!1,o=void 0;try{for(var u,c=n.docChanges[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var l=u.value;switch(l.type){case 0:r=r.add(l.doc.key);break;case 1:i=i.add(l.doc.key)}}}catch(e){s=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw o}}return new e(t,n.fromCache,r,i)}}]),e}(),mr=function(){"use strict";function e(){i.classCallCheck(this,e),this.Xs=!1}return i.createClass(e,[{key:"initialize",value:function(e,t){this.Zs=e,this.indexManager=t,this.Xs=!0}},{key:"Qs",value:function(e,t,n,r){var i=this;return this.ti(e,t).next((function(a){return a||i.ei(e,t,r,n)})).next((function(n){return n||i.ni(e,t)}))}},{key:"ti",value:function(e,t){return er.resolve(null)}},{key:"ei",value:function(e,t,n,r){var i=this;return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||r.isEqual(q.min())?this.ni(e,t):this.Zs.Ks(e,n).next((function(a){var s=i.si(t,a);return i.ii(t,s,n,r)?i.ni(e,t):(p()<=c.LogLevel.DEBUG&&g("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),yt(t)),i.ri(e,s,t,_e(r,-1)))}))}},{key:"si",value:function(e,t){var n=new Pe(mt(e));return t.forEach((function(t,r){pt(e,r)&&(n=n.add(r))})),n}},{key:"ii",value:function(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;var i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}},{key:"ni",value:function(e,t){return p()<=c.LogLevel.DEBUG&&g("QueryEngine","Using full collection scan to execute query:",yt(t)),this.Zs.Qs(e,t,Re.min())}},{key:"ri",value:function(e,t,n,r){return this.Zs.Qs(e,n,r).next((function(e){return t.forEach((function(t){e=e.insert(t.key,t)})),e}))}}]),e}(),kr=function(){"use strict";function e(t,n,r,a){i.classCallCheck(this,e),this.persistence=t,this.oi=n,this.M=a,this.ui=new Me(P),this.ai=new nn((function(e){return Be(e)}),Ge),this.ci=new Map,this.hi=t.getRemoteDocumentCache(),this.fs=t.getTargetCache(),this._s=t.getBundleCache(),this.li(r)}return i.createClass(e,[{key:"li",value:function(e){this.indexManager=this.persistence.getIndexManager(e),this.Bs=this.persistence.getMutationQueue(e,this.indexManager),this.fi=new pr(this.hi,this.Bs,this.indexManager),this.hi.setIndexManager(this.indexManager),this.oi.initialize(this.fi,this.indexManager)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return e.collect(n,t.ui)}))}}]),e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wr(e,t,n,r){return new kr(e,t,n,r)}function Cr(e,t){return Tr.apply(this,arguments)}function Tr(){return(Tr=i.asyncToGenerator(t(s).mark((function e(n,r){var i;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=b(n),e.next=3,i.persistence.runTransaction("Handle user change","readonly",(function(e){var t;return i.Bs.getAllMutationBatches(e).next((function(n){return t=n,i.li(r),i.Bs.getAllMutationBatches(e)})).next((function(n){var r=[],a=[],s=hn(),o=!0,u=!1,c=void 0;try{for(var l,h=t[Symbol.iterator]();!(o=(l=h.next()).done);o=!0){var f=l.value;r.push(f.batchId);var d=!0,v=!1,y=void 0;try{for(var p,g=f.mutations[Symbol.iterator]();!(d=(p=g.next()).done);d=!0){var m=p.value;s=s.add(m.key)}}catch(e){v=!0,y=e}finally{try{d||null==g.return||g.return()}finally{if(v)throw y}}}}catch(e){u=!0,c=e}finally{try{o||null==h.return||h.return()}finally{if(u)throw c}}var k=!0,w=!1,C=void 0;try{for(var T,b=n[Symbol.iterator]();!(k=(T=b.next()).done);k=!0){var E=T.value;a.push(E.batchId);var S=!0,I=!1,x=void 0;try{for(var A,N=E.mutations[Symbol.iterator]();!(S=(A=N.next()).done);S=!0){var _=A.value;s=s.add(_.key)}}catch(e){I=!0,x=e}finally{try{S||null==N.return||N.return()}finally{if(I)throw x}}}}catch(e){w=!0,C=e}finally{try{k||null==b.return||b.return()}finally{if(w)throw C}}return i.fi.Ks(e,s).next((function(e){return{di:e,removedBatchIds:r,addedBatchIds:a}}))}))}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function br(e,t){var n=b(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(e){var r,i,a,s,o,u,c,l=t.batch.keys(),h=n.hi.newChangeBuffer({trackRemovals:!0});return(r=n,i=e,a=t,s=h,o=a.batch,u=o.keys(),c=er.resolve(),u.forEach((function(e){c=c.next((function(){return s.getEntry(i,e)})).next((function(t){var n=a.docVersions.get(e);T(null!==n),t.version.compareTo(n)<0&&(o.applyToRemoteDocument(t,a),t.isValidDocument()&&(t.setReadTime(a.commitVersion),s.addEntry(t)))}))})),c.next((function(){return r.Bs.removeMutationBatch(i,o)}))).next((function(){return h.apply(e)})).next((function(){return n.Bs.performConsistencyCheck(e)})).next((function(){return n.fi.Ks(e,l)}))}))}function Er(e){var t=b(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(function(e){return t.fs.getLastRemoteSnapshotVersion(e)}))}function Sr(e,t){var n=b(e),r=t.snapshotVersion,i=n.ui;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(e){var a=n.hi.newChangeBuffer({trackRemovals:!0});i=n.ui;var s=[];t.targetChanges.forEach((function(a,o){var u=i.get(o);if(u){s.push(n.fs.removeMatchingKeys(e,a.removedDocuments,o).next((function(){return n.fs.addMatchingKeys(e,a.addedDocuments,o)})));var c,l,h,f=u.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(o)?f=f.withResumeToken(Y.EMPTY_BYTE_STRING,q.min()).withLastLimboFreeSnapshotVersion(q.min()):a.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(a.resumeToken,r)),i=i.insert(o,f),l=f,h=a,(0===(c=u).resumeToken.approximateByteSize()||l.snapshotVersion.toMicroseconds()-c.snapshotVersion.toMicroseconds()>=3e8||h.addedDocuments.size+h.modifiedDocuments.size+h.removedDocuments.size>0)&&s.push(n.fs.updateTargetData(e,f))}}));var o=an();if(t.documentUpdates.forEach((function(r){t.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),s.push(Ir(e,a,t.documentUpdates).next((function(e){o=e}))),!r.isEqual(q.min())){var u=n.fs.getLastRemoteSnapshotVersion(e).next((function(t){return n.fs.setTargetsMetadata(e,e.currentSequenceNumber,r)}));s.push(u)}return er.waitFor(s).next((function(){return a.apply(e)})).next((function(){return n.fi.Gs(e,o)})).next((function(){return o}))})).then((function(e){return n.ui=i,e}))}function Ir(e,t,n){var r=hn();return n.forEach((function(e){return r=r.add(e)})),t.getEntries(e,r).next((function(e){var r=an();return n.forEach((function(n,i){var a=e.get(n);i.isNoDocument()&&i.version.isEqual(q.min())?(t.removeEntry(n,i.readTime),r=r.insert(n,i)):!a.isValidDocument()||i.version.compareTo(a.version)>0||0===i.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(i),r=r.insert(n,i)):g("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",i.version)})),r}))}function xr(e,t){var n=b(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(e){return void 0===t&&(t=-1),n.Bs.getNextMutationBatchAfterBatchId(e,t)}))}function Ar(e,t){var n=b(e);return n.persistence.runTransaction("Allocate target","readwrite",(function(e){var r;return n.fs.getTargetData(e,t).next((function(i){return i?(r=i,er.resolve(r)):n.fs.allocateTargetId(e).next((function(i){return r=new ar(t,i,0,e.currentSequenceNumber),n.fs.addTargetData(e,r).next((function(){return r}))}))}))})).then((function(e){var r=n.ui.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.ui=n.ui.insert(e.targetId,e),n.ai.set(t,e.targetId)),e}))}function Nr(e,t,n){return _r.apply(this,arguments)}function _r(){return(_r=i.asyncToGenerator(t(s).mark((function e(n,r,i){var a,o,u;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=b(n),o=a.ui.get(r),u=i?"readwrite":"readwrite-primary",e.prev=1,e.t0=i,e.t0){e.next=6;break}return e.next=6,a.persistence.runTransaction("Release target",u,(function(e){return a.persistence.referenceDelegate.removeTarget(e,o)}));case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),tr(e.t1)){e.next=12;break}throw e.t1;case 12:g("LocalStore","Failed to update sequence numbers for target ".concat(r,": ").concat(e.t1));case 13:a.ui=a.ui.remove(r),a.ai.delete(o.target);case 14:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}function Dr(e,t,n){var r=b(e),i=q.min(),a=hn();return r.persistence.runTransaction("Execute query","readonly",(function(e){return(s=r,o=e,u=ht(t),c=b(s),l=c.ai.get(u),void 0!==l?er.resolve(c.ui.get(l)):c.fs.getTargetData(o,u)).next((function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.fs.getMatchingKeysForTargetId(e,t.targetId).next((function(e){a=e}))})).next((function(){return r.oi.Qs(e,t,n?i:q.min(),n?a:hn())})).next((function(e){return Rr(r,gt(t),e),{documents:e,_i:a}}));var s,o,u,c,l}))}function Rr(e,t,n){var r=q.min();n.forEach((function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.ci.set(t,r)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Lr=function(){"use strict";function e(t){i.classCallCheck(this,e),this.M=t,this.yi=new Map,this.pi=new Map}return i.createClass(e,[{key:"getBundleMetadata",value:function(e,t){return er.resolve(this.yi.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.yi.set(t.id,{id:(n=t).id,version:n.version,createTime:Nn(n.createTime)}),er.resolve()}},{key:"getNamedQuery",value:function(e,t){return er.resolve(this.pi.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.pi.set(t.name,{name:(n=t).name,query:or(n.bundledQuery),readTime:Nn(n.readTime)}),er.resolve();var n}}]),e}(),Mr=function(){"use strict";function e(){i.classCallCheck(this,e),this.overlays=new Me(ce.comparator),this.Ii=new Map}return i.createClass(e,[{key:"getOverlay",value:function(e,t){return er.resolve(this.overlays.get(t))}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach((function(n,i){r.Xt(e,t,i)})),er.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,i=this.Ii.get(n);return void 0!==i&&(i.forEach((function(e){return r.overlays=r.overlays.remove(e)})),this.Ii.delete(n)),er.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=un(),i=t.length+1,a=new ce(t.child("")),s=this.overlays.getIteratorFrom(a);s.hasNext();){var o=s.getNext().value,u=o.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===i&&o.largestBatchId>n&&r.set(o.getKey(),o)}return er.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var i=new Me((function(e,t){return e-t})),a=this.overlays.getIterator();a.hasNext();){var s=a.getNext().value;if(s.getKey().getCollectionGroup()===t&&s.largestBatchId>n){var o=i.get(s.largestBatchId);null===o&&(o=un(),i=i.insert(s.largestBatchId,o)),o.set(s.getKey(),s)}}for(var u=un(),c=i.getIterator();c.hasNext()&&(c.getNext().value.forEach((function(e,t){return u.set(e,t)})),!(u.size()>=r)););return er.resolve(u)}},{key:"Xt",value:function(e,t,n){if(null!==n){var r=this.overlays.get(n.key);if(null!==r){var i=this.Ii.get(r.largestBatchId).delete(n.key);this.Ii.set(r.largestBatchId,i)}this.overlays=this.overlays.insert(n.key,new ir(t,n));var a=this.Ii.get(t);void 0===a&&(a=hn(),this.Ii.set(t,a)),this.Ii.set(t,a.add(n.key))}}}]),e}(),Vr=function(){"use strict";function e(){i.classCallCheck(this,e),this.Ti=new Pe(Or.Ei),this.Ai=new Pe(Or.Ri)}return i.createClass(e,[{key:"isEmpty",value:function(){return this.Ti.isEmpty()}},{key:"addReference",value:function(e,t){var n=new Or(e,t);this.Ti=this.Ti.add(n),this.Ai=this.Ai.add(n)}},{key:"bi",value:function(e,t){var n=this;e.forEach((function(e){return n.addReference(e,t)}))}},{key:"removeReference",value:function(e,t){this.Pi(new Or(e,t))}},{key:"Vi",value:function(e,t){var n=this;e.forEach((function(e){return n.removeReference(e,t)}))}},{key:"vi",value:function(e){var t=this,n=new ce(new z([])),r=new Or(n,e),i=new Or(n,e+1),a=[];return this.Ai.forEachInRange([r,i],(function(e){t.Pi(e),a.push(e.key)})),a}},{key:"Si",value:function(){var e=this;this.Ti.forEach((function(t){return e.Pi(t)}))}},{key:"Pi",value:function(e){this.Ti=this.Ti.delete(e),this.Ai=this.Ai.delete(e)}},{key:"Di",value:function(e){var t=new ce(new z([])),n=new Or(t,e),r=new Or(t,e+1),i=hn();return this.Ai.forEachInRange([n,r],(function(e){i=i.add(e.key)})),i}},{key:"containsKey",value:function(e){var t=new Or(e,0),n=this.Ti.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),e}(),Or=function(){"use strict";function e(t,n){i.classCallCheck(this,e),this.key=t,this.Ci=n}return i.createClass(e,null,[{key:"Ei",value:function(e,t){return ce.comparator(e.key,t.key)||P(e.Ci,t.Ci)}},{key:"Ri",value:function(e,t){return P(e.Ci,t.Ci)||ce.comparator(e.key,t.key)}}]),e}(),Pr=function(){"use strict";function e(t,n){i.classCallCheck(this,e),this.indexManager=t,this.referenceDelegate=n,this.Bs=[],this.xi=1,this.Ni=new Pe(Or.Ei)}return i.createClass(e,[{key:"checkEmpty",value:function(e){return er.resolve(0===this.Bs.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var i=this.xi;this.xi++,this.Bs.length>0&&this.Bs[this.Bs.length-1];var a=new nr(i,t,n,r);this.Bs.push(a);var s=!0,o=!1,u=void 0;try{for(var c,l=r[Symbol.iterator]();!(s=(c=l.next()).done);s=!0){var h=c.value;this.Ni=this.Ni.add(new Or(h.key,i)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast())}}catch(e){o=!0,u=e}finally{try{s||null==l.return||l.return()}finally{if(o)throw u}}return er.resolve(a)}},{key:"lookupMutationBatch",value:function(e,t){return er.resolve(this.ki(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=t+1,r=this.Mi(n),i=r<0?0:r;return er.resolve(this.Bs.length>i?this.Bs[i]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return er.resolve(0===this.Bs.length?-1:this.xi-1)}},{key:"getAllMutationBatches",value:function(e){return er.resolve(this.Bs.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new Or(t,0),i=new Or(t,Number.POSITIVE_INFINITY),a=[];return this.Ni.forEachInRange([r,i],(function(e){var t=n.ki(e.Ci);a.push(t)})),er.resolve(a)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new Pe(P);return t.forEach((function(e){var t=new Or(e,0),i=new Or(e,Number.POSITIVE_INFINITY);n.Ni.forEachInRange([t,i],(function(e){r=r.add(e.Ci)}))})),er.resolve(this.Oi(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,i=n;ce.isDocumentKey(i)||(i=i.child(""));var a=new Or(new ce(i),0),s=new Pe(P);return this.Ni.forEachWhile((function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(s=s.add(e.Ci)),!0)}),a),er.resolve(this.Oi(s))}},{key:"Oi",value:function(e){var t=this,n=[];return e.forEach((function(e){var r=t.ki(e);null!==r&&n.push(r)})),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;T(0===this.Fi(t.batchId,"removed")),this.Bs.shift();var r=this.Ni;return er.forEach(t.mutations,(function(i){var a=new Or(i.key,t.batchId);return r=r.delete(a),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((function(){n.Ni=r}))}},{key:"_n",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new Or(t,0),r=this.Ni.firstAfterOrEqual(n);return er.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return this.Bs.length,er.resolve()}},{key:"Fi",value:function(e,t){return this.Mi(e)}},{key:"Mi",value:function(e){return 0===this.Bs.length?0:e-this.Bs[0].batchId}},{key:"ki",value:function(e){var t=this.Mi(e);return t<0||t>=this.Bs.length?null:this.Bs[t]}}]),e}(),Ur=function(){"use strict";function e(t){i.classCallCheck(this,e),this.$i=t,this.docs=new Me(ce.comparator),this.size=0}return i.createClass(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.$i(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return er.resolve(n?n.document.mutableCopy():Ae.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=an();return t.forEach((function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():Ae.newInvalidDocument(e))})),er.resolve(r)}},{key:"getAllFromCollection",value:function(e,t,n){for(var r=an(),i=new ce(t.child("")),a=this.docs.getIteratorFrom(i);a.hasNext();){var s=a.getNext(),o=s.key,u=s.value.document;if(!t.isPrefixOf(o.path))break;o.path.length>t.length+1||Le(De(u),n)<=0||(r=r.insert(u.key,u.mutableCopy()))}return er.resolve(r)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){C()}},{key:"Bi",value:function(e,t){return er.forEach(this.docs,(function(e){return t(e)}))}},{key:"newChangeBuffer",value:function(e){return new Fr(this)}},{key:"getSize",value:function(e){return er.resolve(this.size)}}]),e}(),Fr=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e){var r;return i.classCallCheck(this,n),(r=t.call(this)).Kn=e,i.possibleConstructorReturn(r)}return i.createClass(n,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach((function(r,i){i.isValidDocument()?n.push(t.Kn.addEntry(e,i)):t.Kn.removeEntry(r)})),er.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.Kn.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.Kn.getEntries(e,t)}}]),n}(yr),qr=function(){"use strict";function e(t){i.classCallCheck(this,e),this.persistence=t,this.Li=new nn((function(e){return Be(e)}),Ge),this.lastRemoteSnapshotVersion=q.min(),this.highestTargetId=0,this.Ui=0,this.qi=new Vr,this.targetCount=0,this.Ki=fr.gn()}return i.createClass(e,[{key:"forEachTarget",value:function(e,t){return this.Li.forEach((function(e,n){return t(n)})),er.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return er.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return er.resolve(this.Ui)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.Ki.next(),er.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Ui&&(this.Ui=t),er.resolve()}},{key:"Tn",value:function(e){this.Li.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.Ki=new fr(t),this.highestTargetId=t),e.sequenceNumber>this.Ui&&(this.Ui=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.Tn(t),this.targetCount+=1,er.resolve()}},{key:"updateTargetData",value:function(e,t){return this.Tn(t),er.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Li.delete(t.target),this.qi.vi(t.targetId),this.targetCount-=1,er.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,i=0,a=[];return this.Li.forEach((function(s,o){o.sequenceNumber<=t&&null===n.get(o.targetId)&&(r.Li.delete(s),a.push(r.removeMatchingKeysForTargetId(e,o.targetId)),i++)})),er.waitFor(a).next((function(){return i}))}},{key:"getTargetCount",value:function(e){return er.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Li.get(t)||null;return er.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.qi.bi(t,n),er.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.qi.Vi(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((function(t){i.push(r.markPotentiallyOrphaned(e,t))})),er.waitFor(i)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.qi.vi(t),er.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.qi.Di(t);return er.resolve(n)}},{key:"containsKey",value:function(e,t){return er.resolve(this.qi.containsKey(t))}}]),e}(),Br=function(){"use strict";function e(t,n){var r=this;i.classCallCheck(this,e),this.Gi={},this.overlays={},this.es=new M(0),this.ns=!1,this.ns=!0,this.referenceDelegate=t(this),this.fs=new qr(this),this.indexManager=new cr,this.ds=new Ur((function(e){return r.referenceDelegate.Qi(e)})),this.M=new sr(n),this._s=new Lr(this.M)}return i.createClass(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.ns=!1,Promise.resolve()}},{key:"started",get:function(){return this.ns}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new Mr,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.Gi[e.toKey()];return n||(n=new Pr(t,this.referenceDelegate),this.Gi[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.fs}},{key:"getRemoteDocumentCache",value:function(){return this.ds}},{key:"getBundleCache",value:function(){return this._s}},{key:"runTransaction",value:function(e,t,n){var r=this;g("MemoryPersistence","Starting transaction:",e);var i=new Gr(this.es.next());return this.referenceDelegate.ji(),n(i).next((function(e){return r.referenceDelegate.Wi(i).next((function(){return e}))})).toPromise().then((function(e){return i.raiseOnCommittedEvent(),e}))}},{key:"zi",value:function(e,t){return er.or(Object.values(this.Gi).map((function(n){return function(){return n.containsKey(e,t)}})))}}]),e}(),Gr=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e){var r;return i.classCallCheck(this,n),(r=t.call(this)).currentSequenceNumber=e,i.possibleConstructorReturn(r)}return n}($n),jr=function(){"use strict";function e(t){i.classCallCheck(this,e),this.persistence=t,this.Hi=new Vr,this.Ji=null}return i.createClass(e,[{key:"Xi",get:function(){if(this.Ji)return this.Ji;throw C()}},{key:"addReference",value:function(e,t,n){return this.Hi.addReference(n,t),this.Xi.delete(n.toString()),er.resolve()}},{key:"removeReference",value:function(e,t,n){return this.Hi.removeReference(n,t),this.Xi.add(n.toString()),er.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Xi.add(t.toString()),er.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.Hi.vi(t.targetId).forEach((function(e){return n.Xi.add(e.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((function(e){var t=n;e.forEach((function(e){return t.Xi.add(e.toString())}))})).next((function(){return r.removeTargetData(e,t)}))}},{key:"ji",value:function(){this.Ji=new Set}},{key:"Wi",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return er.forEach(this.Xi,(function(r){var i=ce.fromPath(r);return t.Zi(e,i).next((function(e){e||n.removeEntry(i,q.min())}))})).next((function(){return t.Ji=null,n.apply(e)}))}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.Zi(e,t).next((function(e){e?n.Xi.delete(t.toString()):n.Xi.add(t.toString())}))}},{key:"Qi",value:function(e){return 0}},{key:"Zi",value:function(e,t){var n=this;return er.or([function(){return er.resolve(n.Hi.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.zi(e,t)}])}}],[{key:"Yi",value:function(t){return new e(t)}}]),e}();
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Kr=function(){"use strict";function e(){i.classCallCheck(this,e),this.activeTargetIds=dn()}return i.createClass(e,[{key:"nr",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"sr",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"er",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),e}(),zr=function(){"use strict";function e(){i.classCallCheck(this,e),this.Ur=new Kr,this.qr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return i.createClass(e,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.Ur.nr(e),this.qr[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.qr[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.Ur.sr(e)}},{key:"isLocalQueryTarget",value:function(e){return this.Ur.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.qr[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.Ur.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.Ur.activeTargetIds.has(e)}},{key:"start",value:function(){return this.Ur=new Kr,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}]),e}(),Hr=function(){"use strict";function e(){i.classCallCheck(this,e)}return i.createClass(e,[{key:"Kr",value:function(e){}},{key:"shutdown",value:function(){}}]),e}(),Wr=function(){"use strict";function e(){var t=this;i.classCallCheck(this,e),this.Gr=function(){return t.Qr()},this.jr=function(){return t.Wr()},this.zr=[],this.Hr()}return i.createClass(e,[{key:"Kr",value:function(e){this.zr.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Gr),window.removeEventListener("offline",this.jr)}},{key:"Hr",value:function(){window.addEventListener("online",this.Gr),window.addEventListener("offline",this.jr)}},{key:"Qr",value:function(){g("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e=!0,t=!1,n=void 0;try{for(var r,i=this.zr[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){(0,r.value)(0)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"Wr",value:function(){g("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e=!0,t=!1,n=void 0;try{for(var r,i=this.zr[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){(0,r.value)(1)}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}}],[{key:"vt",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),Xr={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Qr=function(){"use strict";function e(t){i.classCallCheck(this,e),this.Jr=t.Jr,this.Yr=t.Yr}return i.createClass(e,[{key:"Xr",value:function(e){this.Zr=e}},{key:"eo",value:function(e){this.no=e}},{key:"onMessage",value:function(e){this.so=e}},{key:"close",value:function(){this.Yr()}},{key:"send",value:function(e){this.Jr(e)}},{key:"io",value:function(){this.Zr()}},{key:"ro",value:function(e){this.no(e)}},{key:"oo",value:function(e){this.so(e)}}]),e}(),Yr=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e){var r;return i.classCallCheck(this,n),(r=t.call(this,e)).forceLongPolling=e.forceLongPolling,r.autoDetectLongPolling=e.autoDetectLongPolling,r.useFetchStreams=e.useFetchStreams,i.possibleConstructorReturn(r)}return i.createClass(n,[{key:"fo",value:function(e,t,n,r){return new Promise((function(i,a){var s=new h.XhrIo;s.listenOnce(h.EventType.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case h.ErrorCode.NO_ERROR:var t=s.getResponseJson();g("Connection","XHR received:",JSON.stringify(t)),i(t);break;case h.ErrorCode.TIMEOUT:g("Connection",'RPC "'+e+'" timed out'),a(new S(E.DEADLINE_EXCEEDED,"Request time out"));break;case h.ErrorCode.HTTP_ERROR:var n=s.getStatus();if(g("Connection",'RPC "'+e+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var o=(u=r.status,c=u.toLowerCase().replace(/_/g,"-"),Object.values(E).indexOf(c)>=0?c:E.UNKNOWN);a(new S(o,r.message))}else a(new S(E.UNKNOWN,"Server responded with status "+s.getStatus()))}else a(new S(E.UNAVAILABLE,"Connection failed."));break;default:C()}}finally{g("Connection",'RPC "'+e+'" completed.')}var u,c}));var o=JSON.stringify(r);s.send(t,"POST",o,n,15)}))}},{key:"wo",value:function(e,t,n){var r=[this.uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=h.createWebChannelTransport(),a=h.getStatEventTarget(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(s.xmlHttpFactory=new h.FetchXmlHttpFactory({})),this.lo(s.initMessageHeaders,t,n),l.isMobileCordova()||l.isReactNative()||l.isElectron()||l.isIE()||l.isUWP()||l.isBrowserExtension()||(s.httpHeadersOverwriteParam="$httpHeaders");var o=r.join("");g("Connection","Creating WebChannel: "+o,s);var u=i.createWebChannel(o,s),c=!1,f=!1,d=new Qr({Jr:function(e){f?g("Connection","Not sending because WebChannel is closed:",e):(c||(g("Connection","Opening WebChannel transport."),u.open(),c=!0),g("Connection","WebChannel sending:",e),u.send(e))},Yr:function(){return u.close()}}),v=function(e,t,n){e.listen(t,(function(e){try{n(e)}catch(e){setTimeout((function(){throw e}),0)}}))};return v(u,h.WebChannel.EventType.OPEN,(function(){f||g("Connection","WebChannel transport opened.")})),v(u,h.WebChannel.EventType.CLOSE,(function(){f||(f=!0,g("Connection","WebChannel transport closed"),d.ro())})),v(u,h.WebChannel.EventType.ERROR,(function(e){f||(f=!0,k("Connection","WebChannel transport errored:",e),d.ro(new S(E.UNAVAILABLE,"The operation could not be completed")))})),v(u,h.WebChannel.EventType.MESSAGE,(function(e){var t;if(!f){var n=e.data[0];T(!!n);var r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){g("Connection","WebChannel received error:",i);var a=i.status,s=function(e){var t=Qt[e];if(void 0!==t)return tn(t)}(a),o=i.message;void 0===s&&(s=E.INTERNAL,o="Unknown error status: "+a+" with message "+i.message),f=!0,d.ro(new S(s,o)),u.close()}else g("Connection","WebChannel received:",n),d.oo(n)}})),v(a,h.Event.STAT_EVENT,(function(e){e.stat===h.Stat.PROXY?g("Connection","Detected buffering proxy"):e.stat===h.Stat.NOPROXY&&g("Connection","Detected no buffering proxy")})),setTimeout((function(){d.io()}),0),d}}]),n}(function(){"use strict";function e(t){i.classCallCheck(this,e),this.databaseInfo=t,this.databaseId=t.databaseId;var n=t.ssl?"https":"http";this.uo=n+"://"+t.host,this.ao="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return i.createClass(e,[{key:"co",value:function(e,t,n,r,i){var a=this.ho(e,t);g("RestConnection","Sending: ",a,n);var s={};return this.lo(s,r,i),this.fo(e,a,s,n).then((function(e){return g("RestConnection","Received: ",e),e}),(function(t){throw k("RestConnection","".concat(e," failed with error: "),t,"url: ",a,"request:",n),t}))}},{key:"_o",value:function(e,t,n,r,i){return this.co(e,t,n,r,i)}},{key:"lo",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+v,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((function(t,n){return e[n]=t})),n&&n.headers.forEach((function(t,n){return e[n]=t}))}},{key:"ho",value:function(e,t){var n=Xr[e];return"".concat(this.uo,"/v1/").concat(t,":").concat(n)}}]),e}());function Jr(){return"undefined"!=typeof document?document:null}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zr(e){return new Sn(e,!0)}var $r=function(){"use strict";function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;i.classCallCheck(this,e),this.Yn=t,this.timerId=n,this.mo=r,this.yo=a,this.po=s,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}return i.createClass(e,[{key:"reset",value:function(){this.Io=0}},{key:"Ao",value:function(){this.Io=this.po}},{key:"Ro",value:function(e){var t=this;this.cancel();var n=Math.floor(this.Io+this.bo()),r=Math.max(0,Date.now()-this.Eo),i=Math.max(0,n-r);i>0&&g("ExponentialBackoff","Backing off for ".concat(i," ms (base delay: ").concat(this.Io," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.To=this.Yn.enqueueAfterDelay(this.timerId,i,(function(){return t.Eo=Date.now(),e()})),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}},{key:"Po",value:function(){null!==this.To&&(this.To.skipDelay(),this.To=null)}},{key:"cancel",value:function(){null!==this.To&&(this.To.cancel(),this.To=null)}},{key:"bo",value:function(){return(Math.random()-.5)*this.Io}}]),e}(),ei=function(){"use strict";function e(t,n,r,a,s,o,u,c){i.classCallCheck(this,e),this.Yn=t,this.Vo=r,this.vo=a,this.So=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=c,this.state=0,this.Do=0,this.Co=null,this.xo=null,this.stream=null,this.No=new $r(t,n)}return i.createClass(e,[{key:"ko",value:function(){return 1===this.state||5===this.state||this.Mo()}},{key:"Mo",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.Oo()}},{key:"stop",value:function(){var e=this;return i.asyncToGenerator(t(s).mark((function n(){return t(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.ko(),!t.t0){t.next=4;break}return t.next=4,e.close(0);case 4:case"end":return t.stop()}}),n)})))()}},{key:"Fo",value:function(){this.state=0,this.No.reset()}},{key:"$o",value:function(){var e=this;this.Mo()&&null===this.Co&&(this.Co=this.Yn.enqueueAfterDelay(this.Vo,6e4,(function(){return e.Bo()})))}},{key:"Lo",value:function(e){this.Uo(),this.stream.send(e)}},{key:"Bo",value:function(){var e=this;return i.asyncToGenerator(t(s).mark((function n(){return t(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.Mo()){t.next=2;break}return t.abrupt("return",e.close(0));case 2:case"end":return t.stop()}}),n)})))()}},{key:"Uo",value:function(){this.Co&&(this.Co.cancel(),this.Co=null)}},{key:"qo",value:function(){this.xo&&(this.xo.cancel(),this.xo=null)}},{key:"close",value:function(e,n){var r=this;return i.asyncToGenerator(t(s).mark((function i(){return t(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.Uo(),r.qo(),r.No.cancel(),r.Do++,4!==e?r.No.reset():n&&n.code===E.RESOURCE_EXHAUSTED?(m(n.toString()),m("Using maximum backoff delay to prevent overloading the backend."),r.No.Ao()):n&&n.code===E.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.Ko(),r.stream.close(),r.stream=null),r.state=e,t.next=9,r.listener.eo(n);case 9:case"end":return t.stop()}}),i)})))()}},{key:"Ko",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.Go(this.Do),n=this.Do;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((function(t){var r=i.slicedToArray(t,2),a=r[0],s=r[1];e.Do===n&&e.Qo(a,s)}),(function(n){var r=e;t((function(){var e=new S(E.UNKNOWN,"Fetching auth token failed: "+n.message);return r.jo(e)}))}))}},{key:"Qo",value:function(e,t){var n=this,r=this.Go(this.Do);this.stream=this.Wo(e,t),this.stream.Xr((function(){var e=n;r((function(){return e.state=2,e.xo=e.Yn.enqueueAfterDelay(e.vo,1e4,(function(){return e.Mo()&&(e.state=3),Promise.resolve()})),e.listener.Xr()}))})),this.stream.eo((function(e){var t=n;r((function(){return t.jo(e)}))})),this.stream.onMessage((function(e){var t=n;r((function(){return t.onMessage(e)}))}))}},{key:"Oo",value:function(){var e=this;this.state=5,this.No.Ro(i.asyncToGenerator(t(s).mark((function n(){return t(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}}),n)}))))}},{key:"jo",value:function(e){return g("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Go",value:function(e){var t=this;return function(n){var r=t;t.Yn.enqueueAndForget((function(){return r.Do===e?n():(g("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}}}]),e}(),ti=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e,r,a,s,o,u){var c;return i.classCallCheck(this,n),(c=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,a,s,u)).M=o,i.possibleConstructorReturn(c)}return i.createClass(n,[{key:"Wo",value:function(e,t){return this.So.wo("Listen",e,t)}},{key:"onMessage",value:function(e){this.No.reset();var t=function(e,t){var n,r;if("targetChange"in t){t.targetChange;var i="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:C(),a=t.targetChange.targetIds||[],s=function(e,t){return e.N?(T(void 0===t||"string"==typeof t),Y.fromBase64String(t||"")):(T(void 0===t||t instanceof Uint8Array),Y.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,u=o&&function(e){var t=void 0===e.code?E.UNKNOWN:tn(e.code);return new S(t,e.message||"")}(o);n=new mn(i,a,s,u||null)}else if("documentChange"in t){t.documentChange;var c=t.documentChange;c.document,c.document.name,c.document.updateTime;var l=Ln(e,c.document.name),h=Nn(c.document.updateTime),f=new Ie({mapValue:{fields:c.document.fields}}),d=Ae.newFoundDocument(l,h,f),v=c.targetIds||[],y=c.removedTargetIds||[];n=new pn(v,y,d.key,d)}else if("documentDelete"in t){t.documentDelete;var p=t.documentDelete;p.document;var g=Ln(e,p.document),m=p.readTime?Nn(p.readTime):q.min(),k=Ae.newNoDocument(g,m),w=p.removedTargetIds||[];n=new pn([],w,k.key,k)}else if("documentRemove"in t){t.documentRemove;var b=t.documentRemove;b.document;var I=Ln(e,b.document),x=b.removedTargetIds||[];n=new pn([],x,I,null)}else{if(!("filter"in t))return C();t.filter;var A=t.filter;A.targetId;var N=A.count||0,_=new $t(N),D=A.targetId;n=new gn(D,_)}return n}(this.M,e),n=function(e){if(!("targetChange"in e))return q.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?q.min():t.readTime?Nn(t.readTime):q.min()}(e);return this.listener.zo(t,n)}},{key:"Ho",value:function(e){var t,n,r,i,a={};a.database=On(this.M),a.addTarget=(t=this.M,i=(n=e).target,(r=je(i)?{documents:qn(t,i)}:{query:Bn(t,i)}).targetId=n.targetId,n.resumeToken.approximateByteSize()>0?r.resumeToken=xn(t,n.resumeToken):n.snapshotVersion.compareTo(q.min())>0&&(r.readTime=In(t,n.snapshotVersion.toTimestamp())),r);var s=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return C()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.M,e);s&&(a.labels=s),this.Lo(a)}},{key:"Jo",value:function(e){var t={};t.database=On(this.M),t.removeTarget=e,this.Lo(t)}}]),n}(ei),ni=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e,r,a,s,o,u){var c;return i.classCallCheck(this,n),(c=t.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,a,s,u)).M=o,c.Yo=!1,i.possibleConstructorReturn(c)}return i.createClass(n,[{key:"Xo",get:function(){return this.Yo}},{key:"start",value:function(){this.Yo=!1,this.lastStreamToken=void 0,i.get(i.getPrototypeOf(n.prototype),"start",this).call(this)}},{key:"Ko",value:function(){this.Yo&&this.Zo([])}},{key:"Wo",value:function(e,t){return this.So.wo("Write",e,t)}},{key:"onMessage",value:function(e){if(T(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Yo){this.No.reset();var t=(r=e.writeResults,i=e.commitTime,r&&r.length>0?(T(void 0!==i),r.map((function(e){return n=i,(r=(t=e).updateTime?Nn(t.updateTime):Nn(n)).isEqual(q.min())&&(r=Nn(n)),new Vt(r,t.transformResults||[]);var t,n,r}))):[]),n=Nn(e.commitTime);return this.listener.tu(n,t)}var r,i;return T(!e.writeResults||0===e.writeResults.length),this.Yo=!0,this.listener.eu()}},{key:"nu",value:function(){var e={};e.database=On(this.M),this.Lo(e)}},{key:"Zo",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map((function(e){return Fn(t.M,e)}))};this.Lo(n)}}]),n}(ei),ri=function(e){"use strict";i.inherits(n,(function e(){i.classCallCheck(this,e)}));var t=i.createSuper(n);function n(e,r,a,s){var o;return i.classCallCheck(this,n),(o=t.call(this)).authCredentials=e,o.appCheckCredentials=r,o.So=a,o.M=s,o.su=!1,i.possibleConstructorReturn(o)}return i.createClass(n,[{key:"iu",value:function(){if(this.su)throw new S(E.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"co",value:function(e,t,n){var r=this;return this.iu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(a){var s=i.slicedToArray(a,2),o=s[0],u=s[1];return r.So.co(e,t,n,o,u)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===E.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new S(E.UNKNOWN,e.toString())}))}},{key:"_o",value:function(e,t,n){var r=this;return this.iu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(a){var s=i.slicedToArray(a,2),o=s[0],u=s[1];return r.So._o(e,t,n,o,u)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===E.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new S(E.UNKNOWN,e.toString())}))}},{key:"terminate",value:function(){this.su=!0}}]),n}(),ii=function(){"use strict";function e(t,n){i.classCallCheck(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.ru=0,this.ou=null,this.uu=!0}return i.createClass(e,[{key:"au",value:function(){var e=this;0===this.ru&&(this.cu("Unknown"),this.ou=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return e.ou=null,e.hu("Backend didn't respond within 10 seconds."),e.cu("Offline"),Promise.resolve()})))}},{key:"lu",value:function(e){"Online"===this.state?this.cu("Unknown"):(this.ru++,this.ru>=1&&(this.fu(),this.hu("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.cu("Offline")))}},{key:"set",value:function(e){this.fu(),this.ru=0,"Online"===e&&(this.uu=!1),this.cu(e)}},{key:"cu",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"hu",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.uu?(m(t),this.uu=!1):g("OnlineStateTracker",t)}},{key:"fu",value:function(){null!==this.ou&&(this.ou.cancel(),this.ou=null)}}]),e}(),ai=function e(n,r,a,o,u){"use strict";var c=this;i.classCallCheck(this,e),this.localStore=n,this.datastore=r,this.asyncQueue=a,this.remoteSyncer={},this.du=[],this._u=new Map,this.wu=new Set,this.mu=[],this.gu=u,this.gu.Kr((function(e){var n=c;a.enqueueAndForget(i.asyncToGenerator(t(s).mark((function e(){return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=pi(n),!e.t0){e.next=5;break}return g("RemoteStore","Restarting streams for network reachability change."),e.next=5,function(){var e=i.asyncToGenerator(t(s).mark((function e(n){var r;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=b(n)).wu.add(4),e.next=4,ui(r);case 4:return r.yu.set("Unknown"),r.wu.delete(4),e.next=8,si(r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(n);case 5:case"end":return e.stop()}}),e)}))))})),this.yu=new ii(a,o)};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function si(e){return oi.apply(this,arguments)}function oi(){return(oi=i.asyncToGenerator(t(s).mark((function e(n){var r,i,a,o,u,c;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!0,i=!1,a=void 0,!pi(n)){e.next=25;break}e.prev=2,o=n.mu[Symbol.iterator]();case 4:if(r=(u=o.next()).done){e.next=11;break}return c=u.value,e.next=8,c(!0);case 8:r=!0,e.next=4;break;case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),i=!0,a=e.t0;case 17:e.prev=17,e.prev=18,r||null==o.return||o.return();case 20:if(e.prev=20,!i){e.next=23;break}throw a;case 23:return e.finish(20);case 24:return e.finish(17);case 25:case"end":return e.stop()}}),e,null,[[2,13,17,25],[18,,20,24]])})))).apply(this,arguments)}function ui(e){return ci.apply(this,arguments)}function ci(){return(ci=i.asyncToGenerator(t(s).mark((function e(n){var r,i,a,o,u,c;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!0,i=!1,a=void 0,e.prev=1,o=n.mu[Symbol.iterator]();case 3:if(r=(u=o.next()).done){e.next=10;break}return c=u.value,e.next=7,c(!1);case 7:r=!0,e.next=3;break;case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),i=!0,a=e.t0;case 16:e.prev=16,e.prev=17,r||null==o.return||o.return();case 19:if(e.prev=19,!i){e.next=22;break}throw a;case 22:return e.finish(19);case 23:return e.finish(16);case 24:case"end":return e.stop()}}),e,null,[[1,12,16,24],[17,,19,23]])})))).apply(this,arguments)}function li(e,t){var n=b(e);n._u.has(t.targetId)||(n._u.set(t.targetId,t),yi(n)?vi(n):zi(n).Mo()&&fi(n,t))}function hi(e,t){var n=b(e),r=zi(n);n._u.delete(t),r.Mo()&&di(n,t),0===n._u.size&&(r.Mo()?r.$o():pi(n)&&n.yu.set("Unknown"))}function fi(e,t){e.pu.Z(t.targetId),zi(e).Ho(t)}function di(e,t){e.pu.Z(t),zi(e).Jo(t)}function vi(e){e.pu=new wn({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},Et:function(t){return e._u.get(t)||null}}),zi(e).start(),e.yu.au()}function yi(e){return pi(e)&&!zi(e).ko()&&e._u.size>0}function pi(e){return 0===b(e).wu.size}function gi(e){e.pu=void 0}function mi(e){return ki.apply(this,arguments)}function ki(){return(ki=i.asyncToGenerator(t(s).mark((function e(n){return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n._u.forEach((function(e,t){fi(n,e)}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wi(e,t){return Ci.apply(this,arguments)}function Ci(){return(Ci=i.asyncToGenerator(t(s).mark((function e(n,r){return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:gi(n),yi(n)?(n.yu.lu(r),vi(n)):n.yu.set("Unknown");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ti(e,t,n){return bi.apply(this,arguments)}function bi(){return bi=i.asyncToGenerator(t(s).mark((function e(n,r,a){var o;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.yu.set("Online"),!(r instanceof mn&&2===r.state&&r.cause)){e.next=13;break}return e.prev=1,e.next=4,function(){var e=i.asyncToGenerator(t(s).mark((function e(n,r){var i,a,o,u,c,l,h;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=r.cause,a=!0,o=!1,u=void 0,e.prev=2,c=r.targetIds[Symbol.iterator]();case 4:if(a=(l=c.next()).done){e.next=15;break}if(h=l.value,e.t0=n._u.has(h),!e.t0){e.next=12;break}return e.next=10,n.remoteSyncer.rejectListen(h,i);case 10:n._u.delete(h),n.pu.removeTarget(h);case 12:a=!0,e.next=4;break;case 15:e.next=21;break;case 17:e.prev=17,e.t1=e.catch(2),o=!0,u=e.t1;case 21:e.prev=21,e.prev=22,a||null==c.return||c.return();case 24:if(e.prev=24,!o){e.next=27;break}throw u;case 27:return e.finish(24);case 28:return e.finish(21);case 29:case"end":return e.stop()}}),e,null,[[2,17,21,29],[22,,24,28]])})));return function(t,n){return e.apply(this,arguments)}}()(n,r);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),g("RemoteStore","Failed to remove targets %s: %s ",r.targetIds.join(","),e.t0),e.next=11,Ei(n,e.t0);case 11:case 22:e.next=29;break;case 13:if(r instanceof pn?n.pu.ut(r):r instanceof gn?n.pu._t(r):n.pu.ht(r),a.isEqual(q.min())){e.next=29;break}return e.prev=14,e.next=17,Er(n.localStore);case 17:if(o=e.sent,e.t1=a.compareTo(o)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.pu.yt(t);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e._u.get(r);i&&e._u.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((function(t){var n=e._u.get(t);if(n){e._u.set(t,n.withResumeToken(Y.EMPTY_BYTE_STRING,n.snapshotVersion)),di(e,t);var r=new ar(n.target,t,1,n.sequenceNumber);fi(e,r)}})),e.remoteSyncer.applyRemoteEvent(n)}(n,a);case 24:return e.prev=24,e.t2=e.catch(14),g("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,Ei(n,e.t2);case 29:case"end":return e.stop()}}),e,null,[[1,6],[14,24]])}))),bi.apply(this,arguments)}function Ei(e,t,n){return Si.apply(this,arguments)}function Si(){return(Si=i.asyncToGenerator(t(s).mark((function e(n,r,a){return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(tr(r)){e.next=2;break}throw r;case 2:return n.wu.add(1),e.next=5,ui(n);case 5:n.yu.set("Offline"),a||(a=function(){return Er(n.localStore)}),n.asyncQueue.enqueueRetryable(i.asyncToGenerator(t(s).mark((function e(){return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g("RemoteStore","Retrying IndexedDB access"),e.next=3,a();case 3:return n.wu.delete(1),e.next=6,si(n);case 6:case"end":return e.stop()}}),e)}))));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ii(e,t){return t().catch((function(n){return Ei(e,n,t)}))}function xi(e){return Ai.apply(this,arguments)}function Ai(){return(Ai=i.asyncToGenerator(t(s).mark((function e(n){var r,i,a,o;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=b(n),i=Hi(r),a=r.du.length>0?r.du[r.du.length-1].batchId:-1;case 2:if(!Ni(r)){e.next=19;break}return e.prev=3,e.next=6,xr(r.localStore,a);case 6:if(null!==(o=e.sent)){e.next=10;break}return 0===r.du.length&&i.$o(),e.abrupt("break",19);case 10:a=o.batchId,_i(r,o),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,Ei(r,e.t0);case 17:e.next=2;break;case 19:Di(r)&&Ri(r);case 20:case"end":return e.stop()}}),e,null,[[3,13]])})))).apply(this,arguments)}function Ni(e){return pi(e)&&e.du.length<10}function _i(e,t){e.du.push(t);var n=Hi(e);n.Mo()&&n.Xo&&n.Zo(t.mutations)}function Di(e){return pi(e)&&!Hi(e).ko()&&e.du.length>0}function Ri(e){Hi(e).start()}function Li(e){return Mi.apply(this,arguments)}function Mi(){return(Mi=i.asyncToGenerator(t(s).mark((function e(n){return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Hi(n).nu();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Vi(e){return Oi.apply(this,arguments)}function Oi(){return(Oi=i.asyncToGenerator(t(s).mark((function e(n){var r,i,a,o,u,c,l;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=Hi(n),i=!0,a=!1,o=void 0,e.prev=2,u=n.du[Symbol.iterator]();!(i=(c=u.next()).done);i=!0)l=c.value,r.Zo(l.mutations);e.next=10;break;case 6:e.prev=6,e.t0=e.catch(2),a=!0,o=e.t0;case 10:e.prev=10,e.prev=11,i||null==u.return||u.return();case 13:if(e.prev=13,!a){e.next=16;break}throw o;case 16:return e.finish(13);case 17:return e.finish(10);case 18:case"end":return e.stop()}}),e,null,[[2,6,10,18],[11,,13,17]])})))).apply(this,arguments)}function Pi(e,t,n){return Ui.apply(this,arguments)}function Ui(){return(Ui=i.asyncToGenerator(t(s).mark((function e(n,r,i){var a,o;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.du.shift(),o=rr.from(a,r,i),e.next=3,Ii(n,(function(){return n.remoteSyncer.applySuccessfulWrite(o)}));case 3:return e.next=5,xi(n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Fi(e,t){return qi.apply(this,arguments)}function qi(){return qi=i.asyncToGenerator(t(s).mark((function e(n,r){return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=r&&Hi(n).Xo,!e.t0){e.next=4;break}return e.next=4,function(){var e=i.asyncToGenerator(t(s).mark((function e(n,r){var i,a;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!en(a=r.code)||a===E.ABORTED){e.next=7;break}return i=n.du.shift(),Hi(n).Fo(),e.next=5,Ii(n,(function(){return n.remoteSyncer.rejectFailedWrite(i.batchId,r)}));case 5:return e.next=7,xi(n);case 7:case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(n,r);case 4:Di(n)&&Ri(n);case 5:case"end":return e.stop()}}),e)}))),qi.apply(this,arguments)}function Bi(e,t){return Gi.apply(this,arguments)}function Gi(){return(Gi=i.asyncToGenerator(t(s).mark((function e(n,r){var i,a;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=b(n)).asyncQueue.verifyOperationInProgress(),g("RemoteStore","RemoteStore received new credentials"),a=pi(i),i.wu.add(3),e.next=6,ui(i);case 6:return a&&i.yu.set("Unknown"),e.next=9,i.remoteSyncer.handleCredentialChange(r);case 9:return i.wu.delete(3),e.next=12,si(i);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ji(e,t){return Ki.apply(this,arguments)}function Ki(){return(Ki=i.asyncToGenerator(t(s).mark((function e(n,r){var i;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=b(n),!r){e.next=7;break}return i.wu.delete(2),e.next=5,si(i);case 5:e.next=13;break;case 7:if(e.t0=r,e.t0){e.next=13;break}return i.wu.add(2),e.next=12,ui(i);case 12:i.yu.set("Unknown");case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function zi(e){return e.Iu||(e.Iu=(r=e.datastore,a=e.asyncQueue,o={Xr:mi.bind(null,e),eo:wi.bind(null,e),zo:Ti.bind(null,e)},(u=b(r)).iu(),new ti(a,u.So,u.authCredentials,u.appCheckCredentials,u.M,o)),e.mu.push((n=i.asyncToGenerator(t(s).mark((function n(r){return t(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=4;break}e.Iu.Fo(),yi(e)?vi(e):e.yu.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.Iu.stop();case 6:gi(e);case 7:case"end":return t.stop()}}),n)}))),function(e){return n.apply(this,arguments)}))),e.Iu;var n,r,a,o,u}function Hi(e){return e.Tu||(e.Tu=(r=e.datastore,a=e.asyncQueue,o={Xr:Li.bind(null,e),eo:Fi.bind(null,e),eu:Vi.bind(null,e),tu:Pi.bind(null,e)},(u=b(r)).iu(),new ni(a,u.So,u.authCredentials,u.appCheckCredentials,u.M,o)),e.mu.push((n=i.asyncToGenerator(t(s).mark((function n(r){return t(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=6;break}return e.Tu.Fo(),t.next=4,xi(e);case 4:t.next=9;break;case 6:return t.next=8,e.Tu.stop();case 8:e.du.length>0&&(g("RemoteStore","Stopping write stream with ".concat(e.du.length," pending writes")),e.du=[]);case 9:case"end":return t.stop()}}),n)}))),function(e){return n.apply(this,arguments)}))),e.Tu
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */;var n,r,a,o,u}var Wi=function(){"use strict";function e(t,n,r,a,s){i.classCallCheck(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=a,this.removalCallback=s,this.deferred=new I,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(e){}))}return i.createClass(e,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout((function(){return t.handleDelayElapsed()}),e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new S(E.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget((function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then((function(t){return e.deferred.resolve(t)}))):Promise.resolve()}))}},{key:"clearTimeout",value:function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}],[{key:"createAndSchedule",value:function(t,n,r,i,a){var s=new e(t,n,Date.now()+r,i,a);return s.start(r),s}}]),e}();function Xi(e,t){if(m("AsyncQueue","".concat(t,": ").concat(e)),tr(e))return new S(E.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qi=function(){"use strict";function e(t){i.classCallCheck(this,e),this.comparator=t?function(e,n){return t(e,n)||ce.comparator(e.key,n.key)}:function(e,t){return ce.comparator(e.key,t.key)},this.keyedMap=on(),this.sortedSet=new Me(this.comparator)}return i.createClass(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}]),e}(),Yi=function(){"use strict";function e(){i.classCallCheck(this,e),this.Eu=new Me(ce.comparator)}return i.createClass(e,[{key:"track",value:function(e){var t=e.doc.key,n=this.Eu.get(t);n?0!==e.type&&3===n.type?this.Eu=this.Eu.insert(t,e):3===e.type&&1!==n.type?this.Eu=this.Eu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Eu=this.Eu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Eu=this.Eu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Eu=this.Eu.remove(t):1===e.type&&2===n.type?this.Eu=this.Eu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Eu=this.Eu.insert(t,{type:2,doc:e.doc}):C():this.Eu=this.Eu.insert(t,e)}},{key:"Au",value:function(){var e=[];return this.Eu.inorderTraversal((function(t,n){e.push(n)})),e}}]),e}(),Ji=function(){"use strict";function e(t,n,r,a,s,o,u,c){i.classCallCheck(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=c}return i.createClass(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&dt(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,i){var a=[];return n.forEach((function(e){a.push({type:0,doc:e})})),new e(t,n,Qi.emptySet(n),a,r,i,!0,!1)}}]),e}(),Zi=function e(){"use strict";i.classCallCheck(this,e),this.Ru=void 0,this.listeners=[]},$i=function e(){"use strict";i.classCallCheck(this,e),this.queries=new nn((function(e){return vt(e)}),dt),this.onlineState="Unknown",this.bu=new Set};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ea(e,t){return ta.apply(this,arguments)}function ta(){return(ta=i.asyncToGenerator(t(s).mark((function e(n,r){var i,a,o,u,c;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=b(n),a=r.query,o=!1,(u=i.queries.get(a))||(o=!0,u=new Zi),!o){e.next=13;break}return e.prev=3,e.next=6,i.onListen(a);case 6:u.Ru=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),c=Xi(e.t0,"Initialization of query '".concat(yt(r.query),"' failed")),e.abrupt("return",void r.onError(c));case 13:i.queries.set(a,u),u.listeners.push(r),r.Pu(i.onlineState),u.Ru&&r.Vu(u.Ru)&&sa(i);case 14:case"end":return e.stop()}}),e,null,[[3,9]])})))).apply(this,arguments)}function na(e,t){return ra.apply(this,arguments)}function ra(){return(ra=i.asyncToGenerator(t(s).mark((function e(n,r){var i,a,o,u,c;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=b(n),a=r.query,o=!1,(u=i.queries.get(a))&&(c=u.listeners.indexOf(r))>=0&&(u.listeners.splice(c,1),o=0===u.listeners.length),!o){e.next=6;break}return e.abrupt("return",(i.queries.delete(a),i.onUnlisten(a)));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ia(e,t){var n=b(e),r=!1,i=!0,a=!1,s=void 0;try{for(var o,u=t[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var c=o.value,l=c.query,h=n.queries.get(l);if(h){var f=!0,d=!1,v=void 0;try{for(var y,p=h.listeners[Symbol.iterator]();!(f=(y=p.next()).done);f=!0){y.value.Vu(c)&&(r=!0)}}catch(e){d=!0,v=e}finally{try{f||null==p.return||p.return()}finally{if(d)throw v}}h.Ru=c}}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}r&&sa(n)}function aa(e,t,n){var r=b(e),i=r.queries.get(t),a=!0,s=!1,o=void 0;if(i)try{for(var u,c=i.listeners[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){u.value.onError(n)}}catch(e){s=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(s)throw o}}r.queries.delete(t)}function sa(e){e.bu.forEach((function(e){e.next()}))}var oa=function(){"use strict";function e(t,n,r){i.classCallCheck(this,e),this.query=t,this.vu=n,this.Su=!1,this.Du=null,this.onlineState="Unknown",this.options=r||{}}return i.createClass(e,[{key:"Vu",value:function(e){if(!this.options.includeMetadataChanges){var t=[],n=!0,r=!1,i=void 0;try{for(var a,s=e.docChanges[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;3!==o.type&&t.push(o)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}e=new Ji(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var u=!1;return this.Su?this.Cu(e)&&(this.vu.next(e),u=!0):this.xu(e,this.onlineState)&&(this.Nu(e),u=!0),this.Du=e,u}},{key:"onError",value:function(e){this.vu.error(e)}},{key:"Pu",value:function(e){this.onlineState=e;var t=!1;return this.Du&&!this.Su&&this.xu(this.Du,e)&&(this.Nu(this.Du),t=!0),t}},{key:"xu",value:function(e,t){if(!e.fromCache)return!0;var n="Offline"!==t;return!(this.options.ku&&n||e.docs.isEmpty()&&"Offline"!==t)}},{key:"Cu",value:function(e){if(e.docChanges.length>0)return!0;var t=this.Du&&this.Du.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}},{key:"Nu",value:function(e){e=Ji.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.Su=!0,this.vu.next(e)}}]),e}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ua=function e(t){"use strict";i.classCallCheck(this,e),this.key=t},ca=function e(t){"use strict";i.classCallCheck(this,e),this.key=t},la=function(){"use strict";function e(t,n){i.classCallCheck(this,e),this.query=t,this.Uu=n,this.qu=null,this.current=!1,this.Ku=hn(),this.mutatedKeys=hn(),this.Gu=mt(t),this.Qu=new Qi(this.Gu)}return i.createClass(e,[{key:"ju",get:function(){return this.Uu}},{key:"Wu",value:function(e,t){var n=this,r=t?t.zu:new Yi,i=t?t.Qu:this.Qu,a=t?t.mutatedKeys:this.mutatedKeys,s=i,o=!1,u="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((function(e,t){var l=i.get(e),h=pt(n.query,t)?t:null,f=!!l&&n.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),v=!1;l&&h?l.data.isEqual(h.data)?f!==d&&(r.track({type:3,doc:h}),v=!0):n.Hu(l,h)||(r.track({type:2,doc:h}),v=!0,(u&&n.Gu(h,u)>0||c&&n.Gu(h,c)<0)&&(o=!0)):!l&&h?(r.track({type:0,doc:h}),v=!0):l&&!h&&(r.track({type:1,doc:l}),v=!0,(u||c)&&(o=!0)),v&&(h?(s=s.add(h),a=d?a.add(e):a.delete(e)):(s=s.delete(e),a=a.delete(e)))})),null!==this.query.limit)for(;s.size>this.query.limit;){var l="F"===this.query.limitType?s.last():s.first();s=s.delete(l.key),a=a.delete(l.key),r.track({type:1,doc:l})}return{Qu:s,zu:r,ii:o,mutatedKeys:a}}},{key:"Hu",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,i=this.Qu;this.Qu=e.Qu,this.mutatedKeys=e.mutatedKeys;var a=e.zu.Au();a.sort((function(e,t){return n=e.type,i=t.type,(a=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return C()}})(n)-a(i)||r.Gu(e.doc,t.doc);var n,i,a})),this.Ju(n);var s=t?this.Yu():[],o=0===this.Ku.size&&this.current?1:0,u=o!==this.qu;return this.qu=o,0!==a.length||u?{snapshot:new Ji(this.query,e.Qu,i,a,e.mutatedKeys,0===o,u,!1),Xu:s}:{Xu:s}}},{key:"Pu",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new Yi,mutatedKeys:this.mutatedKeys,ii:!1},!1)):{Xu:[]}}},{key:"Zu",value:function(e){return!this.Uu.has(e)&&!!this.Qu.has(e)&&!this.Qu.get(e).hasLocalMutations}},{key:"Ju",value:function(e){var t=this;e&&(e.addedDocuments.forEach((function(e){return t.Uu=t.Uu.add(e)})),e.modifiedDocuments.forEach((function(e){})),e.removedDocuments.forEach((function(e){return t.Uu=t.Uu.delete(e)})),this.current=e.current)}},{key:"Yu",value:function(){var e=this;if(!this.current)return[];var t=this.Ku;this.Ku=hn(),this.Qu.forEach((function(t){e.Zu(t.key)&&(e.Ku=e.Ku.add(t.key))}));var n=[];return t.forEach((function(t){e.Ku.has(t)||n.push(new ca(t))})),this.Ku.forEach((function(e){t.has(e)||n.push(new ua(e))})),n}},{key:"ta",value:function(e){this.Uu=e._i,this.Ku=hn();var t=this.Wu(e.documents);return this.applyChanges(t,!0)}},{key:"ea",value:function(){return Ji.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.qu)}}]),e}(),ha=function e(t,n,r){"use strict";i.classCallCheck(this,e),this.query=t,this.targetId=n,this.view=r},fa=function e(t){"use strict";i.classCallCheck(this,e),this.key=t,this.na=!1},da=function(){"use strict";function e(t,n,r,a,s,o){i.classCallCheck(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=a,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.sa={},this.ia=new nn((function(e){return vt(e)}),dt),this.ra=new Map,this.oa=new Set,this.ua=new Me(ce.comparator),this.aa=new Map,this.ca=new Vr,this.ha={},this.la=new Map,this.fa=fr.yn(),this.onlineState="Unknown",this.da=void 0}return i.createClass(e,[{key:"isPrimaryClient",get:function(){return!0===this.da}}]),e}();function va(e,t){return ya.apply(this,arguments)}function ya(){return(ya=i.asyncToGenerator(t(s).mark((function e(n,r){var i,a,o,u,c,l;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=ja(n),!(u=i.ia.get(r))){e.next=7;break}a=u.targetId,i.sharedClientState.addLocalQueryTarget(a),o=u.view.ea(),e.next=16;break;case 7:return e.next=9,Ar(i.localStore,ht(r));case 9:return c=e.sent,i.isPrimaryClient&&li(i.remoteStore,c),l=i.sharedClientState.addLocalQueryTarget(c.targetId),a=c.targetId,e.next=15,pa(i,r,a,"current"===l);case 15:o=e.sent;case 16:return e.abrupt("return",o);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pa(e,t,n,r){return ga.apply(this,arguments)}function ga(){return ga=i.asyncToGenerator(t(s).mark((function e(n,r,a,o){var u,c,l,h,f,d;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n._a=function(e,r,a){return(o=i.asyncToGenerator(t(s).mark((function e(n,r,i,a){var o,u,c;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r.view.Wu(i),e.t0=o.ii,!e.t0){e.next=6;break}return e.next=5,Dr(n.localStore,r.query,!1).then((function(e){var t=e.documents;return r.view.Wu(t,o)}));case 5:o=e.sent;case 6:return u=a&&a.targetChanges.get(r.targetId),c=r.view.applyChanges(o,n.isPrimaryClient,u),e.abrupt("return",(Va(n,r.targetId,c.Xu),c.snapshot));case 8:case"end":return e.stop()}}),e)}))),function(e,t,n,r){return o.apply(this,arguments)})(n,e,r,a);var o},e.next=3,Dr(n.localStore,r,!0);case 3:return u=e.sent,c=new la(r,u._i),l=c.Wu(u.documents),h=yn.createSynthesizedTargetChangeForCurrentChange(a,o&&"Offline"!==n.onlineState),f=c.applyChanges(l,n.isPrimaryClient,h),Va(n,a,f.Xu),d=new ha(r,a,c),e.abrupt("return",(n.ia.set(r,d),n.ra.has(a)?n.ra.get(a).push(r):n.ra.set(a,[r]),f.snapshot));case 11:case"end":return e.stop()}}),e)}))),ga.apply(this,arguments)}function ma(e,t){return ka.apply(this,arguments)}function ka(){return(ka=i.asyncToGenerator(t(s).mark((function e(n,r){var i,a,o;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=b(n),a=i.ia.get(r),!((o=i.ra.get(a.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(i.ra.set(a.targetId,o.filter((function(e){return!dt(e,r)}))),void i.ia.delete(r)));case 3:if(!i.isPrimaryClient){e.next=11;break}if(i.sharedClientState.removeLocalQueryTarget(a.targetId),e.t0=i.sharedClientState.isActiveQueryTarget(a.targetId),e.t0){e.next=9;break}return e.next=9,Nr(i.localStore,a.targetId,!1).then((function(){i.sharedClientState.clearQueryState(a.targetId),hi(i.remoteStore,a.targetId),La(i,a.targetId)})).catch(dr);case 9:e.next=14;break;case 11:return La(i,a.targetId),e.next=14,Nr(i.localStore,a.targetId,!0);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wa(e,t,n){return Ca.apply(this,arguments)}function Ca(){return(Ca=i.asyncToGenerator(t(s).mark((function e(n,r,i){var a,o,u;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Ka(n),e.prev=1,e.next=4,function(e,t){var n,r=b(e),i=F.now(),a=t.reduce((function(e,t){return e.add(t.key)}),hn());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(e){return r.fi.Ks(e,a).next((function(a){n=a;var s=[],o=!0,u=!1,c=void 0;try{for(var l,h=t[Symbol.iterator]();!(o=(l=h.next()).done);o=!0){var f=l.value,d=Bt(f,n.get(f.key));null!=d&&s.push(new zt(f.key,d,xe(d.value.mapValue),Ot.exists(!0)))}}catch(e){u=!0,c=e}finally{try{o||null==h.return||h.return()}finally{if(u)throw c}}return r.Bs.addMutationBatch(e,i,s,t)}))})).then((function(e){return e.applyToLocalDocumentSet(n),{batchId:e.batchId,changes:n}}))}(a.localStore,r);case 4:return o=e.sent,a.sharedClientState.addPendingMutation(o.batchId),t=a,s=o.batchId,c=i,l=void 0,(l=t.ha[t.currentUser.toKey()])||(l=new Me(P)),l=l.insert(s,c),t.ha[t.currentUser.toKey()]=l,e.next=9,Ua(a,o.changes);case 9:return e.next=11,xi(a.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),u=Xi(e.t0,"Failed to persist write"),i.reject(u);case 17:case"end":return e.stop()}var t,s,c,l}),e,null,[[1,13]])})))).apply(this,arguments)}function Ta(e,t){return ba.apply(this,arguments)}function ba(){return(ba=i.asyncToGenerator(t(s).mark((function e(n,r){var i,a;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=b(n),e.prev=1,e.next=4,Sr(i.localStore,r);case 4:return a=e.sent,r.targetChanges.forEach((function(e,t){var n=i.aa.get(t);n&&(T(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.na=!0:e.modifiedDocuments.size>0?T(n.na):e.removedDocuments.size>0&&(T(n.na),n.na=!1))})),e.next=8,Ua(i,a,r);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,dr(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}function Ea(e,t,n){var r=b(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.ia.forEach((function(e,n){var r=n.view.Pu(t);r.snapshot&&i.push(r.snapshot)})),function(e,t){var n=b(e);n.onlineState=t;var r=!1;n.queries.forEach((function(e,n){var i=!0,a=!1,s=void 0;try{for(var o,u=n.listeners[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){o.value.Pu(t)&&(r=!0)}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}})),r&&sa(n)}(r.eventManager,t),i.length&&r.sa.zo(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function Sa(e,t,n){return Ia.apply(this,arguments)}function Ia(){return(Ia=i.asyncToGenerator(t(s).mark((function e(n,r,i){var a,o,u,c,l,h;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=b(n)).sharedClientState.updateQueryState(r,"rejected",i),o=a.aa.get(r),!(u=o&&o.key)){e.next=14;break}return c=(c=new Me(ce.comparator)).insert(u,Ae.newNoDocument(u,q.min())),l=hn().add(u),h=new vn(q.min(),new Map,new Pe(P),c,l),e.next=9,Ta(a,h);case 9:a.ua=a.ua.remove(u),a.aa.delete(r),Pa(a),e.next=16;break;case 14:return e.next=16,Nr(a.localStore,r,!1).then((function(){return La(a,r,i)})).catch(dr);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xa(e,t){return Aa.apply(this,arguments)}function Aa(){return(Aa=i.asyncToGenerator(t(s).mark((function e(n,r){var i,a,o;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=b(n),a=r.batch.batchId,e.prev=1,e.next=4,br(i.localStore,r);case 4:return o=e.sent,Ra(i,a,null),Da(i,a),i.sharedClientState.updateMutationState(a,"acknowledged"),e.next=10,Ua(i,o);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,dr(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}function Na(e,t,n){return _a.apply(this,arguments)}function _a(){return(_a=i.asyncToGenerator(t(s).mark((function e(n,r,i){var a,o;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=b(n),e.prev=1,e.next=4,function(e,t){var n=b(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(e){var r;return n.Bs.lookupMutationBatch(e,t).next((function(t){return T(null!==t),r=t.keys(),n.Bs.removeMutationBatch(e,t)})).next((function(){return n.Bs.performConsistencyCheck(e)})).next((function(){return n.fi.Ks(e,r)}))}))}(a.localStore,r);case 4:return o=e.sent,Ra(a,r,i),Da(a,r),a.sharedClientState.updateMutationState(r,"rejected",i),e.next=10,Ua(a,o);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,dr(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}function Da(e,t){(e.la.get(t)||[]).forEach((function(e){e.resolve()})),e.la.delete(t)}function Ra(e,t,n){var r=b(e),i=r.ha[r.currentUser.toKey()];if(i){var a=i.get(t);a&&(n?a.reject(n):a.resolve(),i=i.remove(t)),r.ha[r.currentUser.toKey()]=i}}function La(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r=!0,i=!1,a=void 0;try{for(var s,o=e.ra.get(t)[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value;e.ia.delete(u),n&&e.sa.wa(u,n)}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}e.ra.delete(t),e.isPrimaryClient&&e.ca.vi(t).forEach((function(t){e.ca.containsKey(t)||Ma(e,t)}))}function Ma(e,t){e.oa.delete(t.path.canonicalString());var n=e.ua.get(t);null!==n&&(hi(e.remoteStore,n),e.ua=e.ua.remove(t),e.aa.delete(n),Pa(e))}function Va(e,t,n){var r=!0,i=!1,a=void 0;try{for(var s,o=n[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){var u=s.value;u instanceof ua?(e.ca.addReference(u.key,t),Oa(e,u)):u instanceof ca?(g("SyncEngine","Document no longer in limbo: "+u.key),e.ca.removeReference(u.key,t),e.ca.containsKey(u.key)||Ma(e,u.key)):C()}}catch(e){i=!0,a=e}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}}function Oa(e,t){var n=t.key,r=n.path.canonicalString();e.ua.get(n)||e.oa.has(r)||(g("SyncEngine","New document in limbo: "+n),e.oa.add(r),Pa(e))}function Pa(e){for(;e.oa.size>0&&e.ua.size<e.maxConcurrentLimboResolutions;){var t=e.oa.values().next().value;e.oa.delete(t);var n=new ce(z.fromString(t)),r=e.fa.next();e.aa.set(r,new fa(n)),e.ua=e.ua.insert(n,r),li(e.remoteStore,new ar(ht(st(n.path)),r,2,M.A))}}function Ua(e,t,n){return Fa.apply(this,arguments)}function Fa(){return Fa=i.asyncToGenerator(t(s).mark((function e(n,r,a){var o,u,c,l;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=b(n),u=[],c=[],l=[],e.t0=o.ia.isEmpty(),e.t0){e.next=9;break}return o.ia.forEach((function(e,t){l.push(o._a(t,r,a).then((function(e){if(e){o.isPrimaryClient&&o.sharedClientState.updateQueryState(t.targetId,e.fromCache?"not-current":"current"),u.push(e);var n=gr.Ys(t.targetId,e);c.push(n)}})))})),e.next=6,Promise.all(l);case 6:return o.sa.zo(u),e.next=9,function(){var e=i.asyncToGenerator(t(s).mark((function e(n,r){var i,a,o,u,c,l,h,f,d,v,y;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=b(n),e.prev=1,e.next=4,i.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(e){return er.forEach(r,(function(t){return er.forEach(t.Hs,(function(n){return i.persistence.referenceDelegate.addReference(e,t.targetId,n)})).next((function(){return er.forEach(t.Js,(function(n){return i.persistence.referenceDelegate.removeReference(e,t.targetId,n)}))}))}))}));case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),tr(e.t0)){e.next=10;break}throw e.t0;case 10:g("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:for(a=!0,o=!1,u=void 0,e.prev=12,c=r[Symbol.iterator]();!(a=(l=c.next()).done);a=!0)h=l.value,f=h.targetId,h.fromCache||(d=i.ui.get(f),v=d.snapshotVersion,y=d.withLastLimboFreeSnapshotVersion(v),i.ui=i.ui.insert(f,y));e.next=20;break;case 16:e.prev=16,e.t1=e.catch(12),o=!0,u=e.t1;case 20:e.prev=20,e.prev=21,a||null==c.return||c.return();case 23:if(e.prev=23,!o){e.next=26;break}throw u;case 26:return e.finish(23);case 27:return e.finish(20);case 28:case"end":return e.stop()}}),e,null,[[1,6],[12,16,20,28],[21,,23,27]])})));return function(t,n){return e.apply(this,arguments)}}()(o.localStore,c);case 9:case"end":return e.stop()}}),e)}))),Fa.apply(this,arguments)}function qa(e,t){return Ba.apply(this,arguments)}function Ba(){return(Ba=i.asyncToGenerator(t(s).mark((function e(n,r){var i,a;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=b(n)).currentUser.isEqual(r)){e.next=11;break}return g("SyncEngine","User change. New user:",r.toKey()),e.next=5,Cr(i.localStore,r);case 5:return a=e.sent,i.currentUser=r,(t=i).la.forEach((function(e){e.forEach((function(e){e.reject(new S(E.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.la.clear(),i.sharedClientState.handleUserChange(r,a.removedBatchIds,a.addedBatchIds),e.next=11,Ua(i,a.di);case 11:case"end":return e.stop()}var t}),e)})))).apply(this,arguments)}function Ga(e,t){var n=b(e),r=n.aa.get(t);if(r&&r.na)return hn().add(r.key);var i=hn(),a=n.ra.get(t);if(!a)return i;var s=!0,o=!1,u=void 0;try{for(var c,l=a[Symbol.iterator]();!(s=(c=l.next()).done);s=!0){var h=c.value,f=n.ia.get(h);i=i.unionWith(f.view.ju)}}catch(e){o=!0,u=e}finally{try{s||null==l.return||l.return()}finally{if(o)throw u}}return i}function ja(e){var t=b(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Ta.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Ga.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Sa.bind(null,t),t.sa.zo=ia.bind(null,t.eventManager),t.sa.wa=aa.bind(null,t.eventManager),t}function Ka(e){var t=b(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=xa.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Na.bind(null,t),t}var za=function(){"use strict";function e(){i.classCallCheck(this,e),this.synchronizeTabs=!1}return i.createClass(e,[{key:"initialize",value:function(e){var n=this;return i.asyncToGenerator(t(s).mark((function r(){return t(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.M=Zr(e.databaseInfo.databaseId),n.sharedClientState=n.ga(e),n.persistence=n.ya(e),t.next=5,n.persistence.start();case 5:n.gcScheduler=n.pa(e),n.localStore=n.Ia(e);case 7:case"end":return t.stop()}}),r)})))()}},{key:"pa",value:function(e){return null}},{key:"Ia",value:function(e){return wr(this.persistence,new mr,e.initialUser,this.M)}},{key:"ya",value:function(e){return new Br(jr.Yi,this.M)}},{key:"ga",value:function(e){return new zr}},{key:"terminate",value:function(){var e=this;return i.asyncToGenerator(t(s).mark((function n(){return t(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.gcScheduler&&e.gcScheduler.stop(),t.next=3,e.sharedClientState.shutdown();case 3:return t.next=5,e.persistence.shutdown();case 5:case"end":return t.stop()}}),n)})))()}}]),e}(),Ha=function(){"use strict";function e(){i.classCallCheck(this,e)}return i.createClass(e,[{key:"initialize",value:function(e,n){var r=this;return i.asyncToGenerator(t(s).mark((function i(){return t(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=r.localStore,t.t0){t.next=12;break}return r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(n),r.remoteStore=r.createRemoteStore(n),r.eventManager=r.createEventManager(n),r.syncEngine=r.createSyncEngine(n,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=function(e){return Ea(r.syncEngine,e,1)},r.remoteStore.remoteSyncer.handleCredentialChange=qa.bind(null,r.syncEngine),t.next=12,ji(r.remoteStore,r.syncEngine.isPrimaryClient);case 12:case"end":return t.stop()}}),i)})))()}},{key:"createEventManager",value:function(e){return new $i}},{key:"createDatastore",value:function(e){var t,n,r,i=Zr(e.databaseInfo.databaseId),a=(t=e.databaseInfo,new Yr(t));return n=e.authCredentials,r=e.appCheckCredentials,new ri(n,r,a,i)}},{key:"createRemoteStore",value:function(e){var t,n,r,i,a,s=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return Ea(s.syncEngine,e,0)},a=Wr.vt()?new Wr:new Hr,new ai(t,n,r,i,a)}},{key:"createSyncEngine",value:function(e,t){return n=this.localStore,r=this.remoteStore,i=this.eventManager,a=this.sharedClientState,s=e.initialUser,o=e.maxConcurrentLimboResolutions,u=t,c=new da(n,r,i,a,s,o),u&&(c.da=!0),c;var n,r,i,a,s,o,u,c}},{key:"terminate",value:function(){return(e=i.asyncToGenerator(t(s).mark((function e(n){var r;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=b(n),g("RemoteStore","RemoteStore shutting down."),r.wu.add(5),e.next=5,ui(r);case 5:r.gu.shutdown(),r.yu.set("Unknown");case 7:case"end":return e.stop()}}),e)}))),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}]),e}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Wa=function(){"use strict";function e(t){i.classCallCheck(this,e),this.observer=t,this.muted=!1}return i.createClass(e,[{key:"next",value:function(e){this.observer.next&&this.Ea(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.Ea(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}},{key:"Aa",value:function(){this.muted=!0}},{key:"Ea",value:function(e,t){var n=this;this.muted||setTimeout((function(){n.muted||e(t)}),0)}}]),e}(),Xa=function(){"use strict";function e(n,r,a,o){var u=this;i.classCallCheck(this,e);var c,l=this;this.authCredentials=n,this.appCheckCredentials=r,this.asyncQueue=a,this.databaseInfo=o,this.user=d.UNAUTHENTICATED,this.clientId=O.R(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(a,(c=i.asyncToGenerator(t(s).mark((function e(n){return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g("FirestoreClient","Received user=",n.uid),e.next=3,l.authCredentialListener(n);case 3:l.user=n;case 4:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)})),this.appCheckCredentials.start(a,(function(e){return g("FirestoreClient","Received new app check token=",e),u.appCheckCredentialListener(e,u.user)}))}return i.createClass(e,[{key:"getConfiguration",value:function(){var e=this;return i.asyncToGenerator(t(s).mark((function n(){return t(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100});case 1:case"end":return t.stop()}}),n)})))()}},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new S(E.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){this.asyncQueue.enterRestrictedMode();var e=new I,n=this;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(i.asyncToGenerator(t(s).mark((function r(){var i;return t(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,t.t0=n.onlineComponents,!t.t0){t.next=5;break}return t.next=5,n.onlineComponents.terminate();case 5:if(t.t1=n.offlineComponents,!t.t1){t.next=9;break}return t.next=9,n.offlineComponents.terminate();case 9:n.authCredentials.shutdown(),n.appCheckCredentials.shutdown(),e.resolve(),t.next=18;break;case 14:t.prev=14,t.t2=t.catch(0),i=Xi(t.t2,"Failed to shutdown persistence"),e.reject(i);case 18:case"end":return t.stop()}}),r,null,[[0,14]])})))),e.promise}}]),e}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qa(e,t){return Ya.apply(this,arguments)}function Ya(){return Ya=i.asyncToGenerator(t(s).mark((function e(n,r){var a,o;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.asyncQueue.verifyOperationInProgress(),g("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,n.getConfiguration();case 3:return a=e.sent,e.next=6,r.initialize(a);case 6:o=a.initialUser,n.setCredentialChangeListener(function(){var e=i.asyncToGenerator(t(s).mark((function e(n){return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=o.isEqual(n),e.t0){e.next=5;break}return e.next=4,Cr(r.localStore,n);case 4:o=n;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),r.persistence.setDatabaseDeletedListener((function(){return n.terminate()})),n.offlineComponents=r;case 8:case"end":return e.stop()}}),e)}))),Ya.apply(this,arguments)}function Ja(e,t){return Za.apply(this,arguments)}function Za(){return(Za=i.asyncToGenerator(t(s).mark((function e(n,r){var i,a;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.asyncQueue.verifyOperationInProgress(),e.next=3,$a(n);case 3:return i=e.sent,g("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,n.getConfiguration();case 7:return a=e.sent,e.next=10,r.initialize(i,a);case 10:n.setCredentialChangeListener((function(e){return Bi(r.remoteStore,e)})),n.setAppCheckTokenChangeListener((function(e,t){return Bi(r.remoteStore,t)})),n.onlineComponents=r;case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $a(e){return es.apply(this,arguments)}function es(){return(es=i.asyncToGenerator(t(s).mark((function e(n){return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n.offlineComponents,e.t0){e.next=5;break}return g("FirestoreClient","Using default OfflineComponentProvider"),e.next=5,Qa(n,new za);case 5:return e.abrupt("return",(e.t0||e.sent,n.offlineComponents));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ts(e){return ns.apply(this,arguments)}function ns(){return(ns=i.asyncToGenerator(t(s).mark((function e(n){return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n.onlineComponents,e.t0){e.next=5;break}return g("FirestoreClient","Using default OnlineComponentProvider"),e.next=5,Ja(n,new Ha);case 5:return e.abrupt("return",(e.t0||e.sent,n.onlineComponents));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function rs(e){return ts(e).then((function(e){return e.syncEngine}))}function is(e){return as.apply(this,arguments)}function as(){return(as=i.asyncToGenerator(t(s).mark((function e(n){var r,i;return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ts(n);case 2:return r=e.sent,i=r.eventManager,e.abrupt("return",(i.onListen=va.bind(null,r.syncEngine),i.onUnlisten=ma.bind(null,r.syncEngine),i));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ss(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=new I;return e.asyncQueue.enqueueAndForget(i.asyncToGenerator(t(s).mark((function i(){return t(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=function(e,t,n,r,i){var a=new Wa({next:function(n){t.enqueueAndForget((function(){return na(e,s)})),n.fromCache&&"server"===r.source?i.reject(new S(E.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),s=new oa(n,a,{includeMetadataChanges:!0,ku:!0});return ea(e,s)},t.next=3,is(e);case 3:return t.t1=t.sent,t.t2=e.asyncQueue,t.t3=n,t.t4=r,t.t5=a,t.abrupt("return",(0,t.t0)(t.t1,t.t2,t.t3,t.t4,t.t5));case 9:case"end":return t.stop()}}),i)})))),a.promise}var os=new Map;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function us(e,t,n){if(!n)throw new S(E.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function cs(e){if(!ce.isDocumentKey(e))throw new S(E.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function ls(e){if(ce.isDocumentKey(e))throw new S(E.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function hs(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=(n=e).constructor?n.constructor.name:null;return t?"a custom ".concat(t," object"):"an object"}var n;return"function"==typeof e?"a function":C()}function fs(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new S(E.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=hs(e);throw new S(E.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ds=function(){"use strict";function e(t){var n;if(i.classCallCheck(this,e),void 0===t.host){if(void 0!==t.ssl)throw new S(E.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new S(E.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(e,t,n,r){if(!0===t&&!0===r)throw new S(E.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))}("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return i.createClass(e,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}]),e}(),vs=function(){"use strict";function e(t,n,r){i.classCallCheck(this,e),this._authCredentials=n,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ds({}),this._settingsFrozen=!1,t instanceof ae?this._databaseId=t:(this._app=t,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new S(E.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ae(e.options.projectId)}(t))}return i.createClass(e,[{key:"app",get:function(){if(!this._app)throw new S(E.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new S(E.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ds(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new A;switch(e.type){case"gapi":var t=e.client;return T(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new D(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new S(E.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return e=this,(t=os.get(e))&&(g("ComponentProvider","Removing Datastore"),os.delete(e),t.terminate()),Promise.resolve();var e,t}}]),e}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ys=function(){"use strict";function e(t,n,r){i.classCallCheck(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return i.createClass(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new gs(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}(),ps=function(){"use strict";function e(t,n,r){i.classCallCheck(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return i.createClass(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}(),gs=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e,r,a){var s;return i.classCallCheck(this,n),(s=t.call(this,e,r,st(a)))._path=a,s.type="collection",i.possibleConstructorReturn(s)}return i.createClass(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new ys(this.firestore,null,new ce(e))}},{key:"withConverter",value:function(e){return new n(this.firestore,e,this._path)}}]),n}(ps);function ms(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=l.getModularInstance(e),us("collection","path",t),e instanceof vs){var s,o=(s=z).fromString.apply(s,[t].concat(i.toConsumableArray(r)));return ls(o),new gs(e,null,o)}var u;if(!(e instanceof ys||e instanceof gs))throw new S(E.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var c=e._path.child((u=z).fromString.apply(u,[t].concat(i.toConsumableArray(r))));return ls(c),new gs(e.firestore,null,c)}function ks(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=l.getModularInstance(e),1===arguments.length&&(t=O.R()),us("doc","path",t),e instanceof vs){var s,o=(s=z).fromString.apply(s,[t].concat(i.toConsumableArray(r)));return cs(o),new ys(e,null,new ce(o))}var u;if(!(e instanceof ys||e instanceof gs))throw new S(E.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var c=e._path.child((u=z).fromString.apply(u,[t].concat(i.toConsumableArray(r))));return cs(c),new ys(e.firestore,e instanceof gs?e.converter:null,new ce(c))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ws=function(){"use strict";function e(){var t=this;i.classCallCheck(this,e),this.Fa=Promise.resolve(),this.$a=[],this.Ba=!1,this.La=[],this.Ua=null,this.qa=!1,this.Ka=!1,this.Ga=[],this.No=new $r(this,"async_queue_retry"),this.Qa=function(){var e=Jr();e&&g("AsyncQueue","Visibility state changed to "+e.visibilityState),t.No.Po()};var n=Jr();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.Qa)}return i.createClass(e,[{key:"isShuttingDown",get:function(){return this.Ba}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.ja(),this.Wa(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.Ba){this.Ba=!0,this.Ka=e||!1;var t=Jr();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Qa)}}},{key:"enqueue",value:function(e){var t=this;if(this.ja(),this.Ba)return new Promise((function(){}));var n=new I;return this.Wa((function(){return t.Ba&&t.Ka?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget((function(){return t.$a.push(e),t.za()}))}},{key:"za",value:function(){var e=this;return i.asyncToGenerator(t(s).mark((function n(){return t(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0===e.$a.length){t.next=14;break}return t.prev=1,t.next=4,e.$a[0]();case 4:e.$a.shift(),e.No.reset(),t.next=13;break;case 8:if(t.prev=8,t.t0=t.catch(1),tr(t.t0)){t.next=12;break}throw t.t0;case 12:g("AsyncQueue","Operation failed with retryable error: "+t.t0);case 13:e.$a.length>0&&e.No.Ro((function(){return e.za()}));case 14:case"end":return t.stop()}}),n,null,[[1,8]])})))()}},{key:"Wa",value:function(e){var t=this,n=this.Fa.then((function(){return t.qa=!0,e().catch((function(e){var n,r;throw t.Ua=e,t.qa=!1,m("INTERNAL UNHANDLED ERROR: ",(r=(n=e).message||"",n.stack&&(r=n.stack.includes(n.message)?n.stack:n.message+"\n"+n.stack),r)),e})).then((function(e){return t.qa=!1,e}))}));return this.Fa=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.ja(),this.Ga.indexOf(e)>-1&&(t=0);var i=Wi.createAndSchedule(this,e,t,n,(function(e){return r.Ha(e)}));return this.La.push(i),i}},{key:"ja",value:function(){this.Ua&&C()}},{key:"verifyOperationInProgress",value:function(){}},{key:"Ja",value:function(){var e=this;return i.asyncToGenerator(t(s).mark((function n(){var r;return t(s).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case 1:return r=e.Fa,t.next=4,r;case 4:if(r!==e.Fa){t.next=1;break}case 5:case"end":return t.stop()}}),n)})))()}},{key:"Ya",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.La[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){if(i.value.timerId===e)return!0}}catch(e){n=!0,r=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return!1}},{key:"Xa",value:function(e){var t=this;return this.Ja().then((function(){t.La.sort((function(e,t){return e.targetTimeMs-t.targetTimeMs}));var n=!0,r=!1,i=void 0;try{for(var a,s=t.La[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;if(o.skipDelay(),"all"!==e&&o.timerId===e)break}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t.Ja()}))}},{key:"Za",value:function(e){this.Ga.push(e)}},{key:"Ha",value:function(e){var t=this.La.indexOf(e);this.La.splice(t,1)}}]),e}();var Cs=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e,r,a){var s;return i.classCallCheck(this,n),(s=t.call(this,e,r,a)).type="firestore",s._queue=new ws,s._persistenceKey="name"in e?e.name:"[DEFAULT]",i.possibleConstructorReturn(s)}return i.createClass(n,[{key:"_terminate",value:function(){return this._firestoreClient||Es(this),this._firestoreClient.terminate()}}]),n}(vs);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ts(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.getApp();return o._getProvider(e,"firestore").getImmediate()}function bs(e){return e._firestoreClient||Es(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Es(e){var t,n,r,i,a,s=e._freezeSettings(),o=(n=e._databaseId,r=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",i=e._persistenceKey,new ie(n,r,i,(a=s).host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams));e._firestoreClient=new Xa(e._authCredentials,e._appCheckCredentials,e._queue,o)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ss=function(){"use strict";function e(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];i.classCallCheck(this,e);for(var a=0;a<n.length;++a)if(0===n[a].length)throw new S(E.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new W(n)}return i.createClass(e,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),e}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Is=function(){"use strict";function e(t){i.classCallCheck(this,e),this._byteString=t}return i.createClass(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(Y.fromBase64String(t))}catch(e){throw new S(E.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}},{key:"fromUint8Array",value:function(t){return new e(Y.fromUint8Array(t))}}]),e}(),xs=function e(t){"use strict";i.classCallCheck(this,e),this._methodName=t},As=function(){"use strict";function e(t,n){if(i.classCallCheck(this,e),!isFinite(t)||t<-90||t>90)throw new S(E.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new S(E.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return i.createClass(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return P(this._lat,e._lat)||P(this._long,e._long)}}]),e}(),Ns=/^__.*__$/,_s=function(){"use strict";function e(t,n,r){i.classCallCheck(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return i.createClass(e,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new zt(e,this.data,this.fieldMask,t,this.fieldTransforms):new Kt(e,this.data,t,this.fieldTransforms)}}]),e}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ds(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw C()}}var Rs=function(){"use strict";function e(t,n,r,a,s,o){i.classCallCheck(this,e),this.settings=t,this.databaseId=n,this.M=r,this.ignoreUndefinedProperties=a,void 0===s&&this.tc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}return i.createClass(e,[{key:"path",get:function(){return this.settings.path}},{key:"ec",get:function(){return this.settings.ec}},{key:"nc",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.M,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"sc",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.nc({path:n,ic:!1});return r.rc(e),r}},{key:"oc",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.nc({path:n,ic:!1});return r.tc(),r}},{key:"uc",value:function(e){return this.nc({path:void 0,ic:!0})}},{key:"ac",value:function(e){return Ks(e,this.settings.methodName,this.settings.cc||!1,this.path,this.settings.hc)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find((function(t){return e.isPrefixOf(t)}))||void 0!==this.fieldTransforms.find((function(t){return e.isPrefixOf(t.field)}))}},{key:"tc",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.rc(this.path.get(e))}},{key:"rc",value:function(e){if(0===e.length)throw this.ac("Document fields must not be empty");if(Ds(this.ec)&&Ns.test(e))throw this.ac('Document fields cannot begin and end with "__"')}}]),e}(),Ls=function(){"use strict";function e(t,n,r){i.classCallCheck(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.M=r||Zr(t)}return i.createClass(e,[{key:"lc",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Rs({ec:e,methodName:t,hc:n,path:W.emptyPath(),ic:!1,cc:r},this.databaseId,this.M,this.ignoreUndefinedProperties)}}]),e}();function Ms(e){var t=e._freezeSettings(),n=Zr(e._databaseId);return new Ls(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Vs(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},s=e.lc(a.merge||a.mergeFields?2:0,t,n,i);qs("Data must be an object, but it was:",s,r);var o,u,c=Us(r,s);if(a.merge)o=new X(s.fieldMask),u=s.fieldTransforms;else if(a.mergeFields){var l=[],h=!0,f=!1,d=void 0;try{for(var v,y=a.mergeFields[Symbol.iterator]();!(h=(v=y.next()).done);h=!0){var p=v.value,g=Bs(t,p,n);if(!s.contains(g))throw new S(E.INVALID_ARGUMENT,"Field '".concat(g,"' is specified in your field mask but missing from your input data."));zs(l,g)||l.push(g)}}catch(e){f=!0,d=e}finally{try{h||null==y.return||y.return()}finally{if(f)throw d}}o=new X(l),u=s.fieldTransforms.filter((function(e){return o.covers(e.field)}))}else o=null,u=s.fieldTransforms;return new _s(new Ie(c),o,u)}function Os(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Ps(n,e.lc(r?4:3,t))}function Ps(e,t){if(Fs(e=l.getModularInstance(e)))return qs("Unsupported field value:",t,e),Us(e,t);if(e instanceof xs)return function(e,t){if(!Ds(t.ec))throw t.ac("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.ac("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.ic&&4!==t.ec)throw t.ac("Nested arrays are not supported");return function(e,t){var n=[],r=0,i=!0,a=!1,s=void 0;try{for(var o,u=e[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var c=Ps(o.value,t.uc(r));null==c&&(c={nullValue:"NULL_VALUE"}),n.push(c),r++}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=l.getModularInstance(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Tt(t.M,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=F.fromDate(e);return{timestampValue:In(t.M,n)}}if(e instanceof F){var r=new F(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:In(t.M,r)}}if(e instanceof As)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Is)return{bytesValue:xn(t.M,e._byteString)};if(e instanceof ys){var i=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(i))throw t.ac("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(i.projectId,"/").concat(i.database));return{referenceValue:_n(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.ac("Unsupported field value: ".concat(hs(e)))}(e,t)}function Us(e,t){var n={};return j(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):G(e,(function(e,r){var i=Ps(r,t.sc(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function Fs(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof F||e instanceof As||e instanceof Is||e instanceof ys||e instanceof xs)}function qs(e,t,n){if(!Fs(n)||("object"!=typeof(i=n)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i))){var r=hs(n);throw"an object"===r?t.ac(e+" a custom object"):t.ac(e+" "+r)}var i}function Bs(e,t,n){if((t=l.getModularInstance(t))instanceof Ss)return t._internalPath;if("string"==typeof t)return js(e,t);throw Ks("Field path arguments must be of type string or ",e,!1,void 0,n)}var Gs=new RegExp("[~\\*/\\[\\]]");function js(e,t,n){if(t.search(Gs)>=0)throw Ks("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return i.construct(Ss,i.toConsumableArray(t.split(".")))._internalPath}catch(r){throw Ks("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function Ks(e,t,n,r,i){var a=r&&!r.isEmpty(),s=void 0!==i,o="Function ".concat(t,"() called with invalid data");n&&(o+=" (via `toFirestore()`)"),o+=". ";var u="";return(a||s)&&(u+=" (found",a&&(u+=" in field ".concat(r)),s&&(u+=" in document ".concat(i)),u+=")"),new S(E.INVALID_ARGUMENT,o+e+u)}function zs(e,t){return e.some((function(e){return e.isEqual(t)}))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Hs=function(){"use strict";function e(t,n,r,a,s){i.classCallCheck(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=a,this._converter=s}return i.createClass(e,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new ys(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new Ws(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(Xs("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),e}(),Ws=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(){return i.classCallCheck(this,n),t.apply(this,arguments)}return i.createClass(n,[{key:"data",value:function(){return i.get(i.getPrototypeOf(n.prototype),"data",this).call(this)}}]),n}(Hs);function Xs(e,t){return"string"==typeof t?js(e,t):t instanceof Ss?t._internalPath:t._delegate._internalPath}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qs=function(){"use strict";function e(t,n){i.classCallCheck(this,e),this.hasPendingWrites=t,this.fromCache=n}return i.createClass(e,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),e}(),Ys=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e,r,a,s,o,u){var c;return i.classCallCheck(this,n),(c=t.call(this,e,r,a,s,u))._firestore=e,c._firestoreImpl=e,c.metadata=o,i.possibleConstructorReturn(c)}return i.createClass(n,[{key:"exists",value:function(){return i.get(i.getPrototypeOf(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new Js(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(Xs("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),n}(Hs),Js=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(){return i.classCallCheck(this,n),t.apply(this,arguments)}return i.createClass(n,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.get(i.getPrototypeOf(n.prototype),"data",this).call(this,e)}}]),n}(Ys),Zs=function(){"use strict";function e(t,n,r,a){i.classCallCheck(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=a,this.metadata=new Qs(a.hasPendingWrites,a.fromCache),this.query=r}return i.createClass(e,[{key:"docs",get:function(){var e=[];return this.forEach((function(t){return e.push(t)})),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach((function(r){e.call(t,new Js(n._firestore,n._userDataWriter,r.key,r,new Qs(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))}},{key:"docChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new S(E.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map((function(t){return{type:"added",doc:new Js(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Qs(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:n++}}))}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((function(e){return t||3!==e.type})).map((function(t){var n=new Js(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Qs(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(a=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:$s(t.type),doc:n,oldIndex:i,newIndex:a}}))}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}]),e}();function $s(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return C()}}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function eo(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new S(E.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var to=function e(){"use strict";i.classCallCheck(this,e)};function no(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=!0,a=!1,s=void 0;try{for(var o,u=n[Symbol.iterator]();!(i=(o=u.next()).done);i=!0){var c=o.value;e=c._apply(e)}}catch(e){a=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(a)throw s}}return e}var ro=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e,r,a){var s;return i.classCallCheck(this,n),(s=t.call(this))._c=e,s.wc=r,s.mc=a,s.type="where",i.possibleConstructorReturn(s)}return i.createClass(n,[{key:"_apply",value:function(e){var t,n,r,i=Ms(e.firestore),a=function(e,t,n,r,i,a,s){var o;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new S(E.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){uo(s,a);var u=[],c=!0,l=!1,h=void 0;try{for(var f,d=s[Symbol.iterator]();!(c=(f=d.next()).done);c=!0){var v=f.value;u.push(oo(r,e,v))}}catch(e){l=!0,h=e}finally{try{c||null==d.return||d.return()}finally{if(l)throw h}}o={arrayValue:{values:u}}}else o=oo(r,e,s)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||uo(s,a),o=Os(n,"where",s,"in"===a||"not-in"===a);var y=Ke.create(i,a,o);return function(e,t){if(t.S()){var n=ut(e);if(null!==n&&!n.isEqual(t.field))throw new S(E.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(t.field.toString(),"'"));var r=ot(e);null!==r&&co(e,t.field,r)}var i=function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,s=e.filters[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;if(t.indexOf(o.op)>=0)return o.op}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==i)throw i===t.op?new S(E.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new S(E.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(i.toString(),"' filters."))}(e,y),y}(e._query,0,i,e.firestore._databaseId,this._c,this.wc,this.mc);return new ps(e.firestore,e.converter,(t=e._query,n=a,r=t.filters.concat([n]),new it(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)))}}]),n}(to);function io(e,t,n){var r=t,i=Xs("where",e);return new ro(i,r,n)}var ao=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e,r){var a;return i.classCallCheck(this,n),(a=t.call(this))._c=e,a.gc=r,a.type="orderBy",i.possibleConstructorReturn(a)}return i.createClass(n,[{key:"_apply",value:function(e){var t,n,r,i=function(e,t,n){if(null!==e.startAt)throw new S(E.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new S(E.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new et(t,n);return function(e,t){if(null===ot(e)){var n=ut(e);null!==n&&co(e,n,t.field)}}(e,r),r}(e._query,this._c,this.gc);return new ps(e.firestore,e.converter,(t=e._query,n=i,r=t.explicitOrderBy.concat([n]),new it(t.path,t.collectionGroup,r,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))}}]),n}(to);function so(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=t,r=Xs("orderBy",e);return new ao(r,n)}function oo(e,t,n){if("string"==typeof(n=l.getModularInstance(n))){if(""===n)throw new S(E.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ct(t)&&-1!==n.indexOf("/"))throw new S(E.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));var r=t.path.child(z.fromString(n));if(!ce.isDocumentKey(r))throw new S(E.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return me(e,new ce(r))}if(n instanceof ys)return me(e,n._key);throw new S(E.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(hs(n),"."))}function uo(e,t){if(!Array.isArray(e)||0===e.length)throw new S(E.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."));if(e.length>10)throw new S(E.INVALID_ARGUMENT,"Invalid Query. '".concat(t.toString(),"' filters support a maximum of 10 elements in the value array."))}function co(e,t,n){if(!n.isEqual(t))throw new S(E.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var lo=function(){"use strict";function e(){i.classCallCheck(this,e)}return i.createClass(e,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(he(e)){case 0:return null;case 1:return e.booleanValue;case 2:return $(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ee(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw C()}}},{key:"convertObject",value:function(e,t){var n=this,r={};return G(e.fields,(function(e,i){r[e]=n.convertValue(i,t)})),r}},{key:"convertGeoPoint",value:function(e){return new As($(e.latitude),$(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map((function(e){return n.convertValue(e,t)}))}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=ne(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(re(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=Z(e);return new F(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=z.fromString(e);T(Qn(n));var r=new ae(n.get(1),n.get(3)),i=new ce(n.popFirst(5));return r.isEqual(t)||m("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}]),e}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function ho(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var fo=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e){var r;return i.classCallCheck(this,n),(r=t.call(this)).firestore=e,i.possibleConstructorReturn(r)}return i.createClass(n,[{key:"convertBytes",value:function(e){return new Is(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new ys(this.firestore,null,t)}}]),n}(lo);function vo(e){e=fs(e,ps);var t=fs(e.firestore,Cs),n=bs(t),r=new fo(t);return eo(e._query),ss(n,e._query).then((function(n){return new Zs(t,r,e,n)}))}function yo(e){return go(fs(e.firestore,Cs),[new Jt(e._key,Ot.none())])}function po(e,t){var n=fs(e.firestore,Cs),r=ks(e),i=ho(e.converter,t);return go(n,[Vs(Ms(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Ot.exists(!1))]).then((function(){return r}))}function go(e,n){return r=bs(e),a=n,o=new I,r.asyncQueue.enqueueAndForget(i.asyncToGenerator(t(s).mark((function e(){return t(s).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=wa,e.next=3,rs(r);case 3:return e.t1=e.sent,e.t2=a,e.t3=o,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 7:case"end":return e.stop()}}),e)})))),o.promise;var r,a,o}!function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t=o.SDK_VERSION,v=t,o._registerComponent(new u.Component("firestore",(function(e,t){var r=t.options,i=e.getProvider("app").getImmediate(),a=new Cs(i,new N(e.getProvider("auth-internal")),new L(e.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:n},r),a._setSettings(r),a}),"PUBLIC")),o.registerVersion(f,"3.4.9",e),o.registerVersion(f,"3.4.9","esm2017")}()})),a.register("6RwJk",(function(t,r){e(t.exports,"createWebChannelTransport",(function(){return fr})),e(t.exports,"getStatEventTarget",(function(){return dr})),e(t.exports,"ErrorCode",(function(){return vr})),e(t.exports,"EventType",(function(){return yr})),e(t.exports,"Event",(function(){return pr})),e(t.exports,"Stat",(function(){return gr})),e(t.exports,"FetchXmlHttpFactory",(function(){return mr})),e(t.exports,"WebChannel",(function(){return kr})),e(t.exports,"XhrIo",(function(){return wr}));var i,s=a("8TSCy"),o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:{},u={},c=c||{},l=o||self;function h(){}function f(e){var t=void 0===e?"undefined":s.typeOf(e);return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function v(e){var t=void 0===e?"undefined":s.typeOf(e);return"object"==t&&null!=e||"function"==t}var y="closure_uid_"+(1e9*Math.random()>>>0),p=0;function g(e,t,n){return e.call.apply(e.bind,arguments)}function m(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function k(e,t,n){return(k=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?g:m).apply(null,arguments)}function w(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function C(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function T(){this.s=this.s,this.o=this.o}var b={};T.prototype.s=!1,T.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,y)&&e[y]||(e[y]=++p)}(this);delete b[e]}},T.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var E=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},S=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"==typeof e?e.split(""):e,a=0;a<r;a++)a in i&&t.call(n,i[a],a,e)};function I(e){return Array.prototype.concat.apply([],arguments)}function x(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function A(e){return/^[\s\xa0]*$/.test(e)}var N,_=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function D(e,t){return-1!=e.indexOf(t)}function R(e,t){return e<t?-1:e>t?1:0}e:{var L=l.navigator;if(L){var M=L.userAgent;if(M){N=M;break e}}N=""}function V(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function O(e){var t={};for(var n in e)t[n]=e[n];return t}var P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function U(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var a=0;a<P.length;a++)n=P[a],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function F(e){return F[" "](e),e}F[" "]=h;var q,B,G=D(N,"Opera"),j=D(N,"Trident")||D(N,"MSIE"),K=D(N,"Edge"),z=K||j,H=D(N,"Gecko")&&!(D(N.toLowerCase(),"webkit")&&!D(N,"Edge"))&&!(D(N,"Trident")||D(N,"MSIE"))&&!D(N,"Edge"),W=D(N.toLowerCase(),"webkit")&&!D(N,"Edge");function X(){var e=l.document;return e?e.documentMode:void 0}e:{var Q="",Y=(B=N,H?/rv:([^\);]+)(\)|;)/.exec(B):K?/Edge\/([\d\.]+)/.exec(B):j?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(B):W?/WebKit\/(\S+)/.exec(B):G?/(?:Version)[ \/]?(\S+)/.exec(B):void 0);if(Y&&(Q=Y?Y[1]:""),j){var J=X();if(null!=J&&J>parseFloat(Q)){q=String(J);break e}}q=Q}var Z,$={};function ee(){return function(e){var t=$;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=e(9)}((function(){for(var e=0,t=_(String(q)).split("."),n=_("9").split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var a=t[i]||"",s=n[i]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=R(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||R(0==a[2].length,0==s[2].length)||R(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}if(l.document&&j){var te=X();Z=te||(parseInt(q,10)||void 0)}else Z=void 0;var ne=Z,re=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{l.addEventListener("test",h,t),l.removeEventListener("test",h,t)}catch(e){}return e}();function ie(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function ae(e,t){if(ie.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(H){e:{try{F(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:se[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&ae.Z.h.call(this)}}ie.prototype.h=function(){this.defaultPrevented=!0},C(ae,ie);var se={2:"touch",3:"pen",4:"mouse"};ae.prototype.h=function(){ae.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var oe="closure_listenable_"+(1e6*Math.random()|0),ue=0;function ce(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++ue,this.ca=this.fa=!1}function le(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function he(e){this.src=e,this.g={},this.h=0}function fe(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=E(i,t);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(le(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function de(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.ca&&a.listener==t&&a.capture==!!n&&a.ia==r)return i}return-1}he.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var s=de(e,t,r,i);return-1<s?(t=e[s],n||(t.fa=!1)):((t=new ce(t,this.src,a,!!r,i)).fa=n,e.push(t)),t};var ve="closure_lm_"+(1e6*Math.random()|0),ye={};function pe(e,t,n,r,i){if(r&&r.once)return me(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)pe(e,t[a],n,r,i);return null}return n=Se(n),e&&e[oe]?e.N(t,n,v(r)?!!r.capture:!!r,i):ge(e,t,n,!1,r,i)}function ge(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var s=v(i)?!!i.capture:!!i,o=be(e);if(o||(e[ve]=o=new he(e)),(n=o.add(t,n,r,s,a)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}var t=Te;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)re||(i=s),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Ce(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function me(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)me(e,t[a],n,r,i);return null}return n=Se(n),e&&e[oe]?e.O(t,n,v(r)?!!r.capture:!!r,i):ge(e,t,n,!0,r,i)}function ke(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)ke(e,t[a],n,r,i);else r=v(r)?!!r.capture:!!r,n=Se(n),e&&e[oe]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=de(a=e.g[t],n,r,i))&&(le(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--)))):e&&(e=be(e))&&(t=e.g[t.toString()],e=-1,t&&(e=de(t,n,r,i)),(n=-1<e?t[e]:null)&&we(n))}function we(e){if("number"!=typeof e&&e&&!e.ca){var t=e.src;if(t&&t[oe])fe(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Ce(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=be(t))?(fe(n,e),0==n.h&&(n.src=null,t[ve]=null)):le(e)}}}function Ce(e){return e in ye?ye[e]:ye[e]="on"+e}function Te(e,t){if(e.ca)e=!0;else{t=new ae(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&we(e),e=n.call(r,t)}return e}function be(e){return(e=e[ve])instanceof he?e:null}var Ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function Se(e){return"function"==typeof e?e:(e[Ee]||(e[Ee]=function(t){return e.handleEvent(t)}),e[Ee])}function Ie(){T.call(this),this.i=new he(this),this.P=this,this.I=null}function xe(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new ie(t,e);else if(t instanceof ie)t.target=t.target||e;else{var i=t;U(t=new ie(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var s=t.g=n[a];i=Ae(s,r,!0,t)&&i}if(i=Ae(s=t.g=e,r,!0,t)&&i,i=Ae(s,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=Ae(s=t.g=n[a],r,!1,t)&&i}function Ae(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var s=t[a];if(s&&!s.ca&&s.capture==n){var o=s.listener,u=s.ia||s.src;s.fa&&fe(e.i,s),i=!1!==o.call(u,r)&&i}}return i&&!r.defaultPrevented}C(Ie,T),Ie.prototype[oe]=!0,Ie.prototype.removeEventListener=function(e,t,n,r){ke(this,e,t,n,r)},Ie.prototype.M=function(){if(Ie.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)le(n[r]);delete t.g[e],t.h--}}this.I=null},Ie.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Ie.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var Ne=l.JSON.stringify;function _e(){var e=Ue,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var De,Re=function(){"use strict";function e(){s.classCallCheck(this,e),this.h=this.g=null}return s.createClass(e,[{key:"add",value:function(e,t){var n=Le.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),e}(),Le=new(function(){"use strict";function e(t,n){s.classCallCheck(this,e),this.i=t,this.j=n,this.h=0,this.g=null}return s.createClass(e,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),e}())((function(){return new Me}),(function(e){return e.reset()})),Me=function(){"use strict";function e(){s.classCallCheck(this,e),this.next=this.g=this.h=null}return s.createClass(e,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),e}();function Ve(e){l.setTimeout((function(){throw e}),0)}function Oe(e,t){De||function(){var e=l.Promise.resolve(void 0);De=function(){e.then(Fe)}}(),Pe||(De(),Pe=!0),Ue.add(e,t)}var Pe=!1,Ue=new Re;function Fe(){for(var e;e=_e();){try{e.h.call(e.g)}catch(e){Ve(e)}var t=Le;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Pe=!1}function qe(e,t){Ie.call(this),this.h=e||1,this.g=t||l,this.j=k(this.kb,this),this.l=Date.now()}function Be(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function Ge(e,t,n){if("function"==typeof e)n&&(e=k(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=k(e.handleEvent,e)}return 2147483647<Number(t)?-1:l.setTimeout(e,t||0)}function je(e){e.g=Ge((function(){e.g=null,e.i&&(e.i=!1,je(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}C(qe,Ie),(i=qe.prototype).da=!1,i.S=null,i.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),xe(this,"tick"),this.da&&(Be(this),this.start()))}},i.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},i.M=function(){qe.Z.M.call(this),Be(this),delete this.g};var Ke=function(e){"use strict";s.inherits(n,e);var t=s.createSuper(n);function n(e,r){var i;return s.classCallCheck(this,n),(i=t.call(this)).m=e,i.j=r,i.h=null,i.i=!1,i.g=null,i}return s.createClass(n,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:je(this)}},{key:"M",value:function(){s.get(s.getPrototypeOf(n.prototype),"M",this).call(this),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),n}(T);function ze(e){T.call(this),this.h=e,this.g={}}C(ze,T);var He=[];function We(e,t,n,r){Array.isArray(n)||(n&&(He[0]=n.toString()),n=He);for(var i=0;i<n.length;i++){var a=pe(t,n[i],r||e.handleEvent,!1,e.h||e);if(!a)break;e.g[a.key]=a}}function Xe(e){V(e.g,(function(e,t){this.g.hasOwnProperty(t)&&we(e)}),e),e.g={}}function Qe(){this.g=!0}function Ye(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var s=1;s<i.length;s++)i[s]=""}}}return Ne(n)}catch(e){return t}}(e,n)+(r?" "+r:"")}))}ze.prototype.M=function(){ze.Z.M.call(this),Xe(this)},ze.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Qe.prototype.Aa=function(){this.g=!1},Qe.prototype.info=function(){};var Je={},Ze=null;function $e(){return Ze=Ze||new Ie}function et(e){ie.call(this,Je.Ma,e)}function tt(e){var t=$e();xe(t,new et(t,e))}function nt(e,t){ie.call(this,Je.STAT_EVENT,e),this.stat=t}function rt(e){var t=$e();xe(t,new nt(t,e))}function it(e,t){ie.call(this,Je.Na,e),this.size=t}function at(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return l.setTimeout((function(){e()}),t)}Je.Ma="serverreachability",C(et,ie),Je.STAT_EVENT="statevent",C(nt,ie),Je.Na="timingevent",C(it,ie);var st={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},ot={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function ut(){}function ct(e){return e.h||(e.h=e.i())}function lt(){}ut.prototype.h=null;var ht,ft={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function dt(){ie.call(this,"d")}function vt(){ie.call(this,"c")}function yt(){}function pt(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new ze(this),this.P=mt,e=z?125:void 0,this.W=new qe(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new gt}function gt(){this.i=null,this.g="",this.h=!1}C(dt,ie),C(vt,ie),C(yt,ut),yt.prototype.g=function(){return new XMLHttpRequest},yt.prototype.i=function(){return{}},ht=new yt;var mt=45e3,kt={},wt={};function Ct(e,t,n){e.K=1,e.v=Kt(Ut(t)),e.s=n,e.U=!0,Tt(e,null)}function Tt(e,t){e.F=Date.now(),It(e),e.A=Ut(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),rn(n.h,"t",r),e.C=0,n=e.l.H,e.h=new gt,e.g=ar(e.l,n?t:null,!e.s),0<e.O&&(e.L=new Ke(k(e.Ia,e,e.g),e.O)),We(e.V,e.g,"readystatechange",e.gb),t=e.H?O(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),tt(1),function(e,t,n,r,i,a){e.info((function(){if(e.g)if(a)for(var s="",o=a.split("&"),u=0;u<o.length;u++){var c=o[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");s=2<=h.length&&"type"==h[1]?s+(l+"=")+c+"&":s+(l+"=redacted&")}}else s=null;else s=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+s}))}(e.j,e.u,e.A,e.m,e.X,e.s)}function bt(e){return!!e.g&&("GET"==e.u&&2!=e.K&&e.l.Ba)}function Et(e,t,n){for(var r,i=!0;!e.I&&e.C<n.length;){if((r=St(e,n))==wt){4==t&&(e.o=4,rt(14),i=!1),Ye(e.j,e.m,null,"[Incomplete Response]");break}if(r==kt){e.o=4,rt(15),Ye(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}Ye(e.j,e.m,r,null),Dt(e,r)}bt(e)&&r!=wt&&r!=kt&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,rt(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Jn(t),t.L=!0,rt(11))):(Ye(e.j,e.m,n,"[Invalid Chunked Response]"),_t(e),Nt(e))}function St(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?wt:(n=Number(t.substring(n,r)),isNaN(n)?kt:(r+=1)+n>t.length?wt:(t=t.substr(r,n),e.C=r+n,t))}function It(e){e.Y=Date.now()+e.P,xt(e,e.P)}function xt(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=at(k(e.eb,e),t)}function At(e){e.B&&(l.clearTimeout(e.B),e.B=null)}function Nt(e){0==e.l.G||e.I||er(e.l,e)}function _t(e){At(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,Be(e.W),Xe(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function Dt(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||hn(n.i,e)))if(n.I=e.N,!e.J&&hn(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch(a){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;$n(n),Gn(n)}Yn(n),rt(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=at(k(n.ab,n),6e3));if(1>=ln(n.i)&&n.ka){try{n.ka()}catch(a){}n.ka=void 0}}else nr(n,11)}else if((e.J||n.g==e)&&$n(n),!A(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){var a=i[t];if(n.U=a[0],a=a[1],2==n.G)if("c"==a[0]){n.J=a[1],n.la=a[2];var s=a[3];null!=s&&(n.ma=s,n.h.info("VER="+n.ma));var o=a[4];null!=o&&(n.za=o,n.h.info("SVER="+n.za));var u=a[5];null!=u&&"number"==typeof u&&0<u&&(r=1.5*u,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;!h.g&&(D(l,"spdy")||D(l,"quic")||D(l,"h2"))&&(h.j=h.l,h.g=new Set,h.h&&(fn(h,h.h),h.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,jt(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=e;if((r=n).oa=ir(r,r.H?r.la:null,r.W),d.J){dn(r.i,d);var v=d,y=r.K;y&&v.setTimeout(y),v.B&&(At(v),It(v)),r.g=d}else Qn(r);0<n.l.length&&zn(n)}else"stop"!=a[0]&&"close"!=a[0]||nr(n,7);else 3==n.G&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?nr(n,7):Bn(n):"noop"!=a[0]&&n.j&&n.j.wa(a),n.A=0)}tt(4)}catch(a){}}function Rt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(f(e)||"string"==typeof e)S(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(f(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"==typeof e)return e.split("");if(f(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length;for(var a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}}function Lt(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof Lt)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function Mt(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];Vt(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)Vt(i,r=e.g[t])||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}function Vt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(i=pt.prototype).setTimeout=function(e){this.P=e},i.gb=function(e){e=e.target;var t=this.L;t&&3==On(e)?t.l():this.Ia(e)},i.Ia=function(e){try{if(e==this.g)e:{var t=On(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>t)&&(3!=t||z||this.g&&(this.h.h||this.g.ga()||Pn(this.g)))){this.I||4!=t||7==n||tt(8==n||0>=r?3:2),At(this);var i=this.g.ba();this.N=i;t:if(bt(this)){var a=Pn(this.g);e="";var s=a.length,o=4==On(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){_t(this),Nt(this);var u="";break t}this.h.i=new l.TextDecoder}for(n=0;n<s;n++)this.h.h=!0,e+=this.h.i.decode(a[n],{stream:o&&n==s-1});a.splice(0,s),this.h.g+=e,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(e,t,n,r,i,a,s){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+s}))}(this.j,this.u,this.A,this.m,this.X,t,i),this.i){if(this.$&&!this.J){t:{if(this.g){var c,h=this.g;if((c=h.g?h.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(c)){var f=c;break t}}f=null}if(!(i=f)){this.i=!1,this.o=3,rt(12),_t(this),Nt(this);break e}Ye(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Dt(this,i)}this.U?(Et(this,t,u),z&&this.i&&3==t&&(We(this.V,this.W,"tick",this.fb),this.W.start())):(Ye(this.j,this.m,u,null),Dt(this,u)),4==t&&_t(this),this.i&&!this.I&&(4==t?er(this.l,this):(this.i=!1,It(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,rt(12)):(this.o=0,rt(13)),_t(this),Nt(this)}}}catch(t){}},i.fb=function(){if(this.g){var e=On(this.g),t=this.g.ga();this.C<t.length&&(At(this),Et(this,e,t),this.i&&4!=e&&It(this))}},i.cancel=function(){this.I=!0,_t(this)},i.eb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.K&&(tt(3),rt(17)),_t(this),this.o=2,Nt(this)):xt(this,this.Y-e)},(i=Lt.prototype).R=function(){Mt(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},i.T=function(){return Mt(this),this.g.concat()},i.get=function(e,t){return Vt(this.h,e)?this.h[e]:t},i.set=function(e,t){Vt(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},i.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],a=this.get(i);e.call(t,a,i,this)}};var Ot=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Pt(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof Pt){this.g=void 0!==t?t:e.g,Ft(this,e.j),this.s=e.s,qt(this,e.i),Bt(this,e.m),this.l=e.l,t=e.h;var n=new $t;n.i=t.i,t.g&&(n.g=new Lt(t.g),n.h=t.h),Gt(this,n),this.o=e.o}else e&&(n=String(e).match(Ot))?(this.g=!!t,Ft(this,n[1]||"",!0),this.s=zt(n[2]||""),qt(this,n[3]||"",!0),Bt(this,n[4]),this.l=zt(n[5]||"",!0),Gt(this,n[6]||"",!0),this.o=zt(n[7]||"")):(this.g=!!t,this.h=new $t(null,this.g))}function Ut(e){return new Pt(e)}function Ft(e,t,n){e.j=n?zt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function qt(e,t,n){e.i=n?zt(t,!0):t}function Bt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Gt(e,t,n){t instanceof $t?(e.h=t,function(e,t){t&&!e.j&&(en(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(tn(this,t),rn(this,n,e))}),e)),e.j=t}(e.h,e.g)):(n||(t=Ht(t,Jt)),e.h=new $t(t,e.g))}function jt(e,t,n){e.h.set(t,n)}function Kt(e){return jt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function zt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Ht(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Wt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Wt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Pt.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Ht(t,Xt,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Ht(t,Xt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(Ht(n,"/"==n.charAt(0)?Yt:Qt,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Ht(n,Zt)),e.join("")};var Xt=/[#\/\?@]/g,Qt=/[#\?:]/g,Yt=/[#\?]/g,Jt=/[#\?@]/g,Zt=/#/g;function $t(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function en(e){e.g||(e.g=new Lt,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function tn(e,t){en(e),t=an(e,t),Vt(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,Vt((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&Mt(e)))}function nn(e,t){return en(e),t=an(e,t),Vt(e.g.h,t)}function rn(e,t,n){tn(e,t),0<n.length&&(e.i=null,e.g.set(an(e,t),x(n)),e.h+=n.length)}function an(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(i=$t.prototype).add=function(e,t){en(this),this.i=null,e=an(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},i.forEach=function(e,t){en(this),this.g.forEach((function(n,r){S(n,(function(n){e.call(t,n,r,this)}),this)}),this)},i.T=function(){en(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],a=0;a<i.length;a++)n.push(t[r]);return n},i.R=function(e){en(this);var t=[];if("string"==typeof e)nn(this,e)&&(t=I(t,this.g.get(an(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=I(t,e[n])}return t},i.set=function(e,t){return en(this),this.i=null,nn(this,e=an(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},i.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},i.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var a=0;a<r.length;a++){var s=i;""!==r[a]&&(s+="="+encodeURIComponent(String(r[a]))),e.push(s)}}return this.i=e.join("&")};var sn=function e(t,n){"use strict";s.classCallCheck(this,e),this.h=t,this.g=n};function on(e){this.l=e||un,l.PerformanceNavigationTiming?e=0<(e=l.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(l.g&&l.g.Ea&&l.g.Ea()&&l.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var un=10;function cn(e){return!!e.h||!!e.g&&e.g.size>=e.j}function ln(e){return e.h?1:e.g?e.g.size:0}function hn(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function fn(e,t){e.g?e.g.add(t):e.h=t}function dn(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function vn(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var t=e.i,n=!0,r=!1,i=void 0;try{for(var a,s=e.g.values()[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var o=a.value;t=t.concat(o.D)}}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t}return x(e.i)}function yn(){}function pn(){this.g=new yn}function gn(e,t,n){var r=n||"";try{Rt(e,(function(e,n){var i=e;v(e)&&(i=Ne(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function mn(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}function kn(e){this.l=e.$b||null,this.j=e.ib||!1}function wn(e,t){Ie.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=Cn,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}on.prototype.cancel=function(){if(this.i=vn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e=!0,t=!1,n=void 0;try{for(var r,i=this.g.values()[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){r.value.cancel()}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}this.g.clear()}},yn.prototype.stringify=function(e){return l.JSON.stringify(e,void 0)},yn.prototype.parse=function(e){return l.JSON.parse(e,void 0)},C(kn,ut),kn.prototype.g=function(){return new wn(this.l,this.j)},kn.prototype.i=function(e){return function(){return e}}({}),C(wn,Ie);var Cn=0;function Tn(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function bn(e){e.readyState=4,e.l=null,e.j=null,e.A=null,En(e)}function En(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(i=wn.prototype).open=function(e,t){if(this.readyState!=Cn)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,En(this)},i.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||l).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},i.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,bn(this)),this.readyState=Cn},i.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,En(this)),this.g&&(this.readyState=3,En(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==l.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Tn(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},i.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?bn(this):En(this),3==this.readyState&&Tn(this)}},i.Ua=function(e){this.g&&(this.response=this.responseText=e,bn(this))},i.Ta=function(e){this.g&&(this.response=e,bn(this))},i.ha=function(){this.g&&bn(this)},i.setRequestHeader=function(e,t){this.v.append(e,t)},i.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(wn.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Sn=l.JSON.parse;function In(e){Ie.call(this),this.headers=new Lt,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=xn,this.K=this.L=!1}C(In,Ie);var xn="",An=/^https?$/i,Nn=["POST","PUT"];function _n(e){return"content-type"==e.toLowerCase()}function Dn(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Rn(e),Mn(e)}function Rn(e){e.D||(e.D=!0,xe(e,"complete"),xe(e,"error"))}function Ln(e){if(e.h&&void 0!==c&&(!e.C[1]||4!=On(e)||2!=e.ba()))if(e.v&&4==On(e))Ge(e.Fa,0,e);else if(xe(e,"readystatechange"),4==On(e)){e.h=!1;try{var t,n=e.ba();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var a=String(e.H).match(Ot)[1]||null;if(!a&&l.self&&l.self.location){var s=l.self.location.protocol;a=s.substr(0,s.length-1)}i=!An.test(a?a.toLowerCase():"")}t=i}if(t)xe(e,"complete"),xe(e,"success");else{e.m=6;try{var o=2<On(e)?e.g.statusText:""}catch(e){o=""}e.j=o+" ["+e.ba()+"]",Rn(e)}}finally{Mn(e)}}}function Mn(e,t){if(e.g){Vn(e);var n=e.g,r=e.C[0]?h:null;e.g=null,e.C=null,t||xe(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function Vn(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(l.clearTimeout(e.A),e.A=null)}function On(e){return e.g?e.g.readyState:0}function Pn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case xn:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Un(e,t,n){e:{for(d in n){break e}d=!0}d||(n=function(e){var t="";return V(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):jt(e,t,n))}function Fn(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function qn(e){this.za=0,this.l=[],this.h=new Qe,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Fn("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Fn("baseRetryDelayMs",5e3,e),this.$a=Fn("retryDelaySeedMs",1e4,e),this.Ya=Fn("forwardChannelMaxRetries",2,e),this.ra=Fn("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new on(e&&e.concurrentRequestLimit),this.Ca=new pn,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function Bn(e){if(jn(e),3==e.G){var t=e.V++,n=Ut(e.F);jt(n,"SID",e.J),jt(n,"RID",t),jt(n,"TYPE","terminate"),Wn(e,n),(t=new pt(e,e.h,t,void 0)).K=2,t.v=Kt(Ut(n)),n=!1,l.navigator&&l.navigator.sendBeacon&&(n=l.navigator.sendBeacon(t.v.toString(),"")),!n&&l.Image&&((new Image).src=t.v,n=!0),n||(t.g=ar(t.l,null),t.g.ea(t.v)),t.F=Date.now(),It(t)}rr(e)}function Gn(e){e.g&&(Jn(e),e.g.cancel(),e.g=null)}function jn(e){Gn(e),e.u&&(l.clearTimeout(e.u),e.u=null),$n(e),e.i.cancel(),e.m&&("number"==typeof e.m&&l.clearTimeout(e.m),e.m=null)}function Kn(e,t){e.l.push(new sn(e.Za++,t)),3==e.G&&zn(e)}function zn(e){cn(e.i)||e.m||(e.m=!0,Oe(e.Ha,e),e.C=0)}function Hn(e,t){var n;n=t?t.m:e.V++;var r=Ut(e.F);jt(r,"SID",e.J),jt(r,"RID",n),jt(r,"AID",e.U),Wn(e,r),e.o&&e.s&&Un(r,e.o,e.s),n=new pt(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=Xn(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),fn(e.i,n),Ct(n,r,t)}function Wn(e,t){e.j&&Rt({},(function(e,n){jt(t,n,e)}))}function Xn(e,t,n){n=Math.min(e.l.length,n);var r=e.j?k(e.j.Oa,e.j,e):null;e:for(var i=e.l,a=-1;;){var s=["count="+n];-1==a?0<n?(a=i[0].h,s.push("ofs="+a)):a=0:s.push("ofs="+a);for(var o=!0,u=0;u<n;u++){var c=i[u].h,l=i[u].g;if(0>(c-=a))a=Math.max(0,i[u].h-100),o=!1;else try{gn(l,s,"req"+c+"_")}catch(e){r&&r(l)}}if(o){r=s.join("&");break e}}return e=e.l.splice(0,n),t.D=e,r}function Qn(e){e.g||e.u||(e.Y=1,Oe(e.Ga,e),e.A=0)}function Yn(e){return!(e.g||e.u||3<=e.A)&&(e.Y++,e.u=at(k(e.Ga,e),tr(e,e.A)),e.A++,!0)}function Jn(e){null!=e.B&&(l.clearTimeout(e.B),e.B=null)}function Zn(e){e.g=new pt(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=Ut(e.oa);jt(t,"RID","rpc"),jt(t,"SID",e.J),jt(t,"CI",e.N?"0":"1"),jt(t,"AID",e.U),Wn(e,t),jt(t,"TYPE","xmlhttp"),e.o&&e.s&&Un(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=Kt(Ut(t)),n.s=null,n.U=!0,Tt(n,e)}function $n(e){null!=e.v&&(l.clearTimeout(e.v),e.v=null)}function er(e,t){var n=null;if(e.g==t){$n(e),Jn(e),e.g=null;var r=2}else{if(!hn(e.i,t))return;n=t.D,dn(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;xe(r=$e(),new it(r,n,t,i)),zn(e)}else Qn(e);else if(3==(i=t.o)||0==i&&0<e.I||!(1==r&&function(e,t){return!(ln(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.l=t.D.concat(e.l),0):1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya)||(e.m=at(k(e.Ha,e,t),tr(e,e.C)),e.C++,0)))}(e,t)||2==r&&Yn(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:nr(e,5);break;case 4:nr(e,10);break;case 3:nr(e,6);break;default:nr(e,2)}}function tr(e,t){var n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function nr(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=k(e.jb,e);n||(n=new Pt("//www.google.com/images/cleardot.gif"),l.location&&"http"==l.location.protocol||Ft(n,"https"),Kt(n)),function(e,t){var n=new Qe;if(l.Image){var r=new Image;r.onload=w(mn,n,r,"TestLoadImage: loaded",!0,t),r.onerror=w(mn,n,r,"TestLoadImage: error",!1,t),r.onabort=w(mn,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=w(mn,n,r,"TestLoadImage: timeout",!1,t),l.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else rt(2);e.G=0,e.j&&e.j.va(t),rr(e),jn(e)}function rr(e){e.G=0,e.I=-1,e.j&&(0==vn(e.i).length&&0==e.l.length||(e.i.i.length=0,x(e.l),e.l.length=0),e.j.ua())}function ir(e,t,n){var r=function(e){return e instanceof Pt?Ut(e):new Pt(e,void 0)}(n);if(""!=r.i)t&&qt(r,t+"."+r.i),Bt(r,r.m);else{var i=l.location;r=function(e,t,n,r){var i=new Pt(null,void 0);return e&&Ft(i,e),t&&qt(i,t),n&&Bt(i,n),r&&(i.l=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.aa&&V(e.aa,(function(e,t){jt(r,t,e)})),t=e.D,n=e.sa,t&&n&&jt(r,t,n),jt(r,"VER",e.ma),Wn(e,r),r}function ar(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ba&&!e.qa?new In(new kn({ib:!0})):new In(e.qa)).L=e.H,t}function sr(){}function or(){if(j&&!(10<=Number(ne)))throw Error("Environmental error: no available transport.")}function ur(e,t){Ie.call(this),this.g=new qn(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!A(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!A(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new hr(this)}function cr(e){dt.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function lr(){vt.call(this),this.status=1}function hr(e){this.g=e}(i=In.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():ht.g(),this.C=this.u?ct(this.u):ct(ht),this.g.onreadystatechange=k(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(e){return void Dn(this,e)}e=n||"";var i=new Lt(this.headers);r&&Rt(r,(function(e,t){i.set(t,e)})),r=function(e){e:{for(var t=_n,n=e.length,r="string"==typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(i.T()),n=l.FormData&&e instanceof l.FormData,!(0<=E(Nn,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(e,t){this.g.setRequestHeader(t,e)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Vn(this),0<this.B&&((this.K=function(e){return j&&ee()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=k(this.pa,this)):this.A=Ge(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){Dn(this,e)}},i.pa=function(){void 0!==c&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,xe(this,"timeout"),this.abort(8))},i.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,xe(this,"complete"),xe(this,"abort"),Mn(this))},i.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Mn(this,!0)),In.Z.M.call(this)},i.Fa=function(){this.s||(this.F||this.v||this.l?Ln(this):this.cb())},i.cb=function(){Ln(this)},i.ba=function(){try{return 2<On(this)?this.g.status:-1}catch(e){return-1}},i.ga=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},i.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Sn(t)}},i.Da=function(){return this.m},i.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(i=qn.prototype).ma=8,i.G=1,i.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(e){}},i.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;var t=new pt(this,this.h,e,void 0),n=this.s;if(this.P&&(n?U(n=O(n),this.P):n=this.P),null===this.o&&(t.H=n),this.ja)e:{for(var r=0,i=0;i<this.l.length;i++){var a=this.l[i];if(void 0===(a="__data__"in a.g&&"string"==typeof(a=a.g.__data__)?a.length:void 0))break;if(4096<(r+=a)){r=i;break e}if(4096===r||i===this.l.length-1){r=i+1;break e}}r=1e3}else r=1e3;r=Xn(this,t,r),jt(i=Ut(this.F),"RID",e),jt(i,"CVER",22),this.D&&jt(i,"X-HTTP-Session-Id",this.D),Wn(this,i),this.o&&n&&Un(i,this.o,n),fn(this.i,t),this.Ra&&jt(i,"TYPE","init"),this.ja?(jt(i,"$req",r),jt(i,"SID","null"),t.$=!0,Ct(t,i,null)):Ct(t,i,r),this.G=2}}else 3==this.G&&(e?Hn(this,e):0==this.l.length||cn(this.i)||Hn(this))},i.Ga=function(){if(this.u=null,Zn(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=at(k(this.bb,this),e)}},i.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,rt(10),Gn(this),Zn(this))},i.ab=function(){null!=this.v&&(this.v=null,Gn(this),Yn(this),rt(19))},i.jb=function(e){e?(this.h.info("Successfully pinged google.com"),rt(2)):(this.h.info("Failed to ping google.com"),rt(1))},(i=sr.prototype).xa=function(){},i.wa=function(){},i.va=function(){},i.ua=function(){},i.Oa=function(){},or.prototype.g=function(e,t){return new ur(e,t)},C(ur,Ie),ur.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),Oe(k(e.hb,e,t))),rt(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=ir(e,null,e.W),zn(e)},ur.prototype.close=function(){Bn(this.g)},ur.prototype.u=function(e){if("string"==typeof e){var t={};t.__data__=e,Kn(this.g,t)}else this.v?((t={}).__data__=Ne(e),Kn(this.g,t)):Kn(this.g,e)},ur.prototype.M=function(){this.g.j=null,delete this.j,Bn(this.g),delete this.g,ur.Z.M.call(this)},C(cr,dt),C(lr,vt),C(hr,sr),hr.prototype.xa=function(){xe(this.g,"a")},hr.prototype.wa=function(e){xe(this.g,new cr(e))},hr.prototype.va=function(e){xe(this.g,new lr(e))},hr.prototype.ua=function(){xe(this.g,"b")},or.prototype.createWebChannel=or.prototype.g,ur.prototype.send=ur.prototype.u,ur.prototype.open=ur.prototype.m,ur.prototype.close=ur.prototype.close,st.NO_ERROR=0,st.TIMEOUT=8,st.HTTP_ERROR=6,ot.COMPLETE="complete",lt.EventType=ft,ft.OPEN="a",ft.CLOSE="b",ft.ERROR="c",ft.MESSAGE="d",Ie.prototype.listen=Ie.prototype.N,In.prototype.listenOnce=In.prototype.O,In.prototype.getLastError=In.prototype.La,In.prototype.getLastErrorCode=In.prototype.Da,In.prototype.getStatus=In.prototype.ba,In.prototype.getResponseJson=In.prototype.Qa,In.prototype.getResponseText=In.prototype.ga,In.prototype.send=In.prototype.ea;var fr=u.createWebChannelTransport=function(){return new or},dr=u.getStatEventTarget=function(){return $e()},vr=u.ErrorCode=st,yr=u.EventType=ot,pr=u.Event=Je,gr=u.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},mr=u.FetchXmlHttpFactory=kn,kr=u.WebChannel=lt,wr=u.XhrIo=In}))}();
//# sourceMappingURL=postpage-spel.67588af8.js.map
