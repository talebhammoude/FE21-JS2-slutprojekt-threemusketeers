{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,gDCAAC,EAAAD,EAAA,mCAMA,MAAME,EAAMD,EAAAE,cAAcC,EAAAC,gBAIpBC,EAAKC,EAAAC,aAAaN,GAElBO,EAAWF,EAAAG,WAAWJ,EAAI,QAC1BK,EAAIJ,EAAAK,MAAMH,EAAUF,EAAAM,MAAM,WAAY,KAAM,GAAIN,EAAAO,QAAQ,SDA9D,IAAIC,EAAgBC,SAASC,cAAc,eACvCC,EAAyBC,aAAaC,QAAQ,aAClDL,EAAcM,MAAQF,aAAaC,QAAQ,aAC3CL,EAAcO,UAAYH,aAAaC,QAAQ,aAI/C,MAAMG,EAAMtB,EAAAE,cAAcC,EAAAC,gBAIpBmB,EAAKjB,EAAAC,aAAae,GAGlBE,EAAYT,SAASC,cAAc,eAAeK,UAClDI,EAAWV,SAASC,cAAc,cAClCU,EAAUX,SAASC,cAAc,cCbvCW,wBAEgCrB,EAAAsB,QAAQlB,IAEtBmB,SAASC,IAEvBf,SAASC,cAAc,cAAcK,WAAa,iEAUrDS,EAAAC,aAAAD,EAAAE,OAAAC,SAAAH,EAAAE,OAAAC,wFDADC,GAwBAR,EAAQS,iBAAiB,SAAUC,IAC/BA,EAAEC,iBAtBNV,iBACE,MAAMW,EAAU,IAAIxC,EAAAyC,KAAKf,EAAWC,EAASL,MAAO,EAAG,IAAIoB,MAE3D,IACE,MAAMC,QAAenC,EAAAoC,OAAOpC,EAAAG,WAAWc,EAAI,QAAS,CAClDU,KAAMK,EAAQK,SACdC,KAAMN,EAAQM,KACdC,SAAUP,EAAQO,SAClBC,KAAMR,EAAQQ,OAEhBC,QAAQC,IAAI,6BAA8BP,EAAOV,IACjD,MAAOK,GACPW,QAAQE,MAAM,0BAA2Bb,IAWzCc,GACAzB,EAASL,MAAQ,MAIrB+B,YAGA,WAEIpC,SAASqC,iBAAiB,iBAAiBvB,SAASO,IAE/CA,EAAEiB,aAAa,UAAYpC,IAC5BmB,EAAEf,WAAa,wEAoBjB+B,iBAAM,UAAiBvB,SAAAO,uBACV,SAAYkB,IAEzBA,EAAAjB,gCAVHkB,SAIQjD,EAAAkD,UAAgBlD,EAAAwB,IAAAP,EAAA,OAAAgC,IAQvBE,CAAAH,EAAAI,KAAA,GAAA3B,YAjC6B","sources":["src/pages/postpage-spel.ts","src/modules/postlist-spel.ts"],"sourcesContent":["import {Post} from \"../modules/post\";\r\nimport { initializeApp } from \"firebase/app\";\r\nimport { getFirestore, collection, addDoc, doc, deleteDoc } from \"firebase/firestore\";\r\nimport { firebaseConfig } from \"../modules/firebaseconfig\";\r\n\r\n\r\nimport { renderPostListSpel } from \"../modules/postlist-spel\";\r\n\r\n\r\n\r\n\r\n\r\n\r\nlet loginUserName = document.querySelector(\".user-class\") as HTMLInputElement;\r\nlet storedLoginName:string = localStorage.getItem(\"loginName\");\r\nloginUserName.value = localStorage.getItem(\"loginName\");\r\nloginUserName.innerHTML = localStorage.getItem(\"loginName\");\r\n\r\n\r\n// Initialize Firebase\r\nconst app = initializeApp(firebaseConfig);\r\n\r\n\r\n// Initialize Cloud Firestore and get a reference to the service\r\nconst db = getFirestore(app);\r\n\r\n\r\nconst userValue = document.querySelector(\".user-class\").innerHTML;\r\nconst postText = document.querySelector(\".post-text\") as HTMLDataElement\r\nconst postBtn = document.querySelector(\".post-btn\");\r\n\r\n\r\nrenderPostListSpel();\r\n\r\n\r\nasync function writeToDb() {\r\n  const postObj = new Post(userValue, postText.value, 3, new Date());\r\n\r\n  try {\r\n    const docRef = await addDoc(collection(db, \"post\"), {\r\n      user: postObj.username,\r\n      text: postObj.text,\r\n      category: postObj.category,\r\n      time: postObj.time\r\n    });\r\n    console.log(\"Document written with ID: \", docRef.id);\r\n  } catch (e) {\r\n    console.error(\"Error adding document: \", e);\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\npostBtn.addEventListener(\"click\", (e)=>{\r\n    e.preventDefault();\r\n    writeToDb();\r\n    postText.value = \"\";\r\n})\r\n\r\n\r\nsetTimeout(deleteButtonFunction, 1000);\r\n\r\n\r\nfunction deleteButtonFunction () {\r\n\r\n    document.querySelectorAll(\".postUserName\").forEach((e)=>{\r\n\r\n      if(e.getAttribute(\"value\") == storedLoginName ){\r\n        e.innerHTML += `\r\n        <button class=\"deleteBtn\">X</button>\r\n        `\r\n      }\r\n\r\n  })\r\n\r\n\r\n\r\n  async function deleteFromDb (theIdToDelete) {\r\n\r\n    await deleteDoc(doc(db, \"post\", theIdToDelete));\r\n\r\n  }\r\n\r\n\r\n\r\n  document.querySelectorAll(\"button\").forEach((e)=>{\r\n\r\n    e.addEventListener(\"click\", (event) => {\r\n      event.preventDefault();\r\n      deleteFromDb(event.path[1].id);\r\n      \r\n    })\r\n  \r\n  })\r\n\r\n\r\n}\r\n","import { initializeApp } from \"firebase/app\";\r\nimport { getFirestore, collection, getDocs, query, orderBy, where } from \"firebase/firestore\";\r\nimport { firebaseConfig } from \"./firebaseconfig\";\r\n\r\n\r\n// Initialize Firebase\r\nconst app = initializeApp(firebaseConfig);\r\n\r\n\r\n// Initialize Cloud Firestore and get a reference to the service\r\nconst db = getFirestore(app);\r\n\r\nconst postsRef = collection(db, \"post\");\r\nconst q = query(postsRef, where(\"category\", \"==\", 3) ,orderBy(\"time\"));\r\n\r\n\r\nasync function renderPostListSpel() {\r\n\r\n    const querySnapshot = await getDocs(q);\r\n\r\n    querySnapshot.forEach((doc) => {\r\n    \r\n    document.querySelector(\".post-list\").innerHTML += `\r\n    <div class=\"the-post\">\r\n    <h2 class=\"postUserName\" id=${doc.id} value=\"${doc.data().user}\">${doc.data().user}</h2>\r\n       <p class=\"theText\">${doc.data().text}</p>\r\n      \r\n    </div>\r\n   `\r\n});\r\n\r\n\r\n}\r\n\r\n\r\nexport {renderPostListSpel};"],"names":["$2sKvt","parcelRequire","$707ge","$e045f600df19d305$var$app","initializeApp","$5tHFl","firebaseConfig","$e045f600df19d305$var$db","$hgQql","getFirestore","$e045f600df19d305$var$postsRef","collection","$e045f600df19d305$var$q","query","where","orderBy","$d8fe97f86d64551b$var$loginUserName","document","querySelector","$d8fe97f86d64551b$var$storedLoginName","localStorage","getItem","value","innerHTML","$d8fe97f86d64551b$var$app","$d8fe97f86d64551b$var$db","$d8fe97f86d64551b$var$userValue","$d8fe97f86d64551b$var$postText","$d8fe97f86d64551b$var$postBtn","async","getDocs","forEach","doc","id","data","user","$e045f600df19d305$export$c02894ec92633a7d","addEventListener","e","preventDefault","postObj","Post","Date","docRef","addDoc","username","text","category","time","console","log","error","$d8fe97f86d64551b$var$writeToDb","setTimeout","querySelectorAll","getAttribute","event","theIdToDelete","deleteDoc","deleteFromDb","path"],"version":3,"file":"postpage-spel.c6e6769e.js.map"}