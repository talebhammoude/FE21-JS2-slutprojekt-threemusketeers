!function(){function e(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},r={},o={},a=n.parcelRequire9600;null==a&&((a=function(e){if(e in r)return r[e].exports;if(e in o){var t=o[e];delete o[e];var n={id:e,exports:{}};return r[e]=n,t.call(n.exports,n,n.exports),n.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){o[e]=t},n.parcelRequire9600=a),a.register("6Urw1",(function(t,n){e(t.exports,"initializeApp",(function(){return a("MjY8E").initializeApp})),e(t.exports,"registerVersion",(function(){return a("MjY8E").registerVersion}));a("MjY8E");
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
a("MjY8E").registerVersion("firebase","9.8.1","app")})),a.register("MjY8E",(function(n,r){e(n.exports,"_registerComponent",(function(){return S})),e(n.exports,"_getProvider",(function(){return I})),e(n.exports,"_removeServiceInstance",(function(){return T})),e(n.exports,"SDK_VERSION",(function(){return R})),e(n.exports,"initializeApp",(function(){return D})),e(n.exports,"getApp",(function(){return A})),e(n.exports,"registerVersion",(function(){return L})),a("8TSCy");var i=a("f9pi5"),o=a("jK9zx"),s=a("aNiFM"),u=a("jcnGU"),l=a("5Vgx8"),c=a("2TvXO"),h=a("6ExWU"),f=a("kZfxc"),d=a("2xDiJ"),p=a("ajgRO"),v=(d=a("2xDiJ"),function(){"use strict";function e(t){i.default(this,e),this.container=t}return o.default(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((function(e){return e})).join(" ")}}]),e}());var y,_,g="@firebase/app",m="0.7.24",k=new f.Logger("@firebase/app"),C="[DEFAULT]",w=(y={},s.default(y,g,"fire-core"),s.default(y,"@firebase/app-compat","fire-core-compat"),s.default(y,"@firebase/analytics","fire-analytics"),s.default(y,"@firebase/analytics-compat","fire-analytics-compat"),s.default(y,"@firebase/app-check","fire-app-check"),s.default(y,"@firebase/app-check-compat","fire-app-check-compat"),s.default(y,"@firebase/auth","fire-auth"),s.default(y,"@firebase/auth-compat","fire-auth-compat"),s.default(y,"@firebase/database","fire-rtdb"),s.default(y,"@firebase/database-compat","fire-rtdb-compat"),s.default(y,"@firebase/functions","fire-fn"),s.default(y,"@firebase/functions-compat","fire-fn-compat"),s.default(y,"@firebase/installations","fire-iid"),s.default(y,"@firebase/installations-compat","fire-iid-compat"),s.default(y,"@firebase/messaging","fire-fcm"),s.default(y,"@firebase/messaging-compat","fire-fcm-compat"),s.default(y,"@firebase/performance","fire-perf"),s.default(y,"@firebase/performance-compat","fire-perf-compat"),s.default(y,"@firebase/remote-config","fire-rc"),s.default(y,"@firebase/remote-config-compat","fire-rc-compat"),s.default(y,"@firebase/storage","fire-gcs"),s.default(y,"@firebase/storage-compat","fire-gcs-compat"),s.default(y,"@firebase/firestore","fire-fst"),s.default(y,"@firebase/firestore-compat","fire-fst-compat"),s.default(y,"fire-js","fire-js"),s.default(y,"firebase","fire-js-all"),y),b=new Map,x=new Map;function E(e,t){try{e.container.addComponent(t)}catch(n){k.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function S(e){var t=e.name;if(x.has(t))return k.debug("There were multiple attempts to register component ".concat(t,".")),!1;x.set(t,e);var n=!0,r=!1,i=void 0;try{for(var o,a=b.values()[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){E(o.value,e)}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return!0}function I(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function T(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:C;I(e,t).clearInstance(n)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var N=(_={},s.default(_,"no-app","No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()"),s.default(_,"bad-app-name","Illegal App name: '{$appName}"),s.default(_,"duplicate-app","Firebase App named '{$appName}' already exists with different options or config"),s.default(_,"app-deleted","Firebase App named '{$appName}' already deleted"),s.default(_,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),s.default(_,"invalid-log-argument","First argument to `onLog` must be null or a function."),s.default(_,"storage-open","Error thrown when opening storage. Original error: {$originalErrorMessage}."),s.default(_,"storage-get","Error thrown when reading from storage. Original error: {$originalErrorMessage}."),s.default(_,"storage-set","Error thrown when writing to storage. Original error: {$originalErrorMessage}."),s.default(_,"storage-delete","Error thrown when deleting from storage. Original error: {$originalErrorMessage}."),_),P=new d.ErrorFactory("app","Firebase",N),O=function(){"use strict";function e(t,n,r){var o=this;i.default(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new h.Component("app",(function(){return o}),"PUBLIC"))}return o.default(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw P.create("app-deleted",{appName:this._name})}}]),e}(),R="9.8.1";function D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"!=typeof t){var n=t;t={name:n}}var r=Object.assign({name:C,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!=typeof i||!i)throw P.create("bad-app-name",{appName:String(i)});var o=b.get(i);if(o){if(d.deepEqual(e,o.options)&&d.deepEqual(r,o.config))return o;throw P.create("duplicate-app",{appName:i})}var a=new h.ComponentContainer(i),s=!0,u=!1,l=void 0;try{for(var c,f=x.values()[Symbol.iterator]();!(s=(c=f.next()).done);s=!0){var p=c.value;a.addComponent(p)}}catch(e){u=!0,l=e}finally{try{s||null==f.return||f.return()}finally{if(u)throw l}}var v=new O(e,r,a);return b.set(i,v),v}function A(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=b.get(e);if(!t)throw P.create("no-app",{appName:e});return t}function L(e,t,n){var r,i=null!==(r=w[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));var o=i.match(/\s|\//),a=t.match(/\s|\//);if(o||a){var s=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return o&&s.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),o&&a&&s.push("and"),a&&s.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void k.warn(s.join(" "))}S(new h.Component("".concat(i,"-version"),(function(){return{library:i,version:t}}),"VERSION"))}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var M="firebase-heartbeat-store",F=null;function j(){return F||(F=p.openDB("firebase-heartbeat-database",1,{upgrade:function(e,t){if(0===t)e.createObjectStore(M)}}).catch((function(e){throw P.create("storage-open",{originalErrorMessage:e.message})}))),F}function q(e){return W.apply(this,arguments)}function W(){return(W=u.default(t(c).mark((function e(n){var r;return t(c).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j();case 3:return r=e.sent,e.abrupt("return",r.transaction(M).objectStore(M).get(H(n)));case 7:throw e.prev=7,e.t0=e.catch(0),P.create("storage-get",{originalErrorMessage:e.t0.message});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function U(e,t){return z.apply(this,arguments)}function z(){return(z=u.default(t(c).mark((function e(n,r){var i,o,a;return t(c).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j();case 3:return i=e.sent,o=i.transaction(M,"readwrite"),a=o.objectStore(M),e.next=8,a.put(r,H(n));case 8:return e.abrupt("return",o.done);case 11:throw e.prev=11,e.t0=e.catch(0),P.create("storage-set",{originalErrorMessage:e.t0.message});case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}function H(e){return"".concat(e.name,"!").concat(e.options.appId)}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var B=function(){"use strict";function e(t){var n=this;i.default(this,e),this.container=t,this._heartbeatsCache=null;var r=this.container.getProvider("app").getImmediate();this._storage=new K(r),this._heartbeatsCachePromise=this._storage.read().then((function(e){return n._heartbeatsCache=e,e}))}return o.default(e,[{key:"triggerHeartbeat",value:function(){var e=this;return u.default(t(c).mark((function n(){var r,i,o;return t(c).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.container.getProvider("platform-logger").getImmediate(),i=r.getPlatformInfoString(),o=V(),null!==e._heartbeatsCache){t.next=7;break}return t.next=6,e._heartbeatsCachePromise;case 6:e._heartbeatsCache=t.sent;case 7:if(e._heartbeatsCache.lastSentHeartbeatDate!==o&&!e._heartbeatsCache.heartbeats.some((function(e){return e.date===o}))){t.next=11;break}return t.abrupt("return");case 11:e._heartbeatsCache.heartbeats.push({date:o,agent:i});case 12:return e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter((function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),t.abrupt("return",e._storage.overwrite(e._heartbeatsCache));case 14:case"end":return t.stop()}}),n)})))()}},{key:"getHeartbeatsHeader",value:function(){var e=this;return u.default(t(c).mark((function n(){var r,i,o,a,s;return t(c).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==e._heartbeatsCache){t.next=3;break}return t.next=3,e._heartbeatsCachePromise;case 3:if(null!==e._heartbeatsCache&&0!==e._heartbeatsCache.heartbeats.length){t.next=5;break}return t.abrupt("return","");case 5:if(r=V(),i=G(e._heartbeatsCache.heartbeats),o=i.heartbeatsToSend,a=i.unsentEntries,s=d.base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:o})),e._heartbeatsCache.lastSentHeartbeatDate=r,!(a.length>0)){t.next=15;break}return e._heartbeatsCache.heartbeats=a,t.next=13,e._storage.overwrite(e._heartbeatsCache);case 13:t.next=16;break;case 15:e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache);case 16:return t.abrupt("return",s);case 17:case"end":return t.stop()}}),n)})))()}}]),e}();function V(){return(new Date).toISOString().substring(0,10)}function G(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,n=[],r=e.slice(),i=!0,o=!1,a=void 0;try{for(var s,u=function(e,i){var o=i.value,a=n.find((function(e){return e.agent===o.agent}));if(a){if(a.dates.push(o.date),Q(n)>t)return a.dates.pop(),"break"}else if(n.push({agent:o.agent,dates:[o.date]}),Q(n)>t)return n.pop(),"break";r=r.slice(1)},l=e[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var c=u(l,s);if("break"===c)break}}catch(e){o=!0,a=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw a}}return{heartbeatsToSend:n,unsentEntries:r}}var Y,K=function(){"use strict";function e(t){i.default(this,e),this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return o.default(e,[{key:"runIndexedDBEnvironmentCheck",value:function(){return u.default(t(c).mark((function e(){return t(c).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d.isIndexedDBAvailable()){e.next=4;break}return e.abrupt("return",!1);case 4:return e.abrupt("return",d.validateIndexedDBOpenable().then((function(){return!0})).catch((function(){return!1})));case 5:case"end":return e.stop()}}),e)})))()}},{key:"read",value:function(){var e=this;return u.default(t(c).mark((function n(){var r;return t(c).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._canUseIndexedDBPromise;case 2:if(t.sent){t.next=7;break}return t.abrupt("return",{heartbeats:[]});case 7:return t.next=9,q(e.app);case 9:return r=t.sent,t.abrupt("return",r||{heartbeats:[]});case 11:case"end":return t.stop()}}),n)})))()}},{key:"overwrite",value:function(e){var n=this;return u.default(t(c).mark((function r(){var i,o;return t(c).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,n._canUseIndexedDBPromise;case 3:if(t.sent){t.next=8;break}return t.abrupt("return");case 8:return t.next=10,n.read();case 10:return o=t.sent,t.abrupt("return",U(n.app,{lastSentHeartbeatDate:null!==(i=e.lastSentHeartbeatDate)&&void 0!==i?i:o.lastSentHeartbeatDate,heartbeats:e.heartbeats}));case 12:case"end":return t.stop()}}),r)})))()}},{key:"add",value:function(e){var n=this;return u.default(t(c).mark((function r(){var i,o;return t(c).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,n._canUseIndexedDBPromise;case 3:if(t.sent){t.next=8;break}return t.abrupt("return");case 8:return t.next=10,n.read();case 10:return o=t.sent,t.abrupt("return",U(n.app,{lastSentHeartbeatDate:null!==(i=e.lastSentHeartbeatDate)&&void 0!==i?i:o.lastSentHeartbeatDate,heartbeats:l.default(o.heartbeats).concat(l.default(e.heartbeats))}));case 12:case"end":return t.stop()}}),r)})))()}}]),e}();function Q(e){return d.base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:e})).length}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Y="",S(new h.Component("platform-logger",(function(e){return new v(e)}),"PRIVATE")),S(new h.Component("heartbeat",(function(e){return new B(e)}),"PRIVATE")),L(g,m,Y),L(g,m,"esm2017"),L("fire-js","")})),a.register("8TSCy",(function(t,n){e(t.exports,"applyDecoratedDescriptor",(function(){return a("aCQQc").default})),e(t.exports,"arrayLikeToArray",(function(){return a("em3qv").default})),e(t.exports,"arrayWithHoles",(function(){return a("9rxh7").default})),e(t.exports,"arrayWithoutHoles",(function(){return a("gyMUJ").default})),e(t.exports,"assertThisInitialized",(function(){return a("Kn7R4").default})),e(t.exports,"asyncGenerator",(function(){return a("7bgyj").default})),e(t.exports,"asyncGeneratorDelegate",(function(){return a("aGtc8").default})),e(t.exports,"asyncIterator",(function(){return a("3UDCc").default})),e(t.exports,"asyncToGenerator",(function(){return a("jcnGU").default})),e(t.exports,"awaitAsyncGenerator",(function(){return a("exO5y").default})),e(t.exports,"awaitValue",(function(){return a("kEnmc").default})),e(t.exports,"checkPrivateRedeclaration",(function(){return a("22ex8").default})),e(t.exports,"classApplyDescriptorDestructureSet",(function(){return a("aSmmc").default})),e(t.exports,"classApplyDescriptorGet",(function(){return a("dmIej").default})),e(t.exports,"classApplyDescriptorSet",(function(){return a("8oyJ9").default})),e(t.exports,"classCallCheck",(function(){return a("f9pi5").default})),e(t.exports,"classCheckPrivateStaticFieldDescriptor",(function(){return a("7gmBE").default})),e(t.exports,"classCheckPrivateStaticAccess",(function(){return a("71xSN").default})),e(t.exports,"classNameTDZError",(function(){return a("aJtHo").default})),e(t.exports,"classPrivateFieldDestructureSet",(function(){return a("5ickg").default})),e(t.exports,"classPrivateFieldGet",(function(){return a("bxCCm").default})),e(t.exports,"classPrivateFieldInit",(function(){return a("4koOI").default})),e(t.exports,"classPrivateFieldLooseBase",(function(){return a("dwIHw").default})),e(t.exports,"classPrivateFieldLooseKey",(function(){return a("4VPEe").default})),e(t.exports,"classPrivateFieldSet",(function(){return a("j2pCk").default})),e(t.exports,"classPrivateMethodGet",(function(){return a("5Zqbj").default})),e(t.exports,"classPrivateMethodInit",(function(){return a("P11OH").default})),e(t.exports,"classPrivateMethodSet",(function(){return a("9TnBr").default})),e(t.exports,"classStaticPrivateFieldDestructureSet",(function(){return a("acD2X").default})),e(t.exports,"classStaticPrivateFieldSpecGet",(function(){return a("6Dpcl").default})),e(t.exports,"classStaticPrivateFieldSpecSet",(function(){return a("lCXdU").default})),e(t.exports,"construct",(function(){return a("lyMdT").default})),e(t.exports,"createClass",(function(){return a("jK9zx").default})),e(t.exports,"createSuper",(function(){return a("dap1g").default})),e(t.exports,"decorate",(function(){return a("8Dq9y").default})),e(t.exports,"defaults",(function(){return a("aNSHi").default})),e(t.exports,"defineEnumerableProperties",(function(){return a("4LceU").default})),e(t.exports,"defineProperty",(function(){return a("aNiFM").default})),e(t.exports,"extends",(function(){return a("6uxOR").default})),e(t.exports,"get",(function(){return a("8atho").default})),e(t.exports,"getPrototypeOf",(function(){return a("aNpz9").default})),e(t.exports,"inherits",(function(){return a("g9uIT").default})),e(t.exports,"inheritsLoose",(function(){return a("5qhF4").default})),e(t.exports,"initializerDefineProperty",(function(){return a("9Bb5n").default})),e(t.exports,"initializerWarningHelper",(function(){return a("jcZ4A").default})),e(t.exports,"_instanceof",(function(){return a("1cUGQ").default})),e(t.exports,"interopRequireDefault",(function(){return a("hLAQ5").default})),e(t.exports,"interopRequireWildcard",(function(){return a("2QNAC").default})),e(t.exports,"isNativeFunction",(function(){return a("bDs5c").default})),e(t.exports,"isNativeReflectConstruct",(function(){return a("innt6").default})),e(t.exports,"iterableToArray",(function(){return a("bxmrK").default})),e(t.exports,"iterableToArrayLimit",(function(){return a("hq1tX").default})),e(t.exports,"iterableToArrayLimitLoose",(function(){return a("5GR21").default})),e(t.exports,"jsx",(function(){return a("5EOdA").default})),e(t.exports,"newArrowCheck",(function(){return a("196CG").default})),e(t.exports,"nonIterableRest",(function(){return a("dzEQH").default})),e(t.exports,"nonIterableSpread",(function(){return a("de5AG").default})),e(t.exports,"objectSpread",(function(){return a("ifq4M").default})),e(t.exports,"objectWithoutProperties",(function(){return a("jC6pI").default})),e(t.exports,"objectWithoutPropertiesLoose",(function(){return a("adDGW").default})),e(t.exports,"possibleConstructorReturn",(function(){return a("bFSSc").default})),e(t.exports,"readOnlyError",(function(){return a("2y7Mw").default})),e(t.exports,"set",(function(){return a("lxMUl").default})),e(t.exports,"setPrototypeOf",(function(){return a("eOD0a").default})),e(t.exports,"skipFirstGeneratorNext",(function(){return a("iYoCV").default})),e(t.exports,"slicedToArray",(function(){return a("iCnzh").default})),e(t.exports,"slicedToArrayLoose",(function(){return a("2P52m").default})),e(t.exports,"superPropBase",(function(){return a("5uuLS").default})),e(t.exports,"taggedTemplateLiteral",(function(){return a("hBmGv").default})),e(t.exports,"taggedTemplateLiteralLoose",(function(){return a("fwOMH").default})),e(t.exports,"_throw",(function(){return a("jHQfp").default})),e(t.exports,"toArray",(function(){return a("133Pq").default})),e(t.exports,"toConsumableArray",(function(){return a("5Vgx8").default})),e(t.exports,"toPrimitive",(function(){return a("hjCEX").default})),e(t.exports,"toPropertyKey",(function(){return a("dWEZ0").default})),e(t.exports,"typeOf",(function(){return a("kswSi").default})),e(t.exports,"unsupportedIterableToArray",(function(){return a("R3yfh").default})),e(t.exports,"wrapAsyncGenerator",(function(){return a("8aoaQ").default})),e(t.exports,"wrapNativeSuper",(function(){return a("39bC9").default})),e(t.exports,"__decorate",(function(){return a("4tSb9").__decorate})),e(t.exports,"__metadata",(function(){return a("4tSb9").__metadata})),e(t.exports,"__param",(function(){return a("4tSb9").__param}));a("aCQQc"),a("em3qv"),a("9rxh7"),a("gyMUJ"),a("Kn7R4"),a("7bgyj"),a("aGtc8"),a("3UDCc"),a("jcnGU"),a("exO5y"),a("kEnmc"),a("22ex8"),a("aSmmc"),a("dmIej"),a("8oyJ9"),a("f9pi5"),a("7gmBE"),a("71xSN"),a("aJtHo"),a("5ickg"),a("bxCCm"),a("4koOI"),a("dwIHw"),a("4VPEe"),a("j2pCk"),a("5Zqbj"),a("P11OH"),a("9TnBr"),a("acD2X"),a("6Dpcl"),a("lCXdU"),a("lyMdT"),a("jK9zx"),a("dap1g"),a("8Dq9y"),a("aNSHi"),a("4LceU"),a("aNiFM"),a("6uxOR"),a("8atho"),a("aNpz9"),a("g9uIT"),a("5qhF4"),a("9Bb5n"),a("jcZ4A"),a("1cUGQ"),a("hLAQ5"),a("2QNAC"),a("bDs5c"),a("innt6"),a("bxmrK"),a("hq1tX"),a("5GR21"),a("5EOdA"),a("196CG"),a("dzEQH"),a("de5AG"),a("ifq4M"),a("jC6pI"),a("adDGW"),a("bFSSc"),a("2y7Mw"),a("lxMUl"),a("eOD0a"),a("iYoCV"),a("iCnzh"),a("2P52m"),a("5uuLS"),a("hBmGv"),a("fwOMH"),a("jHQfp"),a("133Pq"),a("5Vgx8"),a("hjCEX"),a("dWEZ0"),a("kswSi"),a("R3yfh"),a("8aoaQ"),a("39bC9"),a("4tSb9")})),a.register("aCQQc",(function(t,n){function r(e,t,n,r,i){var o={};Object.keys(r).forEach((function(e){o[e]=r[e]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r&&r(e,t,n)||n}),o);var a=Object.prototype.hasOwnProperty.call(o,"get")||Object.prototype.hasOwnProperty.call(o,"set");return i&&void 0!==o.initializer&&!a&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),a&&(delete o.writable,delete o.initializer,delete o.value),void 0===o.initializer&&(Object.defineProperty(e,t,o),o=null),o}e(t.exports,"default",(function(){return r}))})),a.register("em3qv",(function(t,n){function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e(t.exports,"default",(function(){return r}))})),a.register("9rxh7",(function(t,n){function r(e){if(Array.isArray(e))return e}e(t.exports,"default",(function(){return r}))})),a.register("gyMUJ",(function(t,n){e(t.exports,"default",(function(){return i}));var r=a("em3qv");function i(e){if(Array.isArray(e))return r.default(e)}})),a.register("Kn7R4",(function(t,n){function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}e(t.exports,"default",(function(){return r}))})),a.register("7bgyj",(function(t,n){e(t.exports,"default",(function(){return i}));var r=a("kEnmc");function i(e){var t,n;function i(t,n){try{var a=e[t](n),s=a.value,u=s instanceof r.default;Promise.resolve(u?s.wrapped:s).then((function(e){u?i("next",e):o(a.done?"return":"normal",e)}),(function(e){i("throw",e)}))}catch(e){o("throw",e)}}function o(e,r){switch(e){case"return":t.resolve({value:r,done:!0});break;case"throw":t.reject(r);break;default:t.resolve({value:r,done:!1})}(t=t.next)?i(t.key,t.arg):n=null}this._invoke=function(e,r){return new Promise((function(o,a){var s={key:e,arg:r,resolve:o,reject:a,next:null};n?n=n.next=s:(t=n=s,i(e,r))}))},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(i.prototype[Symbol.asyncIterator]=function(){return this}),i.prototype.next=function(e){return this._invoke("next",e)},i.prototype.throw=function(e){return this._invoke("throw",e)},i.prototype.return=function(e){return this._invoke("return",e)}})),a.register("kEnmc",(function(t,n){function r(e){this.wrapped=e}e(t.exports,"default",(function(){return r}))})),a.register("aGtc8",(function(t,n){function r(e,t){var n={},r=!1;function i(n,i){return r=!0,i=new Promise((function(t){t(e[n](i))})),{done:!1,value:t(i)}}return"function"==typeof Symbol&&Symbol.iterator&&(n[Symbol.iterator]=function(){return this}),n.next=function(e){return r?(r=!1,e):i("next",e)},"function"==typeof e.throw&&(n.throw=function(e){if(r)throw r=!1,e;return i("throw",e)}),"function"==typeof e.return&&(n.return=function(e){return i("return",e)}),n}e(t.exports,"default",(function(){return r}))})),a.register("3UDCc",(function(t,n){function r(e){var t;if("function"==typeof Symbol){if(Symbol.asyncIterator&&null!=(t=e[Symbol.asyncIterator]))return t.call(e);if(Symbol.iterator&&null!=(t=e[Symbol.iterator]))return t.call(e)}throw new TypeError("Object is not async iterable")}e(t.exports,"default",(function(){return r}))})),a.register("jcnGU",(function(t,n){function r(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var a=e.apply(t,n);function s(e){r(a,i,o,s,u,"next",e)}function u(e){r(a,i,o,s,u,"throw",e)}s(void 0)}))}}e(t.exports,"default",(function(){return i}))})),a.register("exO5y",(function(t,n){e(t.exports,"default",(function(){return i}));var r=a("kEnmc");function i(e){return new r.default(e)}})),a.register("22ex8",(function(t,n){function r(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}e(t.exports,"default",(function(){return r}))})),a.register("aSmmc",(function(t,n){function r(e,t){if(t.set)return"__destrObj"in t||(t.__destrObj={set value(n){t.set.call(e,n)}}),t.__destrObj;if(!t.writable)throw new TypeError("attempted to set read only private field");return t}e(t.exports,"default",(function(){return r}))})),a.register("dmIej",(function(t,n){function r(e,t){return t.get?t.get.call(e):t.value}e(t.exports,"default",(function(){return r}))})),a.register("8oyJ9",(function(t,n){function r(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}e(t.exports,"default",(function(){return r}))})),a.register("f9pi5",(function(t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}e(t.exports,"default",(function(){return r}))})),a.register("7gmBE",(function(t,n){function r(e,t){if(void 0===e)throw new TypeError("attempted to "+t+" private static field before its declaration")}e(t.exports,"default",(function(){return r}))})),a.register("71xSN",(function(t,n){function r(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}e(t.exports,"default",(function(){return r}))})),a.register("aJtHo",(function(t,n){function r(e){throw new Error('Class "'+e+'" cannot be referenced in computed property keys.')}e(t.exports,"default",(function(){return r}))})),a.register("5ickg",(function(t,n){e(t.exports,"default",(function(){return o}));var r=a("iXYNA"),i=a("aSmmc");function o(e,t){var n=r.default(e,t,"set");return i.default(e,n)}})),a.register("iXYNA",(function(t,n){function r(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}e(t.exports,"default",(function(){return r}))})),a.register("bxCCm",(function(t,n){e(t.exports,"default",(function(){return o}));var r=a("iXYNA"),i=a("dmIej");function o(e,t){var n=r.default(e,t,"get");return i.default(e,n)}})),a.register("4koOI",(function(t,n){e(t.exports,"default",(function(){return i}));var r=a("22ex8");function i(e,t,n){r.default(e,t),t.set(e,n)}})),a.register("dwIHw",(function(t,n){function r(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}e(t.exports,"default",(function(){return r}))})),a.register("4VPEe",(function(t,n){e(t.exports,"default",(function(){return i}));var r=0;function i(e){return"__private_"+r+++"_"+e}})),a.register("j2pCk",(function(t,n){e(t.exports,"default",(function(){return o}));var r=a("iXYNA"),i=a("8oyJ9");function o(e,t,n){var o=r.default(e,t,"set");return i.default(e,o,n),n}})),a.register("5Zqbj",(function(t,n){function r(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}e(t.exports,"default",(function(){return r}))})),a.register("P11OH",(function(t,n){e(t.exports,"default",(function(){return i}));var r=a("22ex8");function i(e,t){r.default(e,t),t.add(e)}})),a.register("9TnBr",(function(t,n){function r(){throw new TypeError("attempted to reassign private method")}e(t.exports,"default",(function(){return r}))})),a.register("acD2X",(function(t,n){e(t.exports,"default",(function(){return o}));var r=a("71xSN"),i=(r=a("71xSN"),a("aSmmc"));function o(e,t,n){return r.default(e,t),r.default(n,"set"),i.default(e,n)}})),a.register("6Dpcl",(function(t,n){e(t.exports,"default",(function(){return o}));var r=a("71xSN"),i=(r=a("71xSN"),a("dmIej"));function o(e,t,n){return r.default(e,t),r.default(n,"get"),i.default(e,n)}})),a.register("lCXdU",(function(t,n){e(t.exports,"default",(function(){return o}));var r=a("71xSN"),i=(r=a("71xSN"),a("8oyJ9"));function o(e,t,n,o){return r.default(e,t),r.default(n,"set"),i.default(e,n,o),o}})),a.register("lyMdT",(function(t,n){e(t.exports,"default",(function(){return s}));var r=a("eOD0a");function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function o(e,t,n){return(o=i()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return n&&r.default(o,n.prototype),o}).apply(null,arguments)}function s(e,t,n){return o.apply(null,arguments)}})),a.register("eOD0a",(function(t,n){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e,t){return r(e,t)}e(t.exports,"default",(function(){return i}))})),a.register("jK9zx",(function(t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}e(t.exports,"default",(function(){return i}))})),a.register("dap1g",(function(t,n){e(t.exports,"default",(function(){return s}));var r=a("innt6"),i=a("aNpz9"),o=a("bFSSc");function s(e){var t=r.default();return function(){var n,r=i.default(e);if(t){var a=i.default(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return o.default(this,n)}}})),a.register("innt6",(function(t,n){function r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}e(t.exports,"default",(function(){return r}))})),a.register("aNpz9",(function(t,n){function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function i(e){return r(e)}e(t.exports,"default",(function(){return i}))})),a.register("bFSSc",(function(t,n){e(t.exports,"default",(function(){return o}));var r=a("Kn7R4"),i=a("kswSi");function o(e,t){return!t||"object"!==i.default(t)&&"function"!=typeof t?r.default(e):t}})),a.register("kswSi",(function(t,n){function r(e){return e&&e.constructor===Symbol?"symbol":typeof e}e(t.exports,"default",(function(){return r}))})),a.register("8Dq9y",(function(t,n){e(t.exports,"default",(function(){return o}));var r=a("133Pq"),i=a("dWEZ0");function o(e,t,n){var r,i,o,a=t((function(e){!function(e,t){["method","field"].forEach((function(n){t.forEach((function(t){t.kind===n&&"own"===t.placement&&h(e,t)}))}))}(e,p.elements)}),n),p=function(e,t){var n=[],r=[],i={static:[],prototype:[],own:[]};if(e.forEach((function(e){f(e,i)})),e.forEach((function(e){if(!l(e))return n.push(e);var t=function(e,t){for(var n=[],r=[],i=e.decorators,o=i.length-1;o>=0;o--){var a=t[e.placement];a.splice(a.indexOf(e.key),1);var s=d(e),u=y((0,i[o])(s)||s);f(e=u.element,t),u.finisher&&r.push(u.finisher);var l=u.extras;if(l){for(var c=0;c<l.length;c++)f(l[c],t);n.push.apply(n,l)}}return{element:e,finishers:r,extras:n}}(e,i);n.push(t.element),n.push.apply(n,t.extras),r.push.apply(r,t.finishers)})),!t)return{elements:n,finishers:r};var o=function(e,t){for(var n=[],r=t.length-1;r>=0;r--){var i=_(e),o=g((0,t[r])(i)||i);if(void 0!==o.finisher&&n.push(o.finisher),void 0!==o.elements){e=o.elements;for(var a=0;a<e.length-1;a++)for(var s=a+1;s<e.length;s++)if(e[a].key===e[s].key&&e[a].placement===e[s].placement)throw new TypeError("Duplicated element ("+e[a].key+")")}}return{elements:e,finishers:n}}(n,t);return r.push.apply(r,o.finishers),o.finishers=r,o}(function(e){for(var t=[],n=function(e){return"method"===e.kind&&e.key===o.key&&e.placement===o.placement},r=0;r<e.length;r++){var i,o=e[r];if("method"===o.kind&&(i=t.find(n)))if(c(o.descriptor)||c(i.descriptor)){if(l(o)||l(i))throw new ReferenceError("Duplicated methods ("+o.key+") can't be decorated.");i.descriptor=o.descriptor}else{if(l(o)){if(l(i))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+o.key+").");i.decorators=o.decorators}u(o,i)}else t.push(o)}return t}(a.d.map(s)),e);return r=a.F,i=p.elements,o=r.prototype,["method","field"].forEach((function(e){i.forEach((function(t){var n=t.placement;t.kind!==e||"static"!==n&&"prototype"!==n||h("static"===n?r:o,t)}))})),function(e,t){for(var n=0;n<t.length;n++){var r=(0,t[n])(e);if(void 0!==r){if("function"!=typeof r)throw new TypeError("Finishers must return a constructor.");e=r}}return e}(a.F,p.finishers)}function s(e){var t,n=i.default(e.key);"method"===e.kind?(t={value:e.value,writable:!0,configurable:!0,enumerable:!1},Object.defineProperty(e.value,"name",{value:"symbol"===_typeof(n)?"":n,configurable:!0})):"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var r={kind:"field"===e.kind?"field":"method",key:n,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(r.decorators=e.decorators),"field"===e.kind&&(r.initializer=e.value),r}function u(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function l(e){return e.decorators&&e.decorators.length}function c(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function h(e,t){var n=t.descriptor;if("field"===t.kind){var r=t.initializer;n={enumerable:n.enumerable,writable:n.writable,configurable:n.configurable,value:void 0===r?void 0:r.call(e)}}Object.defineProperty(e,t.key,n)}function f(e,t,n){var r=t[e.placement];if(!n&&-1!==r.indexOf(e.key))throw new TypeError("Duplicated element ("+e.key+")");r.push(e.key)}function d(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return Object.defineProperty(t,Symbol.toStringTag,{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t}function p(e){if(void 0!==e)return r.default(e).map((function(e){var t=v(e);return m(e,"finisher","An element descriptor"),m(e,"extras","An element descriptor"),t}))}function v(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var n=i.default(e.key),r=String(e.placement);if("static"!==r&&"prototype"!==r&&"own"!==r)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+r+'"');var o=e.descriptor;m(e,"elements","An element descriptor");var a={kind:t,key:n,placement:r,descriptor:Object.assign({},o)};return"field"!==t?m(e,"initializer","A method descriptor"):(m(o,"get","The property descriptor of a field descriptor"),m(o,"set","The property descriptor of a field descriptor"),m(o,"value","The property descriptor of a field descriptor"),a.initializer=e.initializer),a}function y(e){return{element:v(e),finisher:k(e,"finisher"),extras:p(e.extras)}}function _(e){var t={kind:"class",elements:e.map(d)};return Object.defineProperty(t,Symbol.toStringTag,{value:"Descriptor",configurable:!0}),t}function g(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');m(e,"key","A class descriptor"),m(e,"placement","A class descriptor"),m(e,"descriptor","A class descriptor"),m(e,"initializer","A class descriptor"),m(e,"extras","A class descriptor");var n=k(e,"finisher");return{elements:p(e.elements),finisher:n}}function m(e,t,n){if(void 0!==e[t])throw new TypeError(n+" can't have a ."+t+" property.")}function k(e,t){var n=e[t];if(void 0!==n&&"function"!=typeof n)throw new TypeError("Expected '"+t+"' to be a function");return n}})),a.register("133Pq",(function(t,n){e(t.exports,"default",(function(){return l}));var r=a("9rxh7"),o=a("bxmrK"),s=a("dzEQH"),u=a("R3yfh");function l(e){return r.default(e)||o.default(e)||u.default(e,i)||s.default()}})),a.register("bxmrK",(function(t,n){function r(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}e(t.exports,"default",(function(){return r}))})),a.register("dzEQH",(function(t,n){function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}e(t.exports,"default",(function(){return r}))})),a.register("R3yfh",(function(t,n){e(t.exports,"default",(function(){return i}));var r=a("em3qv");function i(e,t){if(e){if("string"==typeof e)return r.default(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r.default(e,t):void 0}}})),a.register("dWEZ0",(function(t,n){e(t.exports,"default",(function(){return o}));var r=a("kswSi"),i=a("hjCEX");function o(e){var t=i.default(e,"string");return"symbol"===r.default(t)?t:String(t)}})),a.register("hjCEX",(function(t,n){e(t.exports,"default",(function(){return i}));var r=a("kswSi");function i(e,t){if("object"!==r.default(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==r.default(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}})),a.register("aNSHi",(function(t,n){function r(e,t){for(var n=Object.getOwnPropertyNames(t),r=0;r<n.length;r++){var i=n[r],o=Object.getOwnPropertyDescriptor(t,i);o&&o.configurable&&void 0===e[i]&&Object.defineProperty(e,i,o)}return e}e(t.exports,"default",(function(){return r}))})),a.register("4LceU",(function(t,n){function r(e,t){for(var n in t){(o=t[n]).configurable=o.enumerable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,n,o)}if(Object.getOwnPropertySymbols)for(var r=Object.getOwnPropertySymbols(t),i=0;i<r.length;i++){var o,a=r[i];(o=t[a]).configurable=o.enumerable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,a,o)}return e}e(t.exports,"default",(function(){return r}))})),a.register("aNiFM",(function(t,n){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}e(t.exports,"default",(function(){return r}))})),a.register("6uxOR",(function(t,n){function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function i(){return r.apply(this,arguments)}e(t.exports,"default",(function(){return i}))})),a.register("8atho",(function(t,n){e(t.exports,"default",(function(){return o}));var r=a("5uuLS");function i(e,t,n){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=r.default(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n||e):o.value}})(e,t,n)}function o(e,t,n){return i(e,t,n)}})),a.register("5uuLS",(function(t,n){e(t.exports,"default",(function(){return i}));var r=a("aNpz9");function i(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r.default(e)););return e}})),a.register("g9uIT",(function(t,n){e(t.exports,"default",(function(){return i}));var r=a("eOD0a");function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r.default(e,t)}})),a.register("5qhF4",(function(t,n){function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}e(t.exports,"default",(function(){return r}))})),a.register("9Bb5n",(function(t,n){function r(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}e(t.exports,"default",(function(){return r}))})),a.register("jcZ4A",(function(t,n){function r(e,t){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and set to use loose mode. To use proposal-class-properties in spec mode with decorators, wait for the next major version of decorators in stage 2.")}e(t.exports,"default",(function(){return r}))})),a.register("1cUGQ",(function(t,n){function r(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}e(t.exports,"default",(function(){return r}))})),a.register("hLAQ5",(function(t,n){function r(e){return e&&e.__esModule?e:{default:e}}e(t.exports,"default",(function(){return r}))})),a.register("2QNAC",(function(t,n){function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}function i(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}e(t.exports,"default",(function(){return i}))})),a.register("bDs5c",(function(t,n){function r(e){return-1!==Function.toString.call(e).indexOf("[native code]")}e(t.exports,"default",(function(){return r}))})),a.register("hq1tX",(function(t,n){function r(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}e(t.exports,"default",(function(){return r}))})),a.register("5GR21",(function(t,n){function r(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var r=[];for(n=n.call(e);!(_step=n.next()).done&&(r.push(_step.value),!t||r.length!==t););return r}}e(t.exports,"default",(function(){return r}))})),a.register("5EOdA",(function(t,n){var r;function i(e,t,n,i){r||(r="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,a=arguments.length-3;if(t||0===a||(t={children:void 0}),t&&o)for(var s in o)void 0===t[s]&&(t[s]=o[s]);else t||(t=o||{});if(1===a)t.children=i;else if(a>1){for(var u=new Array(a),l=0;l<a;l++)u[l]=arguments[l+3];t.children=u}return{$$typeof:r,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}e(t.exports,"default",(function(){return i}))})),a.register("196CG",(function(t,n){function r(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}e(t.exports,"default",(function(){return r}))})),a.register("de5AG",(function(t,n){function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}e(t.exports,"default",(function(){return r}))})),a.register("ifq4M",(function(t,n){e(t.exports,"default",(function(){return i}));var r=a("aNiFM");function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){r.default(e,t,n[t])}))}return e}})),a.register("jC6pI",(function(t,n){e(t.exports,"default",(function(){return i}));var r=a("adDGW");function i(e,t){if(null==e)return{};var n,i,o=r.default(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}})),a.register("adDGW",(function(t,n){function r(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}e(t.exports,"default",(function(){return r}))})),a.register("2y7Mw",(function(t,n){function r(e){throw new Error('"'+e+'" is read-only')}e(t.exports,"default",(function(){return r}))})),a.register("lxMUl",(function(t,n){e(t.exports,"default",(function(){return s}));var r=a("aNiFM"),i=a("5uuLS");function o(e,t,n,a){return(o="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,n,o){var a,s=i.default(e,t);if(s){if((a=Object.getOwnPropertyDescriptor(s,t)).set)return a.set.call(o,n),!0;if(!a.writable)return!1}if(a=Object.getOwnPropertyDescriptor(o,t)){if(!a.writable)return!1;a.value=n,Object.defineProperty(o,t,a)}else r.default(o,t,n);return!0})(e,t,n,a)}function s(e,t,n,r,i){if(!o(e,t,n,r||e)&&i)throw new Error("failed to set property");return n}})),a.register("iYoCV",(function(t,n){function r(e){return function(){var t=e.apply(this,arguments);return t.next(),t}}e(t.exports,"default",(function(){return r}))})),a.register("iCnzh",(function(t,n){e(t.exports,"default",(function(){return u}));var r=a("9rxh7"),i=a("bxmrK"),o=a("dzEQH"),s=a("R3yfh");function u(e,t){return r.default(e)||i.default(e,t)||s.default(e,t)||o.default()}})),a.register("2P52m",(function(t,n){e(t.exports,"default",(function(){return u}));var r=a("9rxh7"),i=a("5GR21"),o=a("dzEQH"),s=a("R3yfh");function u(e,t){return r.default(e)||i.default(e,t)||s.default(e,t)||o.default()}})),a.register("hBmGv",(function(t,n){function r(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}e(t.exports,"default",(function(){return r}))})),a.register("fwOMH",(function(t,n){function r(e,t){return t||(t=e.slice(0)),e.raw=t,e}e(t.exports,"default",(function(){return r}))})),a.register("jHQfp",(function(t,n){function r(e){throw e}e(t.exports,"default",(function(){return r}))})),a.register("5Vgx8",(function(t,n){e(t.exports,"default",(function(){return u}));var r=a("gyMUJ"),i=a("bxmrK"),o=a("de5AG"),s=a("R3yfh");function u(e){return r.default(e)||i.default(e)||s.default(e)||o.default()}})),a.register("8aoaQ",(function(t,n){e(t.exports,"default",(function(){return i}));var r=a("7bgyj");function i(e){return function(){return new r.default(e.apply(this,arguments))}}})),a.register("39bC9",(function(t,n){e(t.exports,"default",(function(){return l}));var r=a("lyMdT"),i=a("bDs5c"),o=a("aNpz9"),s=a("eOD0a");function u(e){var t="function"==typeof Map?new Map:void 0;return u=function(e){if(null===e||!i.default(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return r.default(e,arguments,o.default(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),s.default(n,e)},u(e)}function l(e){return u(e)}})),a.register("4tSb9",(function(t,n){e(t.exports,"__decorate",(function(){return r})),e(t.exports,"__param",(function(){return i})),e(t.exports,"__metadata",(function(){return o}));function r(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function i(e,t){return function(n,r){t(n,r,e)}}function o(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}Object.create;Object.create})),a.register("2TvXO",(function(e,t){var n=function(e){var t,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var i=t&&t.prototype instanceof y?t:y,o=Object.create(i.prototype),a=new T(r||[]);return o._invoke=function(e,t,n){var r=h;return function(i,o){if(r===d)throw new Error("Generator is already running");if(r===p){if("throw"===i)throw o;return P()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=E(a,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var u=c(e,t,n);if("normal"===u.type){if(r=n.done?p:f,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=p,n.method="throw",n.arg=u.arg)}}}(e,n,a),o}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var h="suspendedStart",f="suspendedYield",d="executing",p="completed",v={};function y(){}function _(){}function g(){}var m={};u(m,o,(function(){return this}));var k=Object.getPrototypeOf,C=k&&k(k(N([])));C&&C!==n&&r.call(C,o)&&(m=C);var w=g.prototype=y.prototype=Object.create(m);function b(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,t){function n(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==typeof h&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(h).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var i;this._invoke=function(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}}function E(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=c(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function N(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:P}}function P(){return{value:t,done:!0}}return _.prototype=g,u(w,"constructor",g),u(g,"constructor",_),_.displayName=u(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,u(e,s,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},b(x.prototype),u(x.prototype,a,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new x(l(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(w),u(w,s,"Generator"),u(w,o,(function(){return this})),u(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=N,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(u&&l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;I(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}(e.exports);try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}})),a.register("6ExWU",(function(n,r){e(n.exports,"Component",(function(){return f})),e(n.exports,"ComponentContainer",(function(){return v})),a("8TSCy");var i=a("f9pi5"),o=a("jK9zx"),s=a("iCnzh"),u=a("jcnGU"),l=a("5Vgx8"),c=a("2TvXO"),h=a("2xDiJ"),f=function(){"use strict";function e(t,n,r){i.default(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return o.default(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),d="[DEFAULT]",p=function(){"use strict";function e(t,n){i.default(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return o.default(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new h.Deferred;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e))try{this.getOrInitializeService({instanceIdentifier:d})}catch(e){}var t=!0,n=!1,r=void 0;try{for(var i,o=this.instancesDeferred.entries()[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a=s.default(i.value,2),u=a[0],l=a[1],c=this.normalizeInstanceIdentifier(u);try{var h=this.getOrInitializeService({instanceIdentifier:c});l.resolve(h)}catch(e){}}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=this;return u.default(t(c).mark((function n(){var r;return t(c).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Array.from(e.instances.values()),t.next=3,Promise.all(l.default(r.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()}))).concat(l.default(r.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))));case 3:case"end":return t.stop()}}),n)})))()}},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var i=this.getOrInitializeService({instanceIdentifier:r,options:n}),o=!0,a=!1,u=void 0;try{for(var l,c=this.instancesDeferred.entries()[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var h=s.default(l.value,2),f=h[0],d=h[1],p=this.normalizeInstanceIdentifier(f);r===p&&d.resolve(i)}}catch(e){a=!0,u=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw u}}return i}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&e(o,r),function(){i.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r=!0,i=!1,o=void 0;try{for(var a,s=n[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;try{u(e,t)}catch(e){}}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===d?void 0:t),options:i}),this.instances.set(n,o),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(o,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(e){}return o||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d;return this.component?this.component.multipleInstances?e:d:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}();var v=function(){"use strict";function e(t){i.default(this,e),this.name=t,this.providers=new Map}return o.default(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new p(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}()})),a.register("2xDiJ",(function(t,r){e(t.exports,"assert",(function(){return v})),e(t.exports,"assertionError",(function(){return y})),e(t.exports,"base64",(function(){return g})),e(t.exports,"base64Encode",(function(){return m})),e(t.exports,"base64urlEncodeWithoutPadding",(function(){return k})),e(t.exports,"deepCopy",(function(){return w})),e(t.exports,"Deferred",(function(){return x})),e(t.exports,"createMockUserToken",(function(){return E})),e(t.exports,"getUA",(function(){return S})),e(t.exports,"isMobileCordova",(function(){return I})),e(t.exports,"isBrowserExtension",(function(){return T})),e(t.exports,"isReactNative",(function(){return N})),e(t.exports,"isElectron",(function(){return P})),e(t.exports,"isIE",(function(){return O})),e(t.exports,"isUWP",(function(){return R})),e(t.exports,"isNodeSdk",(function(){return D})),e(t.exports,"isSafari",(function(){return A})),e(t.exports,"isIndexedDBAvailable",(function(){return L})),e(t.exports,"validateIndexedDBOpenable",(function(){return M})),e(t.exports,"FirebaseError",(function(){return F})),e(t.exports,"ErrorFactory",(function(){return j})),e(t.exports,"jsonEval",(function(){return U})),e(t.exports,"stringify",(function(){return z})),e(t.exports,"isValidFormat",(function(){return B})),e(t.exports,"isAdmin",(function(){return V})),e(t.exports,"contains",(function(){return G})),e(t.exports,"safeGet",(function(){return Y})),e(t.exports,"isEmpty",(function(){return K})),e(t.exports,"map",(function(){return Q})),e(t.exports,"deepEqual",(function(){return J})),e(t.exports,"querystring",(function(){return $})),e(t.exports,"Sha1",(function(){return Z})),e(t.exports,"errorPrefix",(function(){return ee})),e(t.exports,"stringToByteArray",(function(){return te})),e(t.exports,"stringLength",(function(){return ne})),e(t.exports,"getModularInstance",(function(){return re})),a("8TSCy");var i=a("f9pi5"),o=a("jK9zx"),s=a("g9uIT"),u=a("dap1g"),l=a("Kn7R4"),c=a("39bC9"),h=a("iCnzh"),f=(a("5Vgx8"),!1),d=!1,p="${JSCORE_VERSION}",v=function(e,t){if(!e)throw y(t)},y=function(e){return new Error("Firebase Database ("+p+") INTERNAL ASSERT FAILED: "+e)},_=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},g={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var o=e[i],a=i+1<e.length,s=a?e[i+1]:0,u=i+2<e.length,l=u?e[i+2]:0,c=o>>2,h=(3&o)<<4|s>>4,f=(15&s)<<2|l>>6,d=63&l;u||(d=64,a||(f=64)),r.push(n[c],n[h],n[f],n[d])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(_(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(a>>10)),t[r++]=String.fromCharCode(56320+(1023&a))}else{var s=e[n++],u=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&u)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var o=n[e.charAt(i++)],a=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();var l=o<<2|a>>4;if(r.push(l),64!==s){var c=a<<4&240|s>>2;if(r.push(c),64!==u){var h=s<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},m=function(e){var t=_(e);return g.encodeByteArray(t,!0)},k=function(e){return m(e).replace(/\./g,"")},C=function(e){try{return g.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function w(e){return b(void 0,e)}function b(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=b(e[n],t[n]));return e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var x=function(){"use strict";function e(){var t=this;i.default(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return o.default(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}}}]),e}();
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var o=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[k(JSON.stringify({alg:"none",type:"JWT"})),k(JSON.stringify(o)),""].join(".")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function I(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(S())}function T(){var e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function N(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function P(){return S().indexOf("Electron/")>=0}function O(){var e=S();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function R(){return S().indexOf("MSAppHost/")>=0}function D(){return!0===f||!0===d}function A(){return!function(){try{return"[object process]"===Object.prototype.toString.call(n.process)}catch(e){return!1}}()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function L(){return"object"==typeof indexedDB}function M(){return new Promise((function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var F=function(e){"use strict";s.default(n,e);var t=u.default(n);function n(e,r,o){var a;return i.default(this,n),(a=t.call(this,r)).code=e,a.customData=o,a.name="FirebaseError",Object.setPrototypeOf(l.default(a),n.prototype),Error.captureStackTrace&&Error.captureStackTrace(l.default(a),j.prototype.create),a}return n}(c.default(Error)),j=function(){"use strict";function e(t,n,r){i.default(this,e),this.service=t,this.serviceName=n,this.errors=r}return o.default(e,[{key:"create",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n[0]||{},o="".concat(this.service,"/").concat(e),a=this.errors[e],s=a?q(a,i):"Error",u="".concat(this.serviceName,": ").concat(s," (").concat(o,")."),l=new F(o,u,i);return l}}]),e}();function q(e,t){return e.replace(W,(function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}var W=/\{\$([^}]+)}/g;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U(e){return JSON.parse(e)}function z(e){return JSON.stringify(e)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var H=function(e){var t={},n={},r={},i="";try{var o=e.split(".");t=U(C(o[0])||""),n=U(C(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}},B=function(e){var t=H(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},V=function(e){var t=H(e).claims;return"object"==typeof t&&!0===t.admin};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function G(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Y(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function K(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Q(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function J(e,t){if(e===t)return!0;var n=Object.keys(e),r=Object.keys(t),i=!0,o=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;if(!r.includes(l))return!1;var c=e[l],h=t[l];if(X(c)&&X(h)){if(!J(c,h))return!1}else if(c!==h)return!1}}catch(e){o=!0,a=e}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}var f=!0,d=!1,p=void 0;try{for(var v,y=r[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var _=v.value;if(!n.includes(_))return!1}}catch(e){d=!0,p=e}finally{try{f||null==y.return||y.return()}finally{if(d)throw p}}return!0}function X(e){return null!==e&&"object"==typeof e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $(e){var t=[],n=!0,r=!1,i=void 0;try{for(var o,a=function(e,n){var r=h.default(n.value,2),i=r[0],o=r[1];Array.isArray(o)?o.forEach((function(e){t.push(encodeURIComponent(i)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(i)+"="+encodeURIComponent(o))},s=Object.entries(e)[Symbol.iterator]();!(n=(o=s.next()).done);n=!0)a(0,o)}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}return t.length?"&"+t.join("&"):""}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Z=function(){"use strict";function e(){i.default(this,e),this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return o.default(e,[{key:"reset",value:function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}},{key:"compress_",value:function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(var i=0;i<16;i++)n[i]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(var o=16;o<80;o++){var a=n[o-3]^n[o-8]^n[o-14]^n[o-16];n[o]=4294967295&(a<<1|a>>>31)}for(var s,u,l=this.chain_[0],c=this.chain_[1],h=this.chain_[2],f=this.chain_[3],d=this.chain_[4],p=0;p<80;p++){p<40?p<20?(s=f^c&(h^f),u=1518500249):(s=c^h^f,u=1859775393):p<60?(s=c&h|f&(c|h),u=2400959708):(s=c^h^f,u=3395469782);var v=(l<<5|l>>>27)+s+d+u+n[p]&4294967295;d=f,f=h,h=4294967295&(c<<30|c>>>2),c=l,l=v}this.chain_[0]=this.chain_[0]+l&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+h&4294967295,this.chain_[3]=this.chain_[3]+f&4294967295,this.chain_[4]=this.chain_[4]+d&4294967295}},{key:"update",value:function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<t;){if(0===o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}}},{key:"digest",value:function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);for(var r=0,i=0;i<5;i++)for(var o=24;o>=0;o-=8)e[r]=this.chain_[i]>>o&255,++r;return e}}]),e}();function ee(e,t){return"".concat(e," failed: ").concat(t," argument ")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var te=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var o=i-55296;r++,v(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(o<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},ne=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function re(e){return e&&e._delegate?e._delegate:e}})),a.register("kZfxc",(function(t,n){e(t.exports,"LogLevel",(function(){return r})),e(t.exports,"Logger",(function(){return v})),e(t.exports,"setLogLevel",(function(){return y})),e(t.exports,"setUserLogHandler",(function(){return _})),a("8TSCy");var r,i=a("aNiFM"),o=a("5Vgx8"),s=a("f9pi5"),u=a("jK9zx"),l=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(r||(r={}));var c,h={debug:r.DEBUG,verbose:r.VERBOSE,info:r.INFO,warn:r.WARN,error:r.ERROR,silent:r.SILENT},f=r.INFO,d=(c={},i.default(c,r.DEBUG,"log"),i.default(c,r.VERBOSE,"log"),i.default(c,r.INFO,"info"),i.default(c,r.WARN,"warn"),i.default(c,r.ERROR,"error"),c),p=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var a;if(!(t<e.logLevel)){var s=(new Date).toISOString(),u=d[t];if(!u)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));(a=console)[u].apply(a,["[".concat(s,"]  ").concat(e.name,":")].concat(o.default(r)))}},v=function(){"use strict";function e(t){s.default(this,e),this.name=t,this._logLevel=f,this._logHandler=p,this._userLogHandler=null,l.push(this)}return u.default(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in r))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"==typeof e?h[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,r.DEBUG].concat(o.default(t))),this._logHandler.apply(this,[this,r.DEBUG].concat(o.default(t)))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,r.VERBOSE].concat(o.default(t))),this._logHandler.apply(this,[this,r.VERBOSE].concat(o.default(t)))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,r.INFO].concat(o.default(t))),this._logHandler.apply(this,[this,r.INFO].concat(o.default(t)))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,r.WARN].concat(o.default(t))),this._logHandler.apply(this,[this,r.WARN].concat(o.default(t)))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,r.ERROR].concat(o.default(t))),this._logHandler.apply(this,[this,r.ERROR].concat(o.default(t)))}}]),e}();function y(e){l.forEach((function(t){t.setLogLevel(e)}))}function _(e,t){var n=!0,i=!1,o=void 0;try{for(var a,s=l[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var u=a.value,c=null;t&&t.level&&(c=h[t.level]),u.userLogHandler=null===e?null:function(t,n){for(var i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];var s=o.map((function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}})).filter((function(e){return e})).join(" ");n>=(null!=c?c:t.logLevel)&&e({level:r[n].toLowerCase(),message:s,args:o,type:t.name})}}}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}}})),a.register("ajgRO",(function(n,r){e(n.exports,"openDB",(function(){return c})),a("8TSCy");var i=a("jcnGU"),o=a("5Vgx8"),s=a("ifq4M"),u=a("2TvXO"),l=a("kKOTz");l=a("kKOTz");function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,i=n.upgrade,o=n.blocking,a=n.terminated,s=indexedDB.open(e,t),u=l.w(s);return i&&s.addEventListener("upgradeneeded",(function(e){i(l.w(s.result),e.oldVersion,e.newVersion,l.w(s.transaction))})),r&&s.addEventListener("blocked",(function(){return r()})),u.then((function(e){a&&e.addEventListener("close",(function(){return a()})),o&&e.addEventListener("versionchange",(function(){return o()}))})).catch((function(){})),u}var h=["get","getKey","getAll","getAllKeys","count"],f=["put","add","delete","clear"],d=new Map;function p(e,n){if(e instanceof IDBDatabase&&!(n in e)&&"string"==typeof n){if(d.get(n))return d.get(n);var r=n.replace(/FromIndex$/,""),a=n!==r,s=f.includes(r);if(r in(a?IDBIndex:IDBObjectStore).prototype&&(s||h.includes(r))){var l,c=(l=i.default(t(u).mark((function e(n){var i,l,c,h,f,d,p=arguments;return t(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=p.length,l=new Array(i>1?i-1:0),c=1;c<i;c++)l[c-1]=p[c];return f=this.transaction(n,s?"readwrite":"readonly"),d=f.store,a&&(d=d.index(l.shift())),e.next=7,Promise.all([(h=d)[r].apply(h,o.default(l)),s&&f.done]);case 7:return e.abrupt("return",e.sent[0]);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)});return d.set(n,c),c}}}l.r((function(e){return s.default({},e,{get:function(t,n,r){return p(t,n)||e.get(t,n,r)},has:function(t,n){return!!p(t,n)||e.has(t,n)}})}))})),a.register("kKOTz",(function(t,n){e(t.exports,"w",(function(){return y})),e(t.exports,"r",(function(){return d})),a("8TSCy");var r,i,o=a("5Vgx8");var s=new WeakMap,u=new WeakMap,l=new WeakMap,c=new WeakMap,h=new WeakMap;var f={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return u.get(e);if("objectStoreNames"===t)return e.objectStoreNames||l.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return y(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function d(e){f=e(f)}function p(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(_(this),n),y(s.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return y(e.apply(_(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var a,s=(a=e).call.apply(a,[_(this),t].concat(o.default(r)));return l.set(s,t.sort?t.sort():[t]),y(s)}}function v(e){return"function"==typeof e?p(e):(e instanceof IDBTransaction&&function(e){if(!u.has(e)){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=function(){t(),r()},o=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)}));u.set(e,t)}}(e),t=e,(r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((function(e){return t instanceof e}))?new Proxy(e,f):e);var t}function y(e){if(e instanceof IDBRequest)return t=e,(n=new Promise((function(e,n){var r=function(){t.removeEventListener("success",i),t.removeEventListener("error",o)},i=function(){e(y(t.result)),r()},o=function(){n(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",o)}))).then((function(e){e instanceof IDBCursor&&s.set(e,t)})).catch((function(){})),h.set(n,t),n;var t,n;if(c.has(e))return c.get(e);var r=v(e);return r!==e&&(c.set(e,r),h.set(r,e)),r}var _=function(e){return h.get(e)}})),a.register("4lh7F",(function(t,n){e(t.exports,"firebaseConfig",(function(){return o})),e(t.exports,"db",(function(){return u})),a("6Urw1");var r=a("MjY8E");a("6Nu6u");var i=a("eA2L7"),o={apiKey:"AIzaSyAPKpit5d04AWFT78SRxmw69uKq1QvSMJE",authDomain:"slutprojekt-388c9.firebaseapp.com",databaseURL:"https://slutprojekt-388c9-default-rtdb.europe-west1.firebasedatabase.app",projectId:"slutprojekt-388c9",storageBucket:"slutprojekt-388c9.appspot.com",messagingSenderId:"730459260473",appId:"1:730459260473:web:8e236691a79061c4946fe8"},s=r.initializeApp(o),u=i.getDatabase(s)})),a.register("6Nu6u",(function(t,n){e(t.exports,"getDatabase",(function(){return a("eA2L7").getDatabase})),e(t.exports,"ref",(function(){return a("eA2L7").ref})),e(t.exports,"get",(function(){return a("eA2L7").get})),e(t.exports,"child",(function(){return a("eA2L7").child})),e(t.exports,"update",(function(){return a("eA2L7").update})),e(t.exports,"remove",(function(){return a("eA2L7").remove})),a("eA2L7")})),a.register("eA2L7",(function(n,r){e(n.exports,"get",(function(){return wi})),e(n.exports,"remove",(function(){return mi})),e(n.exports,"child",(function(){return gi})),e(n.exports,"ref",(function(){return _i})),e(n.exports,"update",(function(){return Ci})),e(n.exports,"getDatabase",(function(){return Ii}));var i=a("8TSCy"),o=a("2TvXO"),s=a("MjY8E"),u=a("6ExWU"),l=a("2xDiJ"),c=a("kZfxc"),h=a("6qd2L"),f="@firebase/database",d="0.13.0",p="";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var v,y=function(){"use strict";function e(t){i.classCallCheck(this,e),this.domStorage_=t,this.prefix_="firebase:"}return i.createClass(e,[{key:"set",value:function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),l.stringify(t))}},{key:"get",value:function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:l.jsonEval(t)}},{key:"remove",value:function(e){this.domStorage_.removeItem(this.prefixedName_(e))}},{key:"prefixedName_",value:function(e){return this.prefix_+e}},{key:"toString",value:function(){return this.domStorage_.toString()}}]),e}(),_=function(){"use strict";function e(){i.classCallCheck(this,e),this.cache_={},this.isInMemoryStorage=!0}return i.createClass(e,[{key:"set",value:function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}},{key:"get",value:function(e){return l.contains(this.cache_,e)?this.cache_[e]:null}},{key:"remove",value:function(e){delete this.cache_[e]}}]),e}(),g=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new y(t)}}catch(e){}return new _},m=g("localStorage"),k=g("sessionStorage"),C=new c.Logger("@firebase/database"),w=(v=1,function(){return v++}),b=function(e){var t=l.stringToByteArray(e),n=new l.Sha1;n.update(t);var r=n.digest();return l.base64.encodeByteArray(r)},x=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r="",i=0;i<t.length;i++){var o=t[i];Array.isArray(o)||o&&"object"==typeof o&&"number"==typeof o.length?r+=x.apply(null,o):r+="object"==typeof o?l.stringify(o):o,r+=" "}return r},E=null,S=!0,I=function(e,t){l.assert(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(C.logLevel=c.LogLevel.VERBOSE,E=C.log.bind(C),t&&k.set("logging_enabled",!0)):"function"==typeof e?E=e:(E=null,k.remove("logging_enabled"))},T=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!0===S&&(S=!1,null===E&&!0===k.get("logging_enabled")&&I(!0)),E){var r=x.apply(null,t);E(r)}},N=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];T.apply(void 0,[e].concat(i.toConsumableArray(n)))}},P=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r="FIREBASE INTERNAL ERROR: "+x.apply(void 0,i.toConsumableArray(t));C.error(r)},O=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r="FIREBASE FATAL ERROR: ".concat(x.apply(void 0,i.toConsumableArray(t)));throw C.error(r),new Error(r)},R=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r="FIREBASE WARNING: "+x.apply(void 0,i.toConsumableArray(t));C.warn(r)},D=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},A="[MIN_NAME]",L="[MAX_NAME]",M=function(e,t){if(e===t)return 0;if(e===A||t===L)return-1;if(t===A||e===L)return 1;var n=G(e),r=G(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},F=function(e,t){return e===t?0:e<t?-1:1},j=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+l.stringify(t))},q=function(e){if("object"!=typeof e||null===e)return l.stringify(e);var t=[];for(var n in e)t.push(n);t.sort();for(var r="{",i=0;i<t.length;i++)0!==i&&(r+=","),r+=l.stringify(t[i]),r+=":",r+=q(e[t[i]]);return r+="}"},W=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}var z=function(e){l.assert(!D(e),"Invalid JSON number");var t,n,r,i,o,a=1023;0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),a))+a,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));var s=[];for(o=52;o;o-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(t?1:0),s.reverse();var u=s.join(""),c="";for(o=0;o<64;o+=8){var h=parseInt(u.substr(o,8),2).toString(16);1===h.length&&(h="0"+h),c+=h}return c.toLowerCase()};var H=new RegExp("^-?(0*)\\d{1,10}$"),B=-2147483648,V=2147483647,G=function(e){if(H.test(e)){var t=Number(e);if(t>=B&&t<=V)return t}return null},Y=function(e){try{e()}catch(e){setTimeout((function(){var t=e.stack||"";throw R("Exception was thrown by user callback.",t),e}),Math.floor(0))}},K=function(e,t){var n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n},Q=function(){"use strict";function e(t,n){var r=this;i.classCallCheck(this,e),this.appName_=t,this.appCheckProvider=n,this.appCheck=null==n?void 0:n.getImmediate({optional:!0}),this.appCheck||null==n||n.get().then((function(e){return r.appCheck=e}))}return i.createClass(e,[{key:"getToken",value:function(e){var t=this;return this.appCheck?this.appCheck.getToken(e):new Promise((function(n,r){var i=t;setTimeout((function(){i.appCheck?i.getToken(e).then(n,r):n(null)}),0)}))}},{key:"addTokenChangeListener",value:function(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((function(t){return t.addTokenListener(e)}))}},{key:"notifyForInvalidToken",value:function(){R('Provided AppCheck credentials for the app named "'.concat(this.appName_,'" ')+"are invalid. This usually indicates your app was not initialized correctly.")}}]),e}(),J=function(){"use strict";function e(t,n,r){var o=this;i.classCallCheck(this,e),this.appName_=t,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit((function(e){return o.auth_=e}))}return i.createClass(e,[{key:"getToken",value:function(e){var t=this;return this.auth_?this.auth_.getToken(e).catch((function(e){return e&&"auth/token-not-initialized"===e.code?(T("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)})):new Promise((function(n,r){var i=t;setTimeout((function(){i.auth_?i.getToken(e).then(n,r):n(null)}),0)}))}},{key:"addTokenChangeListener",value:function(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((function(t){return t.addAuthTokenListener(e)}))}},{key:"removeTokenChangeListener",value:function(e){this.authProvider_.get().then((function(t){return t.removeAuthTokenListener(e)}))}},{key:"notifyForInvalidToken",value:function(){var e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',R(e)}}]),e}(),X=function(){"use strict";function e(t){i.classCallCheck(this,e),this.accessToken=t}return i.createClass(e,[{key:"getToken",value:function(e){return Promise.resolve({accessToken:this.accessToken})}},{key:"addTokenChangeListener",value:function(e){e(this.accessToken)}},{key:"removeTokenChangeListener",value:function(e){}},{key:"notifyForInvalidToken",value:function(){}}]),e}();X.OWNER="owner";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var $="5",Z=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,ee="websocket",te="long_polling",ne=function(){"use strict";function e(t,n,r,o){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",u=arguments.length>6&&void 0!==arguments[6]&&arguments[6];i.classCallCheck(this,e),this.secure=n,this.namespace=r,this.webSocketOnly=o,this.nodeAdmin=a,this.persistenceKey=s,this.includeNamespaceInQueryParams=u,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=m.get("host:"+t)||this._host}return i.createClass(e,[{key:"isCacheableHost",value:function(){return"s-"===this.internalHost.substr(0,2)}},{key:"isCustomHost",value:function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}},{key:"host",get:function(){return this._host},set:function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&m.set("host:"+this._host,this.internalHost))}},{key:"toString",value:function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}},{key:"toURLString",value:function(){var e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns=".concat(this.namespace):"";return"".concat(e).concat(this.host,"/").concat(t)}}]),e}();function re(e,t,n){var r;if(l.assert("string"==typeof t,"typeof type must == string"),l.assert("object"==typeof n,"typeof params must == object"),t===ee)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==te)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);var i=[];return U(n,(function(e,t){i.push(e+"="+t)})),r+i.join("&")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ie=function(){"use strict";function e(){i.classCallCheck(this,e),this.counters_={}}return i.createClass(e,[{key:"incrementCounter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;l.contains(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}},{key:"get",value:function(){return l.deepCopy(this.counters_)}}]),e}(),oe={},ae={};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function se(e){var t=e.toString();return oe[t]||(oe[t]=new ie),oe[t]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ue=function(){"use strict";function e(t){i.classCallCheck(this,e),this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return i.createClass(e,[{key:"closeAfter",value:function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}},{key:"handleResponse",value:function(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){var n=function(e){i[e]&&Y((function(){r.onMessage_(i[e])}))},r=this,i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(var o=0;o<i.length;++o)n(o);if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}]),e}(),le="start",ce="close",he=function(){"use strict";function e(t,n,r,o,a,s,u){var l=this;i.classCallCheck(this,e),this.connId=t,this.repoInfo=n,this.applicationId=r,this.appCheckToken=o,this.authToken=a,this.transportSessionId=s,this.lastSessionId=u,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=N(t),this.stats_=se(n),this.urlFn=function(e){return l.appCheckToken&&(e.ac=l.appCheckToken),re(n,te,e)}}return i.createClass(e,[{key:"open",value:function(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new ue(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if(l.isNodeSdk()||"complete"===document.readyState)e();else{var t=!1,n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){var e=n;if(!n.isClosed_){n.scriptTagHolder=new fe((function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=i.slicedToArray(n,5),a=o[0],s=o[1],u=o[2];o[3],o[4];if(e.incrementIncomingBytes_(n),e.scriptTagHolder)if(e.connectTimeoutTimer_&&(clearTimeout(e.connectTimeoutTimer_),e.connectTimeoutTimer_=null),e.everConnected_=!0,a===le)e.id=s,e.password=u;else{if(a!==ce)throw new Error("Unrecognized command received: "+a);if(s){var l=e;e.scriptTagHolder.sendNewPolls=!1,e.myPacketOrderer.closeAfter(s,(function(){l.onClosed_()}))}else e.onClosed_()}}),(function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=i.slicedToArray(n,2),a=o[0],s=o[1];e.incrementIncomingBytes_(n),e.myPacketOrderer.handleResponse(a,s)}),(function(){e.onClosed_()}),n.urlFn);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=n.scriptTagHolder.uniqueCallbackIdentifier),t.v=$,n.transportSessionId&&(t.s=n.transportSessionId),n.lastSessionId&&(t.ls=n.lastSessionId),n.applicationId&&(t.p=n.applicationId),n.appCheckToken&&(t.ac=n.appCheckToken),"undefined"!=typeof location&&location.hostname&&Z.test(location.hostname)&&(t.r="f");var r=n.urlFn(t);n.log_("Connecting via long-poll to "+r),n.scriptTagHolder.addTag(r,(function(){}))}}))}},{key:"start",value:function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}},{key:"markConnectionHealthy",value:function(){}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}},{key:"send",value:function(e){var t=l.stringify(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n=l.base64Encode(t),r=W(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}},{key:"addDisconnectPingFrame",value:function(e,t){if(!l.isNodeSdk()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}}},{key:"incrementIncomingBytes_",value:function(e){var t=l.stringify(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}],[{key:"forceAllow",value:function(){e.forceAllow_=!0}},{key:"forceDisallow",value:function(){e.forceDisallow_=!0}},{key:"isAvailable",value:function(){return!l.isNodeSdk()&&(!!e.forceAllow_||!(e.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}}]),e}(),fe=function(){"use strict";function e(t,n,r,o){if(i.classCallCheck(this,e),this.onDisconnect=r,this.urlFn=o,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,l.isNodeSdk())this.commandCB=t,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=w(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=e.createIFrame_();var a="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11))a='<script>document.domain="'+document.domain+'";<\/script>';var s="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(s),this.myIFrame.doc.close()}catch(e){T("frame writing exception"),e.stack&&T(e.stack),T(e)}}}return i.createClass(e,[{key:"close",value:function(){if(this.alive=!1,this.myIFrame){var e=this;this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)}),Math.floor(0))}var t=this.onDisconnect;t&&(this.onDisconnect=null,t())}},{key:"startLongPoll",value:function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}},{key:"newRequest_",value:function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var t=this.urlFn(e),n="",r=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}},{key:"enqueueSegment",value:function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}},{key:"addLongPollTag_",value:function(e,t){var n=this;this.outstandingRequests.add(t);var r=function(){n.outstandingRequests.delete(t),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,(function(){clearTimeout(i),r()}))}},{key:"addTag",value:function(e,t){var n=this;l.isNodeSdk()?this.doNodeLongPoll(e,t):setTimeout((function(){try{var r=n;if(!n.sendNewPolls)return;var i=n.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.onload=i.onreadystatechange=function(){var e=i.readyState;e&&"loaded"!==e&&"complete"!==e||(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),t())},i.onerror=function(){T("Long-poll script failed to load: "+e),r.sendNewPolls=!1,r.close()},n.myIFrame.doc.body.appendChild(i)}catch(e){}}),Math.floor(1))}}],[{key:"createIFrame_",value:function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||T("No IE domain setting required")}catch(n){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}}]),e}(),de=null;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */"undefined"!=typeof MozWebSocket?de=MozWebSocket:"undefined"!=typeof WebSocket&&(de=WebSocket);var pe=function(){"use strict";function e(t,n,r,o,a,s,u){i.classCallCheck(this,e),this.connId=t,this.applicationId=r,this.appCheckToken=o,this.authToken=a,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=N(this.connId),this.stats_=se(n),this.connURL=e.connectionURL_(n,s,u,o,r),this.nodeAdmin=n.nodeAdmin}return i.createClass(e,[{key:"open",value:function(e,t){var n=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,m.set("previous_websocket_failure",!0);try{if(l.isNodeSdk()){var r=this.nodeAdmin?"AdminNode":"Node",i={headers:{"User-Agent":"Firebase/".concat($,"/").concat(p,"/").concat(h.platform,"/").concat(r),"X-Firebase-GMPID":this.applicationId||""}};this.authToken&&(i.headers.Authorization="Bearer ".concat(this.authToken)),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);var o={},a=0===this.connURL.indexOf("wss://")?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new de(this.connURL,[],undefined)}catch(e){this.log_("Error instantiating WebSocket.");var s=e.message||e.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(e){n.handleIncomingFrame(e)},this.mySock.onerror=function(e){n.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&n.log_(t),n.onClosed_()}}},{key:"start",value:function(){}},{key:"markConnectionHealthy",value:function(){m.remove("previous_websocket_failure")}},{key:"appendFrame_",value:function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var t=this.frames.join("");this.frames=null;var n=l.jsonEval(t);this.onMessage(n)}}},{key:"handleNewFrameCount_",value:function(e){this.totalFrames=e,this.frames=[]}},{key:"extractFrameCount_",value:function(e){if(l.assert(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}},{key:"handleIncomingFrame",value:function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}}},{key:"send",value:function(e){this.resetKeepAlive();var t=l.stringify(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=W(t,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])}},{key:"shutdown_",value:function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}},{key:"onClosed_",value:function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}},{key:"close",value:function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}},{key:"resetKeepAlive",value:function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()}),Math.floor(45e3))}},{key:"sendString_",value:function(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}],[{key:"connectionURL_",value:function(e,t,n,r,i){var o={};return o.v=$,!l.isNodeSdk()&&"undefined"!=typeof location&&location.hostname&&Z.test(location.hostname)&&(o.r="f"),t&&(o.s=t),n&&(o.ls=n),r&&(o.ac=r),i&&(o.p=i),re(e,ee,o)}},{key:"forceDisallow",value:function(){e.forceDisallow_=!0}},{key:"isAvailable",value:function(){var t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&null!==de&&!e.forceDisallow_}},{key:"previouslyFailed",value:function(){return m.isInMemoryStorage||!0===m.get("previous_websocket_failure")}}]),e}();pe.responsesRequiredToBeHealthy=2,pe.healthyTimeout=3e4;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ve=function(){"use strict";function e(t){i.classCallCheck(this,e),this.initTransports_(t)}return i.createClass(e,[{key:"initTransports_",value:function(t){var n=pe&&pe.isAvailable(),r=n&&!pe.previouslyFailed();if(t.webSocketOnly&&(n||R("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[pe];else{var i=this.transports_=[],o=!0,a=!1,s=void 0;try{for(var u,l=e.ALL_TRANSPORTS[Symbol.iterator]();!(o=(u=l.next()).done);o=!0){var c=u.value;c&&c.isAvailable()&&i.push(c)}}catch(e){a=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(a)throw s}}e.globalTransportInitialized_=!0}}},{key:"initialTransport",value:function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}},{key:"upgradeTransport",value:function(){return this.transports_.length>1?this.transports_[1]:null}}],[{key:"ALL_TRANSPORTS",get:function(){return[he,pe]}},{key:"IS_TRANSPORT_INITIALIZED",get:function(){return this.globalTransportInitialized_}}]),e}();ve.globalTransportInitialized_=!1;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ye=function(){"use strict";function e(t,n,r,o,a,s,u,l,c,h){i.classCallCheck(this,e),this.id=t,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=o,this.authToken_=a,this.onMessage_=s,this.onReady_=u,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=N("c:"+this.id+":"),this.transportManager_=new ve(n),this.log_("Connection created"),this.start_()}return i.createClass(e,[{key:"start_",value:function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){e.conn_&&e.conn_.open(n,r)}),Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=K((function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>102400?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>10240?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))}),Math.floor(i)))}},{key:"nextTransportId_",value:function(){return"c:"+this.id+":"+this.connectionCount++}},{key:"disconnReceiver_",value:function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}}},{key:"connReceiver_",value:function(e){var t=this;return function(n){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}}},{key:"sendRequest",value:function(e){var t={t:"d",d:e};this.sendData_(t)}},{key:"tryCleanupConnection",value:function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}},{key:"onSecondaryControl_",value:function(e){if("t"in e){var t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}},{key:"onSecondaryMessageReceived_",value:function(e){var t=j("t",e),n=j("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}},{key:"upgradeIfSecondaryHealthy_",value:function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}},{key:"proceedWithUpgrade_",value:function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}},{key:"onPrimaryMessageReceived_",value:function(e){var t=j("t",e),n=j("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}},{key:"onDataMessage_",value:function(e){this.onPrimaryResponse_(),this.onMessage_(e)}},{key:"onPrimaryResponse_",value:function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}},{key:"onControl_",value:function(e){var t=j("t",e);if("d"in e){var n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?P("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):P("Unknown control packet command: "+t)}}},{key:"onHandshake_",value:function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),$!==n&&R("Protocol version mismatch detected"),this.tryStartUpgrade_())}},{key:"tryStartUpgrade_",value:function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}},{key:"startUpgrade_",value:function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),K((function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())}),Math.floor(6e4))}},{key:"onReset_",value:function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}},{key:"onConnectionEstablished_",value:function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):K((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}},{key:"sendPingOnPrimaryIfNecessary_",value:function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}},{key:"onSecondaryConnectionLost_",value:function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}},{key:"onConnectionLost_",value:function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(m.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}},{key:"onConnectionShutdown_",value:function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}},{key:"sendData_",value:function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}},{key:"close",value:function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}},{key:"closeConnections_",value:function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}]),e}(),_e=function(){"use strict";function e(){i.classCallCheck(this,e)}return i.createClass(e,[{key:"put",value:function(e,t,n,r){}},{key:"merge",value:function(e,t,n,r){}},{key:"refreshAuthToken",value:function(e){}},{key:"refreshAppCheckToken",value:function(e){}},{key:"onDisconnectPut",value:function(e,t,n){}},{key:"onDisconnectMerge",value:function(e,t,n){}},{key:"onDisconnectCancel",value:function(e,t){}},{key:"reportStats",value:function(e){}}]),e}(),ge=function(){"use strict";function e(t){i.classCallCheck(this,e),this.allowedEvents_=t,this.listeners_={},l.assert(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return i.createClass(e,[{key:"trigger",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(Array.isArray(this.listeners_[e]))for(var o=i.toConsumableArray(this.listeners_[e]),a=0;a<o.length;a++)o[a].callback.apply(o[a].context,n)}},{key:"on",value:function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)}},{key:"off",value:function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)}},{key:"validateEventType_",value:function(e){l.assert(this.allowedEvents_.find((function(t){return t===e})),"Unknown event: "+e)}}]),e}(),me=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(){var e;return i.classCallCheck(this,n),(e=t.call(this,["online"])).online_=!0,"undefined"==typeof window||void 0===window.addEventListener||l.isMobileCordova()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return i.createClass(n,[{key:"getInitialEvent",value:function(e){return l.assert("online"===e,"Unknown event type: "+e),[this.online_]}},{key:"currentlyOnline",value:function(){return this.online_}}],[{key:"getInstance",value:function(){return new n}}]),n}(ge),ke=function(){"use strict";function e(t,n){if(i.classCallCheck(this,e),void 0===n){this.pieces_=t.split("/");for(var r=0,o=0;o<this.pieces_.length;o++)this.pieces_[o].length>0&&(this.pieces_[r]=this.pieces_[o],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=n}return i.createClass(e,[{key:"toString",value:function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}]),e}();function Ce(){return new ke("")}function we(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function be(e){return e.pieces_.length-e.pieceNum_}function xe(e){var t=e.pieceNum_;return t<e.pieces_.length&&t++,new ke(e.pieces_,t)}function Ee(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function Se(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function Ie(e){if(e.pieceNum_>=e.pieces_.length)return null;for(var t=[],n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new ke(t,0)}function Te(e,t){for(var n=[],r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof ke)for(var i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);else for(var o=t.split("/"),a=0;a<o.length;a++)o[a].length>0&&n.push(o[a]);return new ke(n,0)}function Ne(e){return e.pieceNum_>=e.pieces_.length}function Pe(e,t){var n=we(e),r=we(t);if(null===n)return t;if(n===r)return Pe(xe(e),xe(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Oe(e,t){for(var n=Se(e,0),r=Se(t,0),i=0;i<n.length&&i<r.length;i++){var o=M(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1}function Re(e,t){if(be(e)!==be(t))return!1;for(var n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function De(e,t){var n=e.pieceNum_,r=t.pieceNum_;if(be(e)>be(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}var Ae=function e(t,n){"use strict";i.classCallCheck(this,e),this.errorPrefix_=n,this.parts_=Se(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(var r=0;r<this.parts_.length;r++)this.byteLength_+=l.stringLength(this.parts_[r]);Le(this)};function Le(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Me(e))}function Me(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fe=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(){var e,r,o;return i.classCallCheck(this,n),e=t.call(this,["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(o="visibilitychange",r="hidden"):void 0!==document.mozHidden?(o="mozvisibilitychange",r="mozHidden"):void 0!==document.msHidden?(o="msvisibilitychange",r="msHidden"):void 0!==document.webkitHidden&&(o="webkitvisibilitychange",r="webkitHidden")),e.visible_=!0,o&&document.addEventListener(o,(function(){var t=!document[r];t!==e.visible_&&(e.visible_=t,e.trigger("visible",t))}),!1),e}return i.createClass(n,[{key:"getInitialEvent",value:function(e){return l.assert("visible"===e,"Unknown event type: "+e),[this.visible_]}}],[{key:"getInstance",value:function(){return new n}}]),n}(ge),je=1e3,qe=function(e){"use strict";i.inherits(r,e);var n=i.createSuper(r);function r(e,t,o,a,s,u,c,h){var f;if(i.classCallCheck(this,r),(f=n.call(this)).repoInfo_=e,f.applicationId_=t,f.onDataUpdate_=o,f.onConnectStatus_=a,f.onServerInfoUpdate_=s,f.authTokenProvider_=u,f.appCheckTokenProvider_=c,f.authOverride_=h,f.id=r.nextPersistentConnectionId_++,f.log_=N("p:"+f.id+":"),f.interruptReasons_={},f.listens=new Map,f.outstandingPuts_=[],f.outstandingGets_=[],f.outstandingPutCount_=0,f.outstandingGetCount_=0,f.onDisconnectRequestQueue_=[],f.connected_=!1,f.reconnectDelay_=je,f.maxReconnectDelay_=3e5,f.securityDebugCallback_=null,f.lastSessionId=null,f.establishConnectionTimer_=null,f.visible_=!1,f.requestCBHash_={},f.requestNumber_=0,f.realtime_=null,f.authToken_=null,f.appCheckToken_=null,f.forceTokenRefresh_=!1,f.invalidAuthTokenCount_=0,f.invalidAppCheckTokenCount_=0,f.firstConnection_=!0,f.lastConnectionAttemptTime_=null,f.lastConnectionEstablishedTime_=null,h&&!l.isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return Fe.getInstance().on("visible",f.onVisible_,i.assertThisInitialized(f)),-1===e.host.indexOf("fblocal")&&me.getInstance().on("online",f.onOnline_,i.assertThisInitialized(f)),f}return i.createClass(r,[{key:"sendRequest",value:function(e,t,n){var r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(l.stringify(i)),l.assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}},{key:"get",value:function(e){var t=this;this.initConnection_();var n=new l.Deferred,r={p:e._path.toString(),q:e._queryObject},i={action:"g",request:r,onComplete:function(e){var i=e.d;"ok"===e.s?(t.onDataUpdate_(r.p,i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;var o=this.outstandingGets_.length-1;return this.connected_||setTimeout((function(){var e=t.outstandingGets_[o];void 0!==e&&i===e&&(delete t.outstandingGets_[o],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),t.log_("get "+o+" timed out on connection"),n.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(o),n.promise}},{key:"listen",value:function(e,t,n,r){this.initConnection_();var i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),l.assert(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),l.assert(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");var a={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)}},{key:"sendGet_",value:function(e){var t=this,n=this.outstandingGets_[e];this.sendRequest("g",n.request,(function(r){delete t.outstandingGets_[e],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))}},{key:"sendListen_",value:function(e){var t=this,n=e.query,i=n._path.toString(),o=n._queryIdentifier;this.log_("Listen on "+i+" for "+o);var a={p:i};e.tag&&(a.q=n._queryObject,a.t=e.tag),a.h=e.hashFn(),this.sendRequest("q",a,(function(a){var s=a.d,u=a.s;r.warnOnListenWarnings_(s,n),(t.listens.get(i)&&t.listens.get(i).get(o))===e&&(t.log_("listen response",a),"ok"!==u&&t.removeListen_(i,o),e.onComplete&&e.onComplete(u,s))}))}},{key:"refreshAuthToken",value:function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(e)}},{key:"reduceReconnectDelayIfAdminCredential_",value:function(e){(e&&40===e.length||l.isAdmin(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}},{key:"refreshAppCheckToken",value:function(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(function(){}))}},{key:"tryAuth",value:function(){if(this.connected_&&this.authToken_){var e=this,t=this.authToken_,n=l.isValidFormat(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n.s,i=n.d||"error";e.authToken_===t&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))}))}}},{key:"tryAppCheck",value:function(){var e=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(function(t){var n=t.s,r=t.d||"error";"ok"===n?e.invalidAppCheckTokenCount_=0:e.onAppCheckRevoked_(n,r)}))}},{key:"unlisten",value:function(e,t){var n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),l.assert(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}},{key:"sendUnlisten_",value:function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}},{key:"onDisconnectPut",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}},{key:"onDisconnectMerge",value:function(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}},{key:"onDisconnectCancel",value:function(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}},{key:"sendOnDisconnect_",value:function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(function(e){r&&setTimeout((function(){r(e.s,e.d)}),Math.floor(0))}))}},{key:"put",value:function(e,t,n,r){this.putInternal("p",e,t,n,r)}},{key:"merge",value:function(e,t,n,r){this.putInternal("m",e,t,n,r)}},{key:"putInternal",value:function(e,t,n,r,i){this.initConnection_();var o={p:t,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)}},{key:"sendPut_",value:function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,(function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(r.s,r.d)}))}},{key:"reportStats",value:function(e){if(this.connected_){var t=this,n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,(function(e){if("ok"!==e.s){var n=e.d;t.log_("reportStats","Error sending stats: "+n)}}))}}},{key:"onDataMessage_",value:function(e){if("r"in e){this.log_("from server: "+l.stringify(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}},{key:"onDataPush_",value:function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):P("Unrecognized action received from server: "+l.stringify(e)+"\nAre you using the latest client?")}},{key:"onReady_",value:function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}},{key:"scheduleConnect_",value:function(e){var t=this;l.assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){t.establishConnectionTimer_=null,t.establishConnection_()}),Math.floor(e))}},{key:"initConnection_",value:function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}},{key:"onVisible_",value:function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=je,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}},{key:"onOnline_",value:function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=je,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}},{key:"onRealtimeDisconnect_",value:function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=je),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var e=(new Date).getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}},{key:"establishConnection_",value:function(){var e=this;return i.asyncToGenerator(t(o).mark((function n(){var a,s,u,c,h,f,d,p,v,y,_,g,m;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.shouldReconnect_()){t.next=31;break}return e.log_("Making a connection attempt"),e.lastConnectionAttemptTime_=(new Date).getTime(),e.lastConnectionEstablishedTime_=null,a=e.onDataMessage_.bind(e),s=e.onReady_.bind(e),u=e.onRealtimeDisconnect_.bind(e),c=e.id+":"+r.nextConnectionId_++,h=e.lastSessionId,f=!1,d=null,p=function(){d?d.close():(f=!0,u())},v=function(e){l.assert(d,"sendRequest call when we're not connected not allowed."),d.sendRequest(e)},e.realtime_={close:p,sendRequest:v},y=e.forceTokenRefresh_,e.forceTokenRefresh_=!1,t.prev=16,t.t0=i,t.next=20,Promise.all([e.authTokenProvider_.getToken(y),e.appCheckTokenProvider_.getToken(y)]);case 20:t.t1=t.sent,_=t.t0.slicedToArray.call(t.t0,t.t1,2),g=_[0],m=_[1],f?T("getToken() completed but was canceled"):(T("getToken() completed. Creating connection."),e.authToken_=g&&g.accessToken,e.appCheckToken_=m&&m.token,d=new ye(c,e.repoInfo_,e.applicationId_,e.appCheckToken_,e.authToken_,a,s,u,(function(t){R(t+" ("+e.repoInfo_.toString()+")"),e.interrupt("server_kill")}),h)),t.next=31;break;case 27:t.prev=27,t.t2=t.catch(16),e.log_("Failed to get token: "+t.t2),f||(e.repoInfo_.nodeAdmin&&R(t.t2),p());case 31:case"end":return t.stop()}}),n,null,[[16,27]])})))()}},{key:"interrupt",value:function(e){T("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}},{key:"resume",value:function(e){T("Resuming connection for reason: "+e),delete this.interruptReasons_[e],l.isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=je,this.realtime_||this.scheduleConnect_(0))}},{key:"handleTimestamp_",value:function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}},{key:"cancelSentTransactions_",value:function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}},{key:"onListenRevoked_",value:function(e,t){var n;n=t?t.map((function(e){return q(e)})).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}},{key:"removeListen_",value:function(e,t){var n,r=new ke(e).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(t),i.delete(t),0===i.size&&this.listens.delete(r)}else n=void 0;return n}},{key:"onAuthRevoked_",value:function(e,t){T("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}},{key:"onAppCheckRevoked_",value:function(e,t){T("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}},{key:"onSecurityDebugPacket_",value:function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}},{key:"restoreState_",value:function(){this.tryAuth(),this.tryAppCheck();var e=!0,t=!1,n=void 0,r=!0,i=!1,o=void 0;try{for(var a,s=this.listens.values()[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;try{for(var l,c=u.values()[Symbol.iterator]();!(e=(l=c.next()).done);e=!0){var h=l.value;this.sendListen_(h)}}catch(e){t=!0,n=e}finally{try{e||null==c.return||c.return()}finally{if(t)throw n}}}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}for(var f=0;f<this.outstandingPuts_.length;f++)this.outstandingPuts_[f]&&this.sendPut_(f);for(;this.onDisconnectRequestQueue_.length;){var d=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(d.action,d.pathString,d.data,d.onComplete)}for(var p=0;p<this.outstandingGets_.length;p++)this.outstandingGets_[p]&&this.sendGet_(p)}},{key:"sendConnectStats_",value:function(){var e={},t="js";l.isNodeSdk()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+p.replace(/\./g,"-")]=1,l.isMobileCordova()?e["framework.cordova"]=1:l.isReactNative()&&(e["framework.reactnative"]=1),this.reportStats(e)}},{key:"shouldReconnect_",value:function(){var e=me.getInstance().currentlyOnline();return l.isEmpty(this.interruptReasons_)&&e}}],[{key:"warnOnListenWarnings_",value:function(e,t){if(e&&"object"==typeof e&&l.contains(e,"w")){var n=l.safeGet(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',i=t._path.toString();R("Using an unspecified index. Your data will be downloaded and "+"filtered on the client. Consider adding ".concat(r," at ")+"".concat(i," to your security rules for better performance."))}}}}]),r}(_e);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qe.nextPersistentConnectionId_=0,qe.nextConnectionId_=0;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var We,Ue=function(){"use strict";function e(t,n){i.classCallCheck(this,e),this.name=t,this.node=n}return i.createClass(e,null,[{key:"Wrap",value:function(t,n){return new e(t,n)}}]),e}(),ze=function(){"use strict";function e(){i.classCallCheck(this,e)}return i.createClass(e,[{key:"getCompare",value:function(){return this.compare.bind(this)}},{key:"indexedValueChanged",value:function(e,t){var n=new Ue(A,e),r=new Ue(A,t);return 0!==this.compare(n,r)}},{key:"minPost",value:function(){return Ue.MIN}}]),e}(),He=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(){return i.classCallCheck(this,n),t.apply(this,arguments)}return i.createClass(n,[{key:"compare",value:function(e,t){return M(e.name,t.name)}},{key:"isDefinedOn",value:function(e){throw l.assertionError("KeyIndex.isDefinedOn not expected to be called.")}},{key:"indexedValueChanged",value:function(e,t){return!1}},{key:"minPost",value:function(){return Ue.MIN}},{key:"maxPost",value:function(){return new Ue(L,We)}},{key:"makePost",value:function(e,t){return l.assert("string"==typeof e,"KeyIndex indexValue must always be a string."),new Ue(e,We)}},{key:"toString",value:function(){return".key"}}],[{key:"__EMPTY_NODE",get:function(){return We},set:function(e){We=e}}]),n}(ze),Be=new He,Ve=function(){"use strict";function e(t,n,r,o){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;i.classCallCheck(this,e),this.isReverse_=o,this.resultGenerator_=a,this.nodeStack_=[];for(var s=1;!t.isEmpty();)if(s=n?r(t.key,n):1,o&&(s*=-1),s<0)t=this.isReverse_?t.left:t.right;else{if(0===s){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return i.createClass(e,[{key:"getNext",value:function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}},{key:"hasNext",value:function(){return this.nodeStack_.length>0}},{key:"peek",value:function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}]),e}(),Ge=function(){"use strict";function e(t,n,r,o,a){i.classCallCheck(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=o?o:Qe.EMPTY_NODE,this.right=null!=a?a:Qe.EMPTY_NODE}return i.createClass(e,[{key:"copy",value:function(t,n,r,i,o){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)}},{key:"count",value:function(){return this.left.count()+1+this.right.count()}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min_",value:function(){return this.left.isEmpty()?this:this.left.min_()}},{key:"minKey",value:function(){return this.min_().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()}},{key:"removeMin_",value:function(){if(this.left.isEmpty())return Qe.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()}},{key:"remove",value:function(e,t){var n,r;if(t(e,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return Qe.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}},{key:"isRed_",value:function(){return this.color}},{key:"fixUp_",value:function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}},{key:"moveRedLeft_",value:function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e}},{key:"moveRedRight_",value:function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e}},{key:"rotateLeft_",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight_",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip_",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth_",value:function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1}},{key:"check_",value:function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}]),e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ge.RED=!0,Ge.BLACK=!1;var Ye,Ke=function(){"use strict";function e(){i.classCallCheck(this,e)}return i.createClass(e,[{key:"copy",value:function(e,t,n,r,i){return this}},{key:"insert",value:function(e,t,n){return new Ge(e,t,null)}},{key:"remove",value:function(e,t){return this}},{key:"count",value:function(){return 0}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"check_",value:function(){return 0}},{key:"isRed_",value:function(){return!1}}]),e}(),Qe=function(){"use strict";function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.EMPTY_NODE;i.classCallCheck(this,e),this.comparator_=t,this.root_=n}return i.createClass(e,[{key:"insert",value:function(t,n){return new e(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,Ge.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,Ge.BLACK,null,null))}},{key:"get",value:function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}},{key:"getPredecessorKey",value:function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}},{key:"isEmpty",value:function(){return this.root_.isEmpty()}},{key:"count",value:function(){return this.root_.count()}},{key:"minKey",value:function(){return this.root_.minKey()}},{key:"maxKey",value:function(){return this.root_.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root_.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.root_.reverseTraversal(e)}},{key:"getIterator",value:function(e){return new Ve(this.root_,null,this.comparator_,!1,e)}},{key:"getIteratorFrom",value:function(e,t){return new Ve(this.root_,e,this.comparator_,!1,t)}},{key:"getReverseIteratorFrom",value:function(e,t){return new Ve(this.root_,e,this.comparator_,!0,t)}},{key:"getReverseIterator",value:function(e){return new Ve(this.root_,null,this.comparator_,!0,e)}}]),e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function Je(e,t){return M(e.name,t.name)}function Xe(e,t){return M(e,t)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qe.EMPTY_NODE=new Ke;var $e,Ze,et,tt=function(e){return"number"==typeof e?"number:"+z(e):"string:"+e},nt=function(e){if(e.isLeafNode()){var t=e.val();l.assert("string"==typeof t||"number"==typeof t||"object"==typeof t&&l.contains(t,".sv"),"Priority must be a string or number.")}else l.assert(e===Ye||e.isEmpty(),"priority of unexpected type.");l.assert(e===Ye||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},rt=function(){"use strict";function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.__childrenNodeConstructor.EMPTY_NODE;i.classCallCheck(this,e),this.value_=t,this.priorityNode_=n,this.lazyHash_=null,l.assert(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),nt(this.priorityNode_)}return i.createClass(e,[{key:"isLeafNode",value:function(){return!0}},{key:"getPriority",value:function(){return this.priorityNode_}},{key:"updatePriority",value:function(t){return new e(this.value_,t)}},{key:"getImmediateChild",value:function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}},{key:"getChild",value:function(t){return Ne(t)?this:".priority"===we(t)?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE}},{key:"hasChild",value:function(){return!1}},{key:"getPredecessorChildName",value:function(e,t){return null}},{key:"updateImmediateChild",value:function(t,n){return".priority"===t?this.updatePriority(n):n.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)}},{key:"updateChild",value:function(t,n){var r=we(t);return null===r?n:n.isEmpty()&&".priority"!==r?this:(l.assert(".priority"!==r||1===be(t),".priority must be the last token in a path"),this.updateImmediateChild(r,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(xe(t),n)))}},{key:"isEmpty",value:function(){return!1}},{key:"numChildren",value:function(){return 0}},{key:"forEachChild",value:function(e,t){return!1}},{key:"val",value:function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+tt(this.priorityNode_.val())+":");var t=i.typeOf(this.value_);e+=t+":",e+="number"===t?z(this.value_):this.value_,this.lazyHash_=b(e)}return this.lazyHash_}},{key:"getValue",value:function(){return this.value_}},{key:"compareTo",value:function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(l.assert(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}},{key:"compareToLeafNode_",value:function(t){var n=i.typeOf(t.value_),r=i.typeOf(this.value_),o=e.VALUE_TYPE_ORDER.indexOf(n),a=e.VALUE_TYPE_ORDER.indexOf(r);return l.assert(o>=0,"Unknown leaf type: "+n),l.assert(a>=0,"Unknown leaf type: "+r),o===a?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:a-o}},{key:"withIndex",value:function(){return this}},{key:"isIndexed",value:function(){return!0}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}],[{key:"__childrenNodeConstructor",get:function(){return $e},set:function(e){$e=e}}]),e}();rt.VALUE_TYPE_ORDER=["object","boolean","number","string"];var it,ot,at=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(){return i.classCallCheck(this,n),t.apply(this,arguments)}return i.createClass(n,[{key:"compare",value:function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?M(e.name,t.name):i}},{key:"isDefinedOn",value:function(e){return!e.getPriority().isEmpty()}},{key:"indexedValueChanged",value:function(e,t){return!e.getPriority().equals(t.getPriority())}},{key:"minPost",value:function(){return Ue.MIN}},{key:"maxPost",value:function(){return new Ue(L,new rt("[PRIORITY-POST]",et))}},{key:"makePost",value:function(e,t){var n=Ze(e);return new Ue(t,new rt("[PRIORITY-POST]",n))}},{key:"toString",value:function(){return".priority"}}]),n}(ze),st=new at,ut=Math.log(2),lt=function(){"use strict";function e(t){i.classCallCheck(this,e);var n;this.count=(n=t+1,parseInt(Math.log(n)/ut,10)),this.current_=this.count-1;var r,o=(r=this.count,parseInt(Array(r+1).join("1"),2));this.bits_=t+1&o}return i.createClass(e,[{key:"nextBitIsOne",value:function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e}}]),e}(),ct=function(e,t,n,r){e.sort(t);var i=function(t,r){var o,a,s=r-t;if(0===s)return null;if(1===s)return o=e[t],a=n?n(o):o,new Ge(a,o.node,Ge.BLACK,null,null);var u=parseInt(s/2,10)+t,l=i(t,u),c=i(u+1,r);return o=e[u],a=n?n(o):o,new Ge(a,o.node,Ge.BLACK,l,c)},o=function(t){for(var r=null,o=null,a=e.length,s=function(t,r){var o=a-t,s=a;a-=t;var l=i(o+1,s),c=e[o],h=n?n(c):c;u(new Ge(h,c.node,r,null,l))},u=function(e){r?(r.left=e,r=e):(o=e,r=e)},l=0;l<t.count;++l){var c=t.nextBitIsOne(),h=Math.pow(2,t.count-(l+1));c?s(h,Ge.BLACK):(s(h,Ge.BLACK),s(h,Ge.RED))}return o}(new lt(e.length));return new Qe(r||t,o)},ht={},ft=function(){"use strict";function e(t,n){i.classCallCheck(this,e),this.indexes_=t,this.indexSet_=n}return i.createClass(e,[{key:"get",value:function(e){var t=l.safeGet(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Qe?t:null}},{key:"hasIndex",value:function(e){return l.contains(this.indexSet_,e.toString())}},{key:"addIndex",value:function(t,n){l.assert(t!==Be,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],o=!1,a=n.getIterator(Ue.Wrap),s=a.getNext();s;)o=o||t.isDefinedOn(s.node),i.push(s),s=a.getNext();r=o?ct(i,t.getCompare()):ht;var u=t.toString(),c=Object.assign({},this.indexSet_);c[u]=t;var h=Object.assign({},this.indexes_);return h[u]=r,new e(h,c)}},{key:"addToIndexes",value:function(t,n){var r=this;return new e(l.map(this.indexes_,(function(e,i){var o=l.safeGet(r.indexSet_,i);if(l.assert(o,"Missing index implementation for "+i),e===ht){if(o.isDefinedOn(t.node)){for(var a=[],s=n.getIterator(Ue.Wrap),u=s.getNext();u;)u.name!==t.name&&a.push(u),u=s.getNext();return a.push(t),ct(a,o.getCompare())}return ht}var c=n.get(t.name),h=e;return c&&(h=h.remove(new Ue(t.name,c))),h.insert(t,t.node)})),this.indexSet_)}},{key:"removeFromIndexes",value:function(t,n){return new e(l.map(this.indexes_,(function(e){if(e===ht)return e;var r=n.get(t.name);return r?e.remove(new Ue(t.name,r)):e})),this.indexSet_)}}],[{key:"Default",get:function(){return l.assert(ht&&st,"ChildrenNode.ts has not been loaded"),it=it||new e({".priority":ht},{".priority":st})}}]),e}(),dt=function(){"use strict";function e(t,n,r){i.classCallCheck(this,e),this.children_=t,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&nt(this.priorityNode_),this.children_.isEmpty()&&l.assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return i.createClass(e,[{key:"isLeafNode",value:function(){return!1}},{key:"getPriority",value:function(){return this.priorityNode_||ot}},{key:"updatePriority",value:function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)}},{key:"getImmediateChild",value:function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?ot:t}},{key:"getChild",value:function(e){var t=we(e);return null===t?this:this.getImmediateChild(t).getChild(xe(e))}},{key:"hasChild",value:function(e){return null!==this.children_.get(e)}},{key:"updateImmediateChild",value:function(t,n){if(l.assert(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);var r,i,o=new Ue(t,n);n.isEmpty()?(r=this.children_.remove(t),i=this.indexMap_.removeFromIndexes(o,this.children_)):(r=this.children_.insert(t,n),i=this.indexMap_.addToIndexes(o,this.children_));var a=r.isEmpty()?ot:this.priorityNode_;return new e(r,a,i)}},{key:"updateChild",value:function(e,t){var n=we(e);if(null===n)return t;l.assert(".priority"!==we(e)||1===be(e),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(xe(e),t);return this.updateImmediateChild(n,r)}},{key:"isEmpty",value:function(){return this.children_.isEmpty()}},{key:"numChildren",value:function(){return this.children_.count()}},{key:"val",value:function(t){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(st,(function(a,s){n[a]=s.val(t),r++,o&&e.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1})),!t&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}},{key:"hash",value:function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+tt(this.getPriority().val())+":"),this.forEachChild(st,(function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":b(e)}return this.lazyHash_}},{key:"getPredecessorChildName",value:function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new Ue(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)}},{key:"getFirstChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()}},{key:"getFirstChild",value:function(e){var t=this.getFirstChildName(e);return t?new Ue(t,this.children_.get(t)):null}},{key:"getLastChildName",value:function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()}},{key:"getLastChild",value:function(e){var t=this.getLastChildName(e);return t?new Ue(t,this.children_.get(t)):null}},{key:"forEachChild",value:function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal((function(e){return t(e.name,e.node)})):this.children_.inorderTraversal(t)}},{key:"getIterator",value:function(e){return this.getIteratorFrom(e.minPost(),e)}},{key:"getIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getIteratorFrom(e.name,Ue.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r}},{key:"getReverseIterator",value:function(e){return this.getReverseIteratorFrom(e.maxPost(),e)}},{key:"getReverseIteratorFrom",value:function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getReverseIteratorFrom(e.name,Ue.Wrap),i=r.peek();null!=i&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r}},{key:"compareTo",value:function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===pt?-1:0}},{key:"withIndex",value:function(t){if(t===Be||this.indexMap_.hasIndex(t))return this;var n=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,n)}},{key:"isIndexed",value:function(e){return e===Be||this.indexMap_.hasIndex(e)}},{key:"equals",value:function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var n=this.getIterator(st),r=t.getIterator(st),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1}},{key:"resolveIndex_",value:function(e){return e===Be?null:this.indexMap_.get(e.toString())}}],[{key:"EMPTY_NODE",get:function(){return ot||(ot=new e(new Qe(Xe),null,ft.Default))}}]),e}();dt.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;var pt=new(function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(){return i.classCallCheck(this,n),t.call(this,new Qe(Xe),dt.EMPTY_NODE,ft.Default)}return i.createClass(n,[{key:"compareTo",value:function(e){return e===this?0:1}},{key:"equals",value:function(e){return e===this}},{key:"getPriority",value:function(){return this}},{key:"getImmediateChild",value:function(e){return dt.EMPTY_NODE}},{key:"isEmpty",value:function(){return!1}}]),n}(dt));Object.defineProperties(Ue,{MIN:{value:new Ue(A,dt.EMPTY_NODE)},MAX:{value:new Ue(L,pt)}}),He.__EMPTY_NODE=dt.EMPTY_NODE,rt.__childrenNodeConstructor=dt,Ye=pt,function(e){et=e}(pt);function vt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e)return dt.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),l.assert(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+(void 0===t?"undefined":i.typeOf(t))),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e){var n=e;return new rt(n,vt(t))}if(e instanceof Array){var r=dt.EMPTY_NODE;return U(e,(function(t,n){if(l.contains(e,t)&&"."!==t.substring(0,1)){var i=vt(n);!i.isLeafNode()&&i.isEmpty()||(r=r.updateImmediateChild(t,i))}})),r.updatePriority(vt(t))}var o=[],a=!1,s=e;if(U(s,(function(e,t){if("."!==e.substring(0,1)){var n=vt(t);n.isEmpty()||(a=a||!n.getPriority().isEmpty(),o.push(new Ue(e,n)))}})),0===o.length)return dt.EMPTY_NODE;var u=ct(o,Je,(function(e){return e.name}),Xe);if(a){var c=ct(o,st.getCompare());return new dt(u,vt(t),new ft({".priority":c},{".priority":st}))}return new dt(u,vt(t),ft.Default)}!function(e){Ze=e}(vt);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var yt,_t,gt=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e){var r;return i.classCallCheck(this,n),(r=t.call(this)).indexPath_=e,l.assert(!Ne(e)&&".priority"!==we(e),"Can't create PathIndex with empty path or .priority key"),r}return i.createClass(n,[{key:"extractChild",value:function(e){return e.getChild(this.indexPath_)}},{key:"isDefinedOn",value:function(e){return!e.getChild(this.indexPath_).isEmpty()}},{key:"compare",value:function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?M(e.name,t.name):i}},{key:"makePost",value:function(e,t){var n=vt(e),r=dt.EMPTY_NODE.updateChild(this.indexPath_,n);return new Ue(t,r)}},{key:"maxPost",value:function(){var e=dt.EMPTY_NODE.updateChild(this.indexPath_,pt);return new Ue(L,e)}},{key:"toString",value:function(){return Se(this.indexPath_,0).join("/")}}]),n}(ze),mt=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(){return i.classCallCheck(this,n),t.apply(this,arguments)}return i.createClass(n,[{key:"compare",value:function(e,t){var n=e.node.compareTo(t.node);return 0===n?M(e.name,t.name):n}},{key:"isDefinedOn",value:function(e){return!0}},{key:"indexedValueChanged",value:function(e,t){return!e.equals(t)}},{key:"minPost",value:function(){return Ue.MIN}},{key:"maxPost",value:function(){return Ue.MAX}},{key:"makePost",value:function(e,t){var n=vt(e);return new Ue(t,n)}},{key:"toString",value:function(){return".value"}}]),n}(ze),kt=new mt,Ct="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */yt=0,_t=[];
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function wt(e){return{type:"value",snapshotNode:e}}function bt(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function xt(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function Et(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var St=function(){"use strict";function e(t){i.classCallCheck(this,e),this.index_=t}return i.createClass(e,[{key:"updateChild",value:function(e,t,n,r,i,o){l.assert(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=e.getImmediateChild(t);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()===n.isEmpty()?e:(null!=o&&(n.isEmpty()?e.hasChild(t)?o.trackChildChange(xt(t,a)):l.assert(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(bt(t,n)):o.trackChildChange(Et(t,n,a))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}},{key:"updateFullNode",value:function(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(st,(function(e,r){t.hasChild(e)||n.trackChildChange(xt(e,r))})),t.isLeafNode()||t.forEachChild(st,(function(t,r){if(e.hasChild(t)){var i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(Et(t,r,i))}else n.trackChildChange(bt(t,r))}))),t.withIndex(this.index_)}},{key:"updatePriority",value:function(e,t){return e.isEmpty()?dt.EMPTY_NODE:e.updatePriority(t)}},{key:"filtersNodes",value:function(){return!1}},{key:"getIndexedFilter",value:function(){return this}},{key:"getIndex",value:function(){return this.index_}}]),e}(),It=function(){"use strict";function e(t){i.classCallCheck(this,e),this.indexedFilter_=new St(t.getIndex()),this.index_=t.getIndex(),this.startPost_=e.getStartPost_(t),this.endPost_=e.getEndPost_(t)}return i.createClass(e,[{key:"getStartPost",value:function(){return this.startPost_}},{key:"getEndPost",value:function(){return this.endPost_}},{key:"matches",value:function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}},{key:"updateChild",value:function(e,t,n,r,i,o){return this.matches(new Ue(t,n))||(n=dt.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,o)}},{key:"updateFullNode",value:function(e,t,n){t.isLeafNode()&&(t=dt.EMPTY_NODE);var r=t.withIndex(this.index_);r=r.updatePriority(dt.EMPTY_NODE);var i=this;return t.forEachChild(st,(function(e,t){i.matches(new Ue(e,t))||(r=r.updateImmediateChild(e,dt.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}},{key:"updatePriority",value:function(e,t){return e}},{key:"filtersNodes",value:function(){return!0}},{key:"getIndexedFilter",value:function(){return this.indexedFilter_}},{key:"getIndex",value:function(){return this.index_}}],[{key:"getStartPost_",value:function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}},{key:"getEndPost_",value:function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}]),e}(),Tt=function(){"use strict";function e(t){i.classCallCheck(this,e),this.rangedFilter_=new It(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return i.createClass(e,[{key:"updateChild",value:function(e,t,n,r,i,o){return this.rangedFilter_.matches(new Ue(t,n))||(n=dt.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,o):this.fullLimitUpdateChild_(e,t,n,i,o)}},{key:"updateFullNode",value:function(e,t,n){var r;if(t.isLeafNode()||t.isEmpty())r=dt.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){var i;r=dt.EMPTY_NODE.withIndex(this.index_),i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(a.name,a.node),o++}}else{var s,u,l,c;if(r=(r=t.withIndex(this.index_)).updatePriority(dt.EMPTY_NODE),this.reverse_){c=r.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var h=this.index_.getCompare();l=function(e,t){return h(t,e)}}else c=r.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),l=this.index_.getCompare();for(var f=0,d=!1;c.hasNext();){var p=c.getNext();!d&&l(s,p)<=0&&(d=!0),d&&f<this.limit_&&l(p,u)<=0?f++:r=r.updateImmediateChild(p.name,dt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}},{key:"updatePriority",value:function(e,t){return e}},{key:"filtersNodes",value:function(){return!0}},{key:"getIndexedFilter",value:function(){return this.rangedFilter_.getIndexedFilter()}},{key:"getIndex",value:function(){return this.index_}},{key:"fullLimitUpdateChild_",value:function(e,t,n,r,i){var o;if(this.reverse_){var a=this.index_.getCompare();o=function(e,t){return a(t,e)}}else o=this.index_.getCompare();var s=e;l.assert(s.numChildren()===this.limit_,"");var u=new Ue(t,n),c=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),h=this.rangedFilter_.matches(u);if(s.hasChild(t)){for(var f=s.getImmediateChild(t),d=r.getChildAfterChild(this.index_,c,this.reverse_);null!=d&&(d.name===t||s.hasChild(d.name));)d=r.getChildAfterChild(this.index_,d,this.reverse_);var p=null==d?1:o(d,u);if(h&&!n.isEmpty()&&p>=0)return null!=i&&i.trackChildChange(Et(t,n,f)),s.updateImmediateChild(t,n);null!=i&&i.trackChildChange(xt(t,f));var v=s.updateImmediateChild(t,dt.EMPTY_NODE);return null!=d&&this.rangedFilter_.matches(d)?(null!=i&&i.trackChildChange(bt(d.name,d.node)),v.updateImmediateChild(d.name,d.node)):v}return n.isEmpty()?e:h&&o(c,u)>=0?(null!=i&&(i.trackChildChange(xt(c.name,c.node)),i.trackChildChange(bt(t,n))),s.updateImmediateChild(t,n).updateImmediateChild(c.name,dt.EMPTY_NODE)):e}}]),e}(),Nt=function(){"use strict";function e(){i.classCallCheck(this,e),this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=st}return i.createClass(e,[{key:"hasStart",value:function(){return this.startSet_}},{key:"hasStartAfter",value:function(){return this.startAfterSet_}},{key:"hasEndBefore",value:function(){return this.endBeforeSet_}},{key:"isViewFromLeft",value:function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}},{key:"getIndexStartValue",value:function(){return l.assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}},{key:"getIndexStartName",value:function(){return l.assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:A}},{key:"hasEnd",value:function(){return this.endSet_}},{key:"getIndexEndValue",value:function(){return l.assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}},{key:"getIndexEndName",value:function(){return l.assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:L}},{key:"hasLimit",value:function(){return this.limitSet_}},{key:"hasAnchoredLimit",value:function(){return this.limitSet_&&""!==this.viewFrom_}},{key:"getLimit",value:function(){return l.assert(this.limitSet_,"Only valid if limit has been set"),this.limit_}},{key:"getIndex",value:function(){return this.index_}},{key:"loadsAllData",value:function(){return!(this.startSet_||this.endSet_||this.limitSet_)}},{key:"isDefault",value:function(){return this.loadsAllData()&&this.index_===st}},{key:"copy",value:function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}]),e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pt(e){var t,n={};return e.isDefault()||(e.index_===st?t="$priority":e.index_===kt?t="$value":e.index_===Be?t="$key":(l.assert(e.index_ instanceof gt,"Unrecognized index type!"),t=e.index_.toString()),n.orderBy=l.stringify(t),e.startSet_&&(n.startAt=l.stringify(e.indexStartValue_),e.startNameSet_&&(n.startAt+=","+l.stringify(e.indexStartName_))),e.endSet_&&(n.endAt=l.stringify(e.indexEndValue_),e.endNameSet_&&(n.endAt+=","+l.stringify(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?n.limitToFirst=e.limit_:n.limitToLast=e.limit_)),n}function Ot(e){var t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;var n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==st&&(t.i=e.index_.toString()),t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rt=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e,r,o,a){var s;return i.classCallCheck(this,n),(s=t.call(this)).repoInfo_=e,s.onDataUpdate_=r,s.authTokenProvider_=o,s.appCheckTokenProvider_=a,s.log_=N("p:rest:"),s.listens_={},s}return i.createClass(n,[{key:"reportStats",value:function(e){throw new Error("Method not implemented.")}},{key:"listen",value:function(e,t,r,i){var o=this,a=e._path.toString();this.log_("Listen called for "+a+" "+e._queryIdentifier);var s=n.getListenId_(e,r),u={};this.listens_[s]=u;var c=Pt(e._queryParams);this.restRequest_(a+".json",c,(function(e,t){var n=t;(404===e&&(n=null,e=null),null===e&&o.onDataUpdate_(a,n,!1,r),l.safeGet(o.listens_,s)===u)&&i(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)}))}},{key:"unlisten",value:function(e,t){var r=n.getListenId_(e,t);delete this.listens_[r]}},{key:"get",value:function(e){var t=this,n=Pt(e._queryParams),r=e._path.toString(),i=new l.Deferred;return this.restRequest_(r+".json",n,(function(e,n){var o=n;404===e&&(o=null,e=null),null===e?(t.onDataUpdate_(r,o,!1,null),i.resolve(o)):i.reject(new Error(o))})),i.promise}},{key:"refreshAuthToken",value:function(e){}},{key:"restRequest_",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=this;return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((function(o){var a=i.slicedToArray(o,2),s=a[0],u=a[1],c=r;s&&s.accessToken&&(t.auth=s.accessToken),u&&u.token&&(t.ac=u.token);var h=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+e+"?ns="+r.repoInfo_.namespace+l.querystring(t);r.log_("Sending REST request for "+h);var f=new XMLHttpRequest;f.onreadystatechange=function(){if(n&&4===f.readyState){c.log_("REST Response for "+h+" received. status:",f.status,"response:",f.responseText);var e=null;if(f.status>=200&&f.status<300){try{e=l.jsonEval(f.responseText)}catch(e){R("Failed to parse JSON response for "+h+": "+f.responseText)}n(null,e)}else 401!==f.status&&404!==f.status&&R("Got unsuccessful REST response for "+h+" Status: "+f.status),n(f.status);n=null}},f.open("GET",h,!0),f.send()}))}}],[{key:"getListenId_",value:function(e,t){return void 0!==t?"tag$"+t:(l.assert(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}}]),n}(_e),Dt=function(){"use strict";function e(){i.classCallCheck(this,e),this.rootNode_=dt.EMPTY_NODE}return i.createClass(e,[{key:"getNode",value:function(e){return this.rootNode_.getChild(e)}},{key:"updateSnapshot",value:function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}]),e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function At(){return{value:null,children:new Map}}function Lt(e,t,n){if(Ne(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{var r=we(t);e.children.has(r)||e.children.set(r,At()),Lt(e.children.get(r),t=xe(t),n)}}function Mt(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach((function(e,n){t(n,e)}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,(function(e,r){Mt(r,new ke(t.toString()+"/"+e),n)}))}var Ft,jt,qt=function(){"use strict";function e(t){i.classCallCheck(this,e),this.collection_=t,this.last_=null}return i.createClass(e,[{key:"get",value:function(){var e=this.collection_.get(),t=Object.assign({},e);return this.last_&&U(this.last_,(function(e,n){t[e]=t[e]-n})),this.last_=e,t}}]),e}(),Wt=function(){"use strict";function e(t,n){i.classCallCheck(this,e),this.server_=n,this.statsToReport_={},this.statsListener_=new qt(t);var r=1e4+2e4*Math.random();K(this.reportStats_.bind(this),Math.floor(r))}return i.createClass(e,[{key:"reportStats_",value:function(){var e=this,t=this.statsListener_.get(),n={},r=!1;U(t,(function(t,i){i>0&&l.contains(e.statsToReport_,t)&&(n[t]=i,r=!0)})),r&&this.server_.reportStats(n),K(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}]),e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ut(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(jt=Ft||(Ft={}))[jt.OVERWRITE=0]="OVERWRITE",jt[jt.MERGE=1]="MERGE",jt[jt.ACK_USER_WRITE=2]="ACK_USER_WRITE",jt[jt.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";var zt,Ht=function(){"use strict";function e(t,n,r){i.classCallCheck(this,e),this.path=t,this.affectedTree=n,this.revert=r,this.type=Ft.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return i.createClass(e,[{key:"operationForChild",value:function(t){if(Ne(this.path)){if(null!=this.affectedTree.value)return l.assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new ke(t));return new e(Ce(),n,this.revert)}return l.assert(we(this.path)===t,"operationForChild called for unrelated child."),new e(xe(this.path),this.affectedTree,this.revert)}}]),e}(),Bt=function(){"use strict";function e(t,n,r){i.classCallCheck(this,e),this.source=t,this.path=n,this.snap=r,this.type=Ft.OVERWRITE}return i.createClass(e,[{key:"operationForChild",value:function(t){return Ne(this.path)?new e(this.source,Ce(),this.snap.getImmediateChild(t)):new e(this.source,xe(this.path),this.snap)}}]),e}(),Vt=function(){"use strict";function e(t,n,r){i.classCallCheck(this,e),this.source=t,this.path=n,this.children=r,this.type=Ft.MERGE}return i.createClass(e,[{key:"operationForChild",value:function(t){if(Ne(this.path)){var n=this.children.subtree(new ke(t));return n.isEmpty()?null:n.value?new Bt(this.source,Ce(),n.value):new e(this.source,Ce(),n)}return l.assert(we(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,xe(this.path),this.children)}},{key:"toString",value:function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}]),e}(),Gt=function(){"use strict";function e(t,n,r){i.classCallCheck(this,e),this.node_=t,this.fullyInitialized_=n,this.filtered_=r}return i.createClass(e,[{key:"isFullyInitialized",value:function(){return this.fullyInitialized_}},{key:"isFiltered",value:function(){return this.filtered_}},{key:"isCompleteForPath",value:function(e){if(Ne(e))return this.isFullyInitialized()&&!this.filtered_;var t=we(e);return this.isCompleteForChild(t)}},{key:"isCompleteForChild",value:function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}},{key:"getNode",value:function(){return this.node_}}]),e}(),Yt=function e(t){"use strict";i.classCallCheck(this,e),this.query_=t,this.index_=this.query_._queryParams.getIndex()};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kt(e,t,n,r,i,o){var a=r.filter((function(e){return e.type===n}));a.sort((function(t,n){return function(e,t,n){if(null==t.childName||null==n.childName)throw l.assertionError("Should only compare child_ events.");var r=new Ue(t.childName,t.snapshotNode),i=new Ue(n.childName,n.snapshotNode);return e.index_.compare(r,i)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,t,n)})),a.forEach((function(n){var r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,o);i.forEach((function(i){i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function Qt(e,t){return{eventCache:e,serverCache:t}}function Jt(e,t,n,r){return Qt(new Gt(t,n,r),e.serverCache)}function Xt(e,t,n,r){return Qt(e.eventCache,new Gt(t,n,r))}function $t(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Zt(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var en=function(){return zt||(zt=new Qe(F)),zt},tn=function(){"use strict";function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:en();i.classCallCheck(this,e),this.value=t,this.children=n}return i.createClass(e,[{key:"isEmpty",value:function(){return null===this.value&&this.children.isEmpty()}},{key:"findRootMostMatchingPathAndValue",value:function(e,t){if(null!=this.value&&t(this.value))return{path:Ce(),value:this.value};if(Ne(e))return null;var n=we(e),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(xe(e),t);return null!=i?{path:Te(new ke(n),i.path),value:i.value}:null}return null}},{key:"findRootMostValueAndPath",value:function(e){return this.findRootMostMatchingPathAndValue(e,(function(){return!0}))}},{key:"subtree",value:function(t){if(Ne(t))return this;var n=we(t),r=this.children.get(n);return null!==r?r.subtree(xe(t)):new e(null)}},{key:"set",value:function(t,n){if(Ne(t))return new e(n,this.children);var r=we(t),i=(this.children.get(r)||new e(null)).set(xe(t),n),o=this.children.insert(r,i);return new e(this.value,o)}},{key:"remove",value:function(t){if(Ne(t))return this.children.isEmpty()?new e(null):new e(null,this.children);var n=we(t),r=this.children.get(n);if(r){var i,o=r.remove(xe(t));return i=o.isEmpty()?this.children.remove(n):this.children.insert(n,o),null===this.value&&i.isEmpty()?new e(null):new e(this.value,i)}return this}},{key:"get",value:function(e){if(Ne(e))return this.value;var t=we(e),n=this.children.get(t);return n?n.get(xe(e)):null}},{key:"setTree",value:function(t,n){if(Ne(t))return n;var r,i=we(t),o=(this.children.get(i)||new e(null)).setTree(xe(t),n);return r=o.isEmpty()?this.children.remove(i):this.children.insert(i,o),new e(this.value,r)}},{key:"fold",value:function(e){return this.fold_(Ce(),e)}},{key:"fold_",value:function(e,t){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(Te(e,r),t)})),t(e,this.value,n)}},{key:"findOnPath",value:function(e,t){return this.findOnPath_(e,Ce(),t)}},{key:"findOnPath_",value:function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(Ne(e))return null;var i=we(e),o=this.children.get(i);return o?o.findOnPath_(xe(e),Te(t,i),n):null}},{key:"foreachOnPath",value:function(e,t){return this.foreachOnPath_(e,Ce(),t)}},{key:"foreachOnPath_",value:function(t,n,r){if(Ne(t))return this;this.value&&r(n,this.value);var i=we(t),o=this.children.get(i);return o?o.foreachOnPath_(xe(t),Te(n,i),r):new e(null)}},{key:"foreach",value:function(e){this.foreach_(Ce(),e)}},{key:"foreach_",value:function(e,t){this.children.inorderTraversal((function(n,r){r.foreach_(Te(e,n),t)})),this.value&&t(e,this.value)}},{key:"foreachChild",value:function(e){this.children.inorderTraversal((function(t,n){n.value&&e(t,n.value)}))}}],[{key:"fromObject",value:function(t){var n=new e(null);return U(t,(function(e,t){n=n.set(new ke(e),t)})),n}}]),e}(),nn=function(){"use strict";function e(t){i.classCallCheck(this,e),this.writeTree_=t}return i.createClass(e,null,[{key:"empty",value:function(){return new e(new tn(null))}}]),e}();function rn(e,t,n){if(Ne(t))return new nn(new tn(n));var r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){var i=r.path,o=r.value,a=Pe(i,t);return o=o.updateChild(a,n),new nn(e.writeTree_.set(i,o))}var s=new tn(n),u=e.writeTree_.setTree(t,s);return new nn(u)}function on(e,t,n){var r=e;return U(n,(function(e,n){r=rn(r,Te(t,e),n)})),r}function an(e,t){if(Ne(t))return nn.empty();var n=e.writeTree_.setTree(t,new tn(null));return new nn(n)}function sn(e,t){return null!=un(e,t)}function un(e,t){var n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(Pe(n.path,t)):null}function ln(e){var t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(st,(function(e,n){t.push(new Ue(e,n))})):e.writeTree_.children.inorderTraversal((function(e,n){null!=n.value&&t.push(new Ue(e,n.value))})),t}function cn(e,t){if(Ne(t))return e;var n=un(e,t);return new nn(null!=n?new tn(n):e.writeTree_.subtree(t))}function hn(e){return e.writeTree_.isEmpty()}function fn(e,t){return dn(Ce(),e.writeTree_,t)}function dn(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);var r=null;return t.children.inorderTraversal((function(t,i){".priority"===t?(l.assert(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=dn(Te(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(Te(e,".priority"),r)),n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(e,t){return Tn(t,e)}function vn(e,t){for(var n=0;n<e.allWrites.length;n++){var r=e.allWrites[n];if(r.writeId===t)return r}return null}function yn(e,t){var n=e.allWrites.findIndex((function(e){return e.writeId===t}));l.assert(n>=0,"removeWrite called with nonexistent writeId.");var r=e.allWrites[n];e.allWrites.splice(n,1);for(var i=r.visible,o=!1,a=e.allWrites.length-1;i&&a>=0;){var s=e.allWrites[a];s.visible&&(a>=n&&_n(s,r.path)?i=!1:De(r.path,s.path)&&(o=!0)),a--}if(i){if(o)return function(e){e.visibleWrites=mn(e.allWrites,gn,Ce()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;r.snap?e.visibleWrites=an(e.visibleWrites,r.path):U(r.children,(function(t){e.visibleWrites=an(e.visibleWrites,Te(r.path,t))}));return!0}return!1}function _n(e,t){if(e.snap)return De(e.path,t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&De(Te(e.path,n),t))return!0;return!1}function gn(e){return e.visible}function mn(e,t,n){for(var r=nn.empty(),i=0;i<e.length;++i){var o=e[i];if(t(o)){var a=o.path,s=void 0;if(o.snap)De(n,a)?r=rn(r,s=Pe(n,a),o.snap):De(a,n)&&(s=Pe(a,n),r=rn(r,Ce(),o.snap.getChild(s)));else{if(!o.children)throw l.assertionError("WriteRecord should have .snap or .children");if(De(n,a))r=on(r,s=Pe(n,a),o.children);else if(De(a,n))if(Ne(s=Pe(a,n)))r=on(r,Ce(),o.children);else{var u=l.safeGet(o.children,we(s));if(u){var c=u.getChild(xe(s));r=rn(r,Ce(),c)}}}}}return r}function kn(e,t,n,r,i){if(r||i){var o=cn(e.visibleWrites,t);if(!i&&hn(o))return n;if(i||null!=n||sn(o,Ce())){return fn(mn(e.allWrites,(function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(De(e.path,t)||De(t,e.path))}),t),n||dt.EMPTY_NODE)}return null}var a=un(e.visibleWrites,t);if(null!=a)return a;var s=cn(e.visibleWrites,t);return hn(s)?n:null!=n||sn(s,Ce())?fn(s,n||dt.EMPTY_NODE):null}function Cn(e,t,n,r){return kn(e.writeTree,e.treePath,t,n,r)}function wn(e,t){return function(e,t,n){var r=dt.EMPTY_NODE,i=un(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(st,(function(e,t){r=r.updateImmediateChild(e,t)})),r;if(n){var o=cn(e.visibleWrites,t);return n.forEachChild(st,(function(e,t){var n=fn(cn(o,new ke(e)),t);r=r.updateImmediateChild(e,n)})),ln(o).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}return ln(cn(e.visibleWrites,t)).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function bn(e,t,n,r){return function(e,t,n,r,i){l.assert(r||i,"Either existingEventSnap or existingServerSnap must exist");var o=Te(t,n);if(sn(e.visibleWrites,o))return null;var a=cn(e.visibleWrites,o);return hn(a)?i.getChild(n):fn(a,i.getChild(n))}(e.writeTree,e.treePath,t,n,r)}function xn(e,t){return function(e,t){return un(e.visibleWrites,t)}(e.writeTree,Te(e.treePath,t))}function En(e,t,n,r,i,o){return function(e,t,n,r,i,o,a){var s,u=cn(e.visibleWrites,t),l=un(u,Ce());if(null!=l)s=l;else{if(null==n)return[];s=fn(u,n)}if((s=s.withIndex(a)).isEmpty()||s.isLeafNode())return[];for(var c=[],h=a.getCompare(),f=o?s.getReverseIteratorFrom(r,a):s.getIteratorFrom(r,a),d=f.getNext();d&&c.length<i;)0!==h(d,r)&&c.push(d),d=f.getNext();return c}(e.writeTree,e.treePath,t,n,r,i,o)}function Sn(e,t,n){return function(e,t,n,r){var i=Te(t,n),o=un(e.visibleWrites,i);return null!=o?o:r.isCompleteForChild(n)?fn(cn(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function In(e,t){return Tn(Te(e.treePath,t),e.writeTree)}function Tn(e,t){return{treePath:e,writeTree:t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nn=function(){"use strict";function e(){i.classCallCheck(this,e),this.changeMap=new Map}return i.createClass(e,[{key:"trackChildChange",value:function(e){var t=e.type,n=e.childName;l.assert("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),l.assert(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,Et(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,xt(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,bt(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw l.assertionError("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,Et(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}},{key:"getChanges",value:function(){return Array.from(this.changeMap.values())}}]),e}(),Pn=new(function(){"use strict";function e(){i.classCallCheck(this,e)}return i.createClass(e,[{key:"getCompleteChild",value:function(e){return null}},{key:"getChildAfterChild",value:function(e,t,n){return null}}]),e}()),On=function(){"use strict";function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;i.classCallCheck(this,e),this.writes_=t,this.viewCache_=n,this.optCompleteServerCache_=r}return i.createClass(e,[{key:"getCompleteChild",value:function(e){var t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new Gt(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Sn(this.writes_,e,n)}},{key:"getChildAfterChild",value:function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Zt(this.viewCache_),i=En(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}]),e}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rn(e,t,n,r,i){var o,a,s=new Nn;if(n.type===Ft.OVERWRITE){var u=n;u.source.fromUser?o=Ln(e,t,u.path,u.snap,r,i,s):(l.assert(u.source.fromServer,"Unknown source."),a=u.source.tagged||t.serverCache.isFiltered()&&!Ne(u.path),o=An(e,t,u.path,u.snap,r,i,a,s))}else if(n.type===Ft.MERGE){var c=n;c.source.fromUser?o=function(e,t,n,r,i,o,a){var s=t;return r.foreach((function(r,u){var l=Te(n,r);Mn(t,we(l))&&(s=Ln(e,s,l,u,i,o,a))})),r.foreach((function(r,u){var l=Te(n,r);Mn(t,we(l))||(s=Ln(e,s,l,u,i,o,a))})),s}(e,t,c.path,c.children,r,i,s):(l.assert(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered(),o=jn(e,t,c.path,c.children,r,i,a,s))}else if(n.type===Ft.ACK_USER_WRITE){var h=n;o=h.revert?function(e,t,n,r,i,o){var a;if(null!=xn(r,n))return t;var s,u=new On(r,t,i),c=t.eventCache.getNode();if(Ne(n)||".priority"===we(n)){var h;if(t.serverCache.isFullyInitialized())h=Cn(r,Zt(t));else{var f=t.serverCache.getNode();l.assert(f instanceof dt,"serverChildren would be complete if leaf node"),h=wn(r,f)}s=e.filter.updateFullNode(c,h,o)}else{var d=we(n),p=Sn(r,d,t.serverCache);null==p&&t.serverCache.isCompleteForChild(d)&&(p=c.getImmediateChild(d)),(s=null!=p?e.filter.updateChild(c,d,p,xe(n),u,o):t.eventCache.getNode().hasChild(d)?e.filter.updateChild(c,d,dt.EMPTY_NODE,xe(n),u,o):c).isEmpty()&&t.serverCache.isFullyInitialized()&&(a=Cn(r,Zt(t))).isLeafNode()&&(s=e.filter.updateFullNode(s,a,o))}return a=t.serverCache.isFullyInitialized()||null!=xn(r,Ce()),Jt(t,s,a,e.filter.filtersNodes())}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,t,h.path,r,i,s):function(e,t,n,r,i,o,a){if(null!=xn(i,n))return t;var s=t.serverCache.isFiltered(),u=t.serverCache;if(null!=r.value){if(Ne(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return An(e,t,n,u.getNode().getChild(n),i,o,s,a);if(Ne(n)){var l=new tn(null);return u.getNode().forEachChild(Be,(function(e,t){l=l.set(new ke(e),t)})),jn(e,t,n,l,i,o,s,a)}return t}var c=new tn(null);return r.foreach((function(e,t){var r=Te(n,e);u.isCompleteForPath(r)&&(c=c.set(e,u.getNode().getChild(r)))})),jn(e,t,n,c,i,o,s,a)}(e,t,h.path,h.affectedTree,r,i,s)}else{if(n.type!==Ft.LISTEN_COMPLETE)throw l.assertionError("Unknown operation type: "+n.type);o=function(e,t,n,r,i){var o=t.serverCache,a=Xt(t,o.getNode(),o.isFullyInitialized()||Ne(n),o.isFiltered());return Dn(e,a,n,r,Pn,i)}(e,t,n.path,r,s)}var f=s.getChanges();return function(e,t,n){var r=t.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=$t(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(wt($t(t)))}}(t,o,f),{viewCache:o,changes:f}}function Dn(e,t,n,r,i,o){var a,s,u=t.eventCache;if(null!=xn(r,n))return t;if(Ne(n))if(l.assert(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){var c=Zt(t),h=wn(r,c instanceof dt?c:dt.EMPTY_NODE);a=e.filter.updateFullNode(t.eventCache.getNode(),h,o)}else{var f=Cn(r,Zt(t));a=e.filter.updateFullNode(t.eventCache.getNode(),f,o)}else{var d=we(n);if(".priority"===d){l.assert(1===be(n),"Can't have a priority with additional path components");var p=u.getNode(),v=bn(r,n,p,s=t.serverCache.getNode());a=null!=v?e.filter.updatePriority(p,v):u.getNode()}else{var y,_=xe(n);if(u.isCompleteForChild(d)){s=t.serverCache.getNode();var g=bn(r,n,u.getNode(),s);y=null!=g?u.getNode().getImmediateChild(d).updateChild(_,g):u.getNode().getImmediateChild(d)}else y=Sn(r,d,t.serverCache);a=null!=y?e.filter.updateChild(u.getNode(),d,y,_,i,o):u.getNode()}}return Jt(t,a,u.isFullyInitialized()||Ne(n),e.filter.filtersNodes())}function An(e,t,n,r,i,o,a,s){var u,l=t.serverCache,c=a?e.filter:e.filter.getIndexedFilter();if(Ne(n))u=c.updateFullNode(l.getNode(),r,null);else if(c.filtersNodes()&&!l.isFiltered()){var h=l.getNode().updateChild(n,r);u=c.updateFullNode(l.getNode(),h,null)}else{var f=we(n);if(!l.isCompleteForPath(n)&&be(n)>1)return t;var d=xe(n),p=l.getNode().getImmediateChild(f).updateChild(d,r);u=".priority"===f?c.updatePriority(l.getNode(),p):c.updateChild(l.getNode(),f,p,d,Pn,null)}var v=Xt(t,u,l.isFullyInitialized()||Ne(n),c.filtersNodes());return Dn(e,v,n,i,new On(i,v,o),s)}function Ln(e,t,n,r,i,o,a){var s,u,l=t.eventCache,c=new On(i,t,o);if(Ne(n))u=e.filter.updateFullNode(t.eventCache.getNode(),r,a),s=Jt(t,u,!0,e.filter.filtersNodes());else{var h=we(n);if(".priority"===h)u=e.filter.updatePriority(t.eventCache.getNode(),r),s=Jt(t,u,l.isFullyInitialized(),l.isFiltered());else{var f,d=xe(n),p=l.getNode().getImmediateChild(h);if(Ne(d))f=r;else{var v=c.getCompleteChild(h);f=null!=v?".priority"===Ee(d)&&v.getChild(Ie(d)).isEmpty()?v:v.updateChild(d,r):dt.EMPTY_NODE}if(p.equals(f))s=t;else s=Jt(t,e.filter.updateChild(l.getNode(),h,f,d,c,a),l.isFullyInitialized(),e.filter.filtersNodes())}}return s}function Mn(e,t){return e.eventCache.isCompleteForChild(t)}function Fn(e,t,n){return n.foreach((function(e,n){t=t.updateChild(e,n)})),t}function jn(e,t,n,r,i,o,a,s){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;var u,l=t;u=Ne(n)?r:new tn(null).setTree(n,r);var c=t.serverCache.getNode();return u.children.inorderTraversal((function(n,r){if(c.hasChild(n)){var u=Fn(0,t.serverCache.getNode().getImmediateChild(n),r);l=An(e,l,new ke(n),u,i,o,a,s)}})),u.children.inorderTraversal((function(n,r){var u=!t.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!c.hasChild(n)&&!u){var h=Fn(0,t.serverCache.getNode().getImmediateChild(n),r);l=An(e,l,new ke(n),h,i,o,a,s)}})),l}var qn,Wn=function(){"use strict";function e(t,n){i.classCallCheck(this,e),this.query_=t,this.eventRegistrations_=[];var r,o=this.query_._queryParams,a=new St(o.getIndex()),s=(r=o).loadsAllData()?new St(r.getIndex()):r.hasLimit()?new Tt(r):new It(r);this.processor_=
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function(e){return{filter:e}}(s);var u=n.serverCache,l=n.eventCache,c=a.updateFullNode(dt.EMPTY_NODE,u.getNode(),null),h=s.updateFullNode(dt.EMPTY_NODE,l.getNode(),null),f=new Gt(c,u.isFullyInitialized(),a.filtersNodes()),d=new Gt(h,l.isFullyInitialized(),s.filtersNodes());this.viewCache_=Qt(d,f),this.eventGenerator_=new Yt(this.query_)}return i.createClass(e,[{key:"query",get:function(){return this.query_}}]),e}();function Un(e,t){var n=Zt(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!Ne(t)&&!n.getImmediateChild(we(t)).isEmpty())?n.getChild(t):null}function zn(e,t,n,r){t.type===Ft.MERGE&&null!==t.source.queryId&&(l.assert(Zt(e.viewCache_),"We should always have a full cache before handling merges"),l.assert($t(e.viewCache_),"Missing event cache, even though we have a server cache"));var i,o,a=e.viewCache_,s=Rn(e.processor_,a,t,n,r);return i=e.processor_,o=s.viewCache,l.assert(o.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),l.assert(o.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed"),l.assert(s.viewCache.serverCache.isFullyInitialized()||!a.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,Hn(e,s.changes,s.viewCache.eventCache.getNode(),null)}function Hn(e,t,n,r){var i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){var i=[],o=[];return t.forEach((function(t){var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),Kt(e,i,"child_removed",t,r,n),Kt(e,i,"child_added",t,r,n),Kt(e,i,"child_moved",o,r,n),Kt(e,i,"child_changed",t,r,n),Kt(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bn,Vn=function e(){"use strict";i.classCallCheck(this,e),this.views=new Map};function Gn(e,t,n,r){var i=t.source.queryId;if(null!==i){var o=e.views.get(i);return l.assert(null!=o,"SyncTree gave us an op for an invalid query."),zn(o,t,n,r)}var a=[],s=!0,u=!1,c=void 0;try{for(var h,f=e.views.values()[Symbol.iterator]();!(s=(h=f.next()).done);s=!0){var d=h.value;a=a.concat(zn(d,t,n,r))}}catch(e){u=!0,c=e}finally{try{s||null==f.return||f.return()}finally{if(u)throw c}}return a}function Yn(e,t,n,r,i){var o=t._queryIdentifier,a=e.views.get(o);if(!a){var s=Cn(n,i?r:null),u=!1;s?u=!0:r instanceof dt?(s=wn(n,r),u=!1):(s=dt.EMPTY_NODE,u=!1);var l=Qt(new Gt(s,u,!1),new Gt(r,i,!1));return new Wn(t,l)}return a}function Kn(e,t){var n=null,r=!0,i=!1,o=void 0;try{for(var a,s=e.views.values()[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var u=a.value;n=n||Un(u,t)}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}var Qn=function e(t){"use strict";i.classCallCheck(this,e),this.listenProvider_=t,this.syncPointTree_=new tn(null),this.pendingWriteTree_={visibleWrites:nn.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map};function Jn(e,t,n,r,i){return function(e,t,n,r,i){l.assert(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=rn(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?nr(e,new Bt({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function Xn(e,t,n,r){!function(e,t,n,r){l.assert(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=on(e.visibleWrites,t,n),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r);var i=tn.fromObject(n);return nr(e,new Vt({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,i))}function $n(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=vn(e.pendingWriteTree_,t),i=yn(e.pendingWriteTree_,t);if(i){var o=new tn(null);return null!=r.snap?o=o.set(Ce(),!0):U(r.children,(function(e){o=o.set(new ke(e),!0)})),nr(e,new Ht(r.path,o,n))}return[]}function Zn(e,t,n){return nr(e,new Bt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function er(e,t,n){var r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,(function(e,n){var r=Kn(n,Pe(e,t));if(r)return r}));return kn(r,t,i,n,!0)}function tr(e,t){var n=t._path,r=null;e.syncPointTree_.foreachOnPath(n,(function(e,t){var i=Pe(e,n);r=r||Kn(t,i)}));var i=e.syncPointTree_.get(n);i?r=r||Kn(i,Ce()):(i=new Vn,e.syncPointTree_=e.syncPointTree_.set(n,i));var o=null!=r,a=o?new Gt(r,!0,!1):null;return function(e){return $t(e.viewCache_)}(Yn(i,t,pn(e.pendingWriteTree_,t._path),o?a.getNode():dt.EMPTY_NODE,o))}function nr(e,t){return rr(t,e.syncPointTree_,null,pn(e.pendingWriteTree_,Ce()))}function rr(e,t,n,r){if(Ne(e.path))return ir(e,t,n,r);var i=t.get(Ce());null==n&&null!=i&&(n=Kn(i,Ce()));var o=[],a=we(e.path),s=e.operationForChild(a),u=t.children.get(a);if(u&&s){var l=n?n.getImmediateChild(a):null,c=In(r,a);o=o.concat(rr(s,u,l,c))}return i&&(o=o.concat(Gn(i,e,r,n))),o}function ir(e,t,n,r){var i=t.get(Ce());null==n&&null!=i&&(n=Kn(i,Ce()));var o=[];return t.children.inorderTraversal((function(t,i){var a=n?n.getImmediateChild(t):null,s=In(r,t),u=e.operationForChild(t);u&&(o=o.concat(ir(u,i,a,s)))})),i&&(o=o.concat(Gn(i,e,r,n))),o}function or(e,t){return e.tagToQueryMap.get(t)}function ar(e){var t=e.indexOf("$");return l.assert(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new ke(e.substr(0,t))}}function sr(e,t,n){var r=e.syncPointTree_.get(t);return l.assert(r,"Missing sync point for query tag that we're tracking"),Gn(r,n,pn(e.pendingWriteTree_,t),null)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var ur=function(){"use strict";function e(t){i.classCallCheck(this,e),this.node_=t}return i.createClass(e,[{key:"getImmediateChild",value:function(t){return new e(this.node_.getImmediateChild(t))}},{key:"node",value:function(){return this.node_}}]),e}(),lr=function(){"use strict";function e(t,n){i.classCallCheck(this,e),this.syncTree_=t,this.path_=n}return i.createClass(e,[{key:"getImmediateChild",value:function(t){var n=Te(this.path_,t);return new e(this.syncTree_,n)}},{key:"node",value:function(){return er(this.syncTree_,this.path_)}}]),e}(),cr=function(e,t,n){return e&&"object"==typeof e?(l.assert(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?hr(e[".sv"],t,n):"object"==typeof e[".sv"]?fr(e[".sv"],t):void l.assert(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},hr=function(e,t,n){if("timestamp"===e)return n.timestamp;l.assert(!1,"Unexpected server value: "+e)},fr=function(e,t,n){e.hasOwnProperty("increment")||l.assert(!1,"Unexpected server value: "+JSON.stringify(e,null,2));var r=e.increment;"number"!=typeof r&&l.assert(!1,"Unexpected increment value: "+r);var i=t.node();if(l.assert(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var o=i.getValue();return"number"!=typeof o?r:o+r},dr=function(e,t,n,r){return vr(t,new lr(n,e),r)},pr=function(e,t,n){return vr(e,new ur(t),n)};function vr(e,t,n){var r,i=e.getPriority().val(),o=cr(i,t.getImmediateChild(".priority"),n);if(e.isLeafNode()){var a=e,s=cr(a.getValue(),t,n);return s!==a.getValue()||o!==a.getPriority().val()?new rt(s,vt(o)):e}var u=e;return r=u,o!==u.getPriority().val()&&(r=r.updatePriority(new rt(o))),u.forEachChild(st,(function(e,i){var o=vr(i,t.getImmediateChild(e),n);o!==i&&(r=r.updateImmediateChild(e,o))})),r}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yr=function e(){"use strict";var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};i.classCallCheck(this,e),this.name=t,this.parent=n,this.node=r};function _r(e,t){for(var n=t instanceof ke?t:new ke(t),r=e,i=we(n);null!==i;){var o=l.safeGet(r.node.children,i)||{children:{},childCount:0};r=new yr(i,r,o),i=we(n=xe(n))}return r}function gr(e){return e.node.value}function mr(e,t){e.node.value=t,xr(e)}function kr(e){return e.node.childCount>0}function Cr(e,t){U(e.node.children,(function(n,r){t(new yr(n,e,r))}))}function wr(e,t,n,r){n&&!r&&t(e),Cr(e,(function(e){wr(e,t,!0,r)})),n&&r&&t(e)}function br(e){return new ke(null===e.parent?e.name:br(e.parent)+"/"+e.name)}function xr(e){null!==e.parent&&function(e,t,n){var r=function(e){return void 0===gr(e)&&!kr(e)}(n),i=l.contains(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,xr(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,xr(e))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e.parent,e.name,e)}var Er=/[\[\].#$\/\u0000-\u001F\u007F]/,Sr=/[\[\].#$\u0000-\u001F\u007F]/,Ir=10485760,Tr=function(e){return"string"==typeof e&&0!==e.length&&!Er.test(e)},Nr=function(e){return"string"==typeof e&&0!==e.length&&!Sr.test(e)},Pr=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!D(e)||e&&"object"==typeof e&&l.contains(e,".sv")},Or=function(e,t,n,r){r&&void 0===t||Rr(l.errorPrefix(e,"value"),t,n)},Rr=function(e,t,n){var r=n instanceof ke?new Ae(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Me(r));if("function"==typeof t)throw new Error(e+"contains a function "+Me(r)+" with contents = "+t.toString());if(D(t))throw new Error(e+"contains "+t.toString()+" "+Me(r));if("string"==typeof t&&t.length>3495253.3333333335&&l.stringLength(t)>Ir)throw new Error(e+"contains a string greater than "+"10485760 utf8 bytes "+Me(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){var i=!1,o=!1;if(U(t,(function(t,n){if(".value"===t)i=!0;else if(".priority"!==t&&".sv"!==t&&(o=!0,!Tr(t)))throw new Error(e+" contains an invalid key ("+t+") "+Me(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var a,s;!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=l.stringLength(t),Le(e)}(r,t),Rr(e,n,r),s=(a=r).parts_.pop(),a.byteLength_-=l.stringLength(s),a.parts_.length>0&&(a.byteLength_-=1)})),i&&o)throw new Error(e+' contains ".value" child '+Me(r)+" in addition to actual children.")}},Dr=function(e,t,n,r){if(!r||void 0!==t){var i=l.errorPrefix(e,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");var o=[];U(t,(function(e,t){var r=new ke(e);if(Rr(i,t,Te(n,r)),".priority"===Ee(r)&&!Pr(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(r)})),function(e,t){var n,r;for(n=0;n<t.length;n++)for(var i=Se(r=t[n]),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!Tr(i[o]))throw new Error(e+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');t.sort(Oe);var a=null;for(n=0;n<t.length;n++){if(r=t[n],null!==a&&De(a,r))throw new Error(e+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}}(i,o)}},Ar=function(e,t,n,r){if(!(r&&void 0===n||Nr(n)))throw new Error(l.errorPrefix(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Lr=function(e,t){if(".info"===we(t))throw new Error(e+" failed = Can't modify data under /.info/")},Mr=function(e,t){var n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!Tr(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Nr(e)}(n))throw new Error(l.errorPrefix(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},Fr=function e(){"use strict";i.classCallCheck(this,e),this.eventLists_=[],this.recursionDepth_=0};function jr(e,t){for(var n=null,r=0;r<t.length;r++){var i=t[r],o=i.getPath();null===n||Re(o,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&e.eventLists_.push(n)}function qr(e,t,n){jr(e,n),Ur(e,(function(e){return Re(e,t)}))}function Wr(e,t,n){jr(e,n),Ur(e,(function(e){return De(e,t)||De(t,e)}))}function Ur(e,t){e.recursionDepth_++;for(var n=!0,r=0;r<e.eventLists_.length;r++){var i=e.eventLists_[r];if(i)t(i.path)?(zr(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}n&&(e.eventLists_=[]),e.recursionDepth_--}function zr(e){for(var t=0;t<e.events.length;t++){var n=e.events[t];if(null!==n){e.events[t]=null;var r=n.getEventRunner();E&&T("event: "+n.toString()),Y(r)}}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Hr="repo_interrupt",Br=function(){"use strict";function e(t,n,r,o){i.classCallCheck(this,e),this.repoInfo_=t,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=o,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Fr,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=At(),this.transactionQueueTree_=new yr,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return i.createClass(e,[{key:"toString",value:function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}]),e}();function Vr(e,t,n){if(e.stats_=se(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new Rt(e.repoInfo_,(function(t,n,r,i){Kr(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((function(){return Qr(e,!0)}),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{l.stringify(n)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new qe(e.repoInfo_,t,(function(t,n,r,i){Kr(e,t,n,r,i)}),(function(t){Qr(e,t)}),(function(t){!function(e,t){U(t,(function(t,n){Jr(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}var r,i,o;e.authTokenProvider_.addTokenChangeListener((function(t){e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((function(t){e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=(r=e.repoInfo_,i=function(){return new Wt(e.stats_,e.server_)},o=r.toString(),ae[o]||(ae[o]=i()),ae[o]),e.infoData_=new Dt,e.infoSyncTree_=new Qn({startListening:function(t,n,r,i){var o=[],a=e.infoData_.getNode(t._path);return a.isEmpty()||(o=Zn(e.infoSyncTree_,t._path,a),setTimeout((function(){i("ok")}),0)),o},stopListening:function(){}}),Jr(e,"connected",!1),e.serverSyncTree_=new Qn({startListening:function(t,n,r,i){return e.server_.listen(t,r,n,(function(n,r){var o=i(n,r);Wr(e.eventQueue_,t._path,o)})),[]},stopListening:function(t,n){e.server_.unlisten(t,n)}})}function Gr(e){var t=e.infoData_.getNode(new ke(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function Yr(e){return(t=(t={timestamp:Gr(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function Kr(e,t,n,r,i){e.dataUpdateCount++;var o=new ke(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;var a=[];if(i)if(r){var s=l.map(n,(function(e){return vt(e)}));a=function(e,t,n,r){var i=or(e,r);if(i){var o=ar(i),a=o.path,s=o.queryId,u=Pe(a,t),l=tn.fromObject(n);return sr(e,a,new Vt(Ut(s),u,l))}return[]}(e.serverSyncTree_,o,s,i)}else{var u=vt(n);a=function(e,t,n,r){var i=or(e,r);if(null!=i){var o=ar(i),a=o.path,s=o.queryId,u=Pe(a,t);return sr(e,a,new Bt(Ut(s),u,n))}return[]}(e.serverSyncTree_,o,u,i)}else if(r){var c=l.map(n,(function(e){return vt(e)}));a=function(e,t,n){var r=tn.fromObject(n);return nr(e,new Vt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,o,c)}else{var h=vt(n);a=Zn(e.serverSyncTree_,o,h)}var f=o;a.length>0&&(f=oi(e,o)),Wr(e.eventQueue_,f,a)}function Qr(e,t){Jr(e,"connected",t),!1===t&&function(e){ei(e,"onDisconnectEvents");var t=Yr(e),n=At();Mt(e.onDisconnect_,Ce(),(function(r,i){var o=dr(r,i,e.serverSyncTree_,t);Lt(n,r,o)}));var r=[];Mt(n,Ce(),(function(t,n){r=r.concat(Zn(e.serverSyncTree_,t,n));var i=ci(e,t);oi(e,i)})),e.onDisconnect_=At(),Wr(e.eventQueue_,Ce(),r)}(e)}function Jr(e,t,n){var r=new ke("/.info/"+t),i=vt(n);e.infoData_.updateSnapshot(r,i);var o=Zn(e.infoSyncTree_,r,i);Wr(e.eventQueue_,r,o)}function Xr(e){return e.nextWriteId_++}function $r(e,t,n,r,i){ei(e,"set",{path:t.toString(),value:n,priority:r});var o=Yr(e),a=vt(n,r),s=er(e.serverSyncTree_,t),u=pr(a,s,o),l=Xr(e),c=Jn(e.serverSyncTree_,t,u,l,!0);jr(e.eventQueue_,c),e.server_.put(t.toString(),a.val(!0),(function(n,r){var o="ok"===n;o||R("set at "+t+" failed: "+n);var a=$n(e.serverSyncTree_,l,!o);Wr(e.eventQueue_,t,a),ti(e,i,n,r)}));var h=ci(e,t);oi(e,h),Wr(e.eventQueue_,h,[])}function Zr(e){e.persistentConnection_&&e.persistentConnection_.interrupt(Hr)}function ei(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o="";e.persistentConnection_&&(o=e.persistentConnection_.id+":"),T.apply(void 0,[o].concat(i.toConsumableArray(n)))}function ti(e,t,n,r){t&&Y((function(){if("ok"===n)t(null);else{var e=(n||"error").toUpperCase(),i=e;r&&(i+=": "+r);var o=new Error(i);o.code=e,t(o)}}))}function ni(e,t,n){return er(e.serverSyncTree_,t,n)||dt.EMPTY_NODE}function ri(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||li(e,t),gr(t)){var n=si(e,t);l.assert(n.length>0,"Sending zero length transaction queue");var r=n.every((function(e){return 0===e.status}));r&&ii(e,br(t),n)}else kr(t)&&Cr(t,(function(t){ri(e,t)}))}function ii(e,t,n){for(var r=n.map((function(e){return e.currentWriteId})),i=ni(e,t,r),o=i,a=i.hash(),s=0;s<n.length;s++){var u=n[s];l.assert(0===u.status,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;var c=Pe(t,u.path);o=o.updateChild(c,u.currentOutputSnapshotRaw)}var h=o.val(!0),f=t;e.server_.put(f.toString(),h,(function(r){ei(e,"transaction put response",{path:f.toString(),status:r});var i=[];if("ok"===r){for(var o=function(t){n[t].status=2,i=i.concat($n(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&a.push((function(){return n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)})),n[t].unwatcher()},a=[],s=0;s<n.length;s++)o(s);li(e,_r(e.transactionQueueTree_,t)),ri(e,e.transactionQueueTree_),Wr(e.eventQueue_,t,i);for(var u=0;u<a.length;u++)Y(a[u])}else{if("datastale"===r)for(var l=0;l<n.length;l++)3===n[l].status?n[l].status=4:n[l].status=0;else{R("transaction at "+f.toString()+" failed: "+r);for(var c=0;c<n.length;c++)n[c].status=4,n[c].abortReason=r}oi(e,t)}}),a)}function oi(e,t){var n=ai(e,t),r=br(n);return function(e,t,n){var r=function(r){var s,u=t[r],c=Pe(n,u.path),h=!1,f=void 0;if(l.assert(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),4===u.status)h=!0,f=u.abortReason,o=o.concat($n(e.serverSyncTree_,u.currentWriteId,!0));else if(0===u.status)if(u.retryCount>=25)h=!0,f="maxretry",o=o.concat($n(e.serverSyncTree_,u.currentWriteId,!0));else{var d=ni(e,u.path,a);u.currentInputSnapshot=d;var p=t[r].update(d.val());if(void 0!==p){Rr("transaction failed: Data returned ",p,u.path);var v=vt(p);"object"==typeof p&&null!=p&&l.contains(p,".priority")||(v=v.updatePriority(d.getPriority()));var y=u.currentWriteId,_=Yr(e),g=pr(v,d,_);u.currentOutputSnapshotRaw=v,u.currentOutputSnapshotResolved=g,u.currentWriteId=Xr(e),a.splice(a.indexOf(y),1),o=(o=o.concat(Jn(e.serverSyncTree_,u.path,g,u.currentWriteId,u.applyLocally))).concat($n(e.serverSyncTree_,y,!0))}else h=!0,f="nodata",o=o.concat($n(e.serverSyncTree_,u.currentWriteId,!0))}Wr(e.eventQueue_,n,o),o=[],h&&(t[r].status=2,s=t[r].unwatcher,setTimeout(s,Math.floor(0)),t[r].onComplete&&("nodata"===f?i.push((function(){return t[r].onComplete(null,!1,t[r].currentInputSnapshot)})):i.push((function(){return t[r].onComplete(new Error(f),!1,null)}))))};if(0===t.length)return;for(var i=[],o=[],a=t.filter((function(e){return 0===e.status})).map((function(e){return e.currentWriteId})),s=0;s<t.length;s++)r(s);li(e,e.transactionQueueTree_);for(var u=0;u<i.length;u++)Y(i[u]);ri(e,e.transactionQueueTree_)}(e,si(e,n),r),r}function ai(e,t){var n,r=e.transactionQueueTree_;for(n=we(t);null!==n&&void 0===gr(r);)r=_r(r,n),n=we(t=xe(t));return r}function si(e,t){var n=[];return ui(e,t,n),n.sort((function(e,t){return e.order-t.order})),n}function ui(e,t,n){var r=gr(t);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);Cr(t,(function(t){ui(e,t,n)}))}function li(e,t){var n=gr(t);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,mr(t,n.length>0?n:void 0)}Cr(t,(function(t){li(e,t)}))}function ci(e,t){var n=br(ai(e,t)),r=_r(e.transactionQueueTree_,t);return function(e,t,n){for(var r=n?e:e.parent;null!==r;){if(t(r))return!0;r=r.parent}}(r,(function(t){hi(e,t)})),hi(e,r),wr(r,(function(t){hi(e,t)})),n}function hi(e,t){var n=gr(t);if(n){for(var r=[],i=[],o=-1,a=0;a<n.length;a++)3===n[a].status||(1===n[a].status?(l.assert(o===a-1,"All SENT items should be at beginning of queue."),o=a,n[a].status=3,n[a].abortReason="set"):(l.assert(0===n[a].status,"Unexpected transaction status in abort"),n[a].unwatcher(),i=i.concat($n(e.serverSyncTree_,n[a].currentWriteId,!0)),n[a].onComplete&&r.push(n[a].onComplete.bind(null,new Error("set"),!1,null))));-1===o?mr(t,void 0):n.length=o+1,Wr(e.eventQueue_,br(t),i);for(var s=0;s<r.length;s++)Y(r[s])}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fi=function(e,t){var n=di(e),r=n.namespace;"firebase.com"===n.domain&&O(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||O("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&R("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new ne(n.host,n.secure,r,i,t,"",r!==n.subdomain),path:new ke(n.pathString)}},di=function(e){var t="",n="",r="",i="",o="",a=!0,s="https",u=443;if("string"==typeof e){var l=e.indexOf("//");l>=0&&(s=e.substring(0,l-1),e=e.substring(l+2));var c=e.indexOf("/");-1===c&&(c=e.length);var h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(c,h)),c<h&&(i=function(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(e){}t+="/"+i}return t}(e.substring(c,h)));var f=function(e){var t={};"?"===e.charAt(0)&&(e=e.substring(1));var n=!0,r=!1,i=void 0;try{for(var o,a=e.split("&")[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(0!==s.length){var u=s.split("=");2===u.length?t[decodeURIComponent(u[0])]=decodeURIComponent(u[1]):R("Invalid query segment '".concat(s,"' in query '").concat(e,"'"))}}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return t}(e.substring(Math.min(e.length,h)));(l=t.indexOf(":"))>=0?(a="https"===s||"wss"===s,u=parseInt(t.substring(l+1),10)):l=t.length;var d=t.slice(0,l);if("localhost"===d.toLowerCase())n="localhost";else if(d.split(".").length<=2)n=d;else{var p=t.indexOf(".");r=t.substring(0,p).toLowerCase(),n=t.substring(p+1),o=r}"ns"in f&&(o=f.ns)}return{host:t,port:u,domain:n,subdomain:r,secure:a,scheme:s,pathString:i,namespace:o}},pi=function(){"use strict";function e(t,n,r,o){i.classCallCheck(this,e),this._repo=t,this._path=n,this._queryParams=r,this._orderByCalled=o}return i.createClass(e,[{key:"key",get:function(){return Ne(this._path)?null:Ee(this._path)}},{key:"ref",get:function(){return new vi(this._repo,this._path)}},{key:"_queryIdentifier",get:function(){var e=Ot(this._queryParams),t=q(e);return"{}"===t?"default":t}},{key:"_queryObject",get:function(){return Ot(this._queryParams)}},{key:"isEqual",value:function(t){if(!((t=l.getModularInstance(t))instanceof e))return!1;var n=this._repo===t._repo,r=Re(this._path,t._path),i=this._queryIdentifier===t._queryIdentifier;return n&&r&&i}},{key:"toJSON",value:function(){return this.toString()}},{key:"toString",value:function(){return this._repo.toString()+function(e){for(var t="",n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}]),e}();var vi=function(e){"use strict";i.inherits(n,e);var t=i.createSuper(n);function n(e,r){return i.classCallCheck(this,n),t.call(this,e,r,new Nt,!1)}return i.createClass(n,[{key:"parent",get:function(){var e=Ie(this._path);return null===e?null:new n(this._repo,e)}},{key:"root",get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}}]),n}(pi),yi=function(){"use strict";function e(t,n,r){i.classCallCheck(this,e),this._node=t,this.ref=n,this._index=r}return i.createClass(e,[{key:"priority",get:function(){return this._node.getPriority().val()}},{key:"key",get:function(){return this.ref.key}},{key:"size",get:function(){return this._node.numChildren()}},{key:"child",value:function t(n){var r=new ke(n),i=t(this.ref);return new e(this._node.getChild(r),i,st)}},{key:"exists",value:function(){return!this._node.isEmpty()}},{key:"exportVal",value:function(){return this._node.val(!0)}},{key:"forEach",value:function(t){var n=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(function(r,i){return t(new e(i,gi(n.ref,r),st))}))}},{key:"hasChild",value:function(e){var t=new ke(e);return!this._node.getChild(t).isEmpty()}},{key:"hasChildren",value:function(){return!this._node.isLeafNode()&&!this._node.isEmpty()}},{key:"toJSON",value:function(){return this.exportVal()}},{key:"val",value:function(){return this._node.val()}}]),e}();function _i(e,t){return(e=l.getModularInstance(e))._checkNotDeleted("ref"),void 0!==t?gi(e._root,t):e._root}function gi(e,t){var n,r,i,o;return null===we((e=l.getModularInstance(e))._path)?(n="child",r="path",o=!1,(i=t)&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),Ar(n,r,i,o)):Ar("child","path",t,!1),new vi(e._repo,Te(e._path,t))}function mi(e){return Lr("remove",e._path),ki(e,null)}function ki(e,t){e=l.getModularInstance(e),Lr("set",e._path),Or("set",t,e._path,!1);var n=new l.Deferred;return $r(e._repo,e._path,t,null,n.wrapCallback((function(){}))),n.promise}function Ci(e,t){Dr("update",t,e._path,!1);var n=new l.Deferred;return function(e,t,n,r){ei(e,"update",{path:t.toString(),value:n});var i=!0,o=Yr(e),a={};if(U(n,(function(n,r){i=!1,a[n]=dr(Te(t,n),vt(r),e.serverSyncTree_,o)})),i)T("update() called with empty data.  Don't do anything."),ti(0,r,"ok",void 0);else{var s=Xr(e),u=Xn(e.serverSyncTree_,t,a,s);jr(e.eventQueue_,u),e.server_.merge(t.toString(),n,(function(n,i){var o="ok"===n;o||R("update at "+t+" failed: "+n);var a=$n(e.serverSyncTree_,s,!o),u=a.length>0?oi(e,t):t;Wr(e.eventQueue_,u,a),ti(0,r,n,i)})),U(n,(function(n){var r=ci(e,Te(t,n));oi(e,r)})),Wr(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback((function(){}))),n.promise}function wi(e){return function(e,t){var n=tr(e.serverSyncTree_,t);return null!=n?Promise.resolve(n):e.server_.get(t).then((function(n){var r=vt(n).withIndex(t._queryParams.getIndex()),i=Zn(e.serverSyncTree_,t._path,r);return qr(e.eventQueue_,t._path,i),Promise.resolve(r)}),(function(n){return ei(e,"get for query "+l.stringify(t)+" failed: "+n),Promise.reject(new Error(n))}))}((e=l.getModularInstance(e))._repo,e).then((function(t){return new yi(t,new vi(e._repo,e._path),e._queryParams.getIndex())}))}!function(e){l.assert(!qn,"__referenceConstructor has already been defined"),qn=e}(vi),function(e){l.assert(!Bn,"__referenceConstructor has already been defined"),Bn=e}(vi);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var bi={},xi=!1;function Ei(e,t,n,r,i){var o=r||e.options.databaseURL;void 0===o&&(e.options.projectId||O("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),T("Using default host for project ",e.options.projectId),o="".concat(e.options.projectId,"-default-rtdb.firebaseio.com"));var a,s=fi(o,i),u=s.repoInfo,l=void 0;void 0!==h&&h.env&&(l=h.env.FIREBASE_DATABASE_EMULATOR_HOST),l?(a=!0,o="http://".concat(l,"?ns=").concat(u.namespace),u=(s=fi(o,i)).repoInfo):a=!s.repoInfo.secure;var c=i&&a?new X(X.OWNER):new J(e.name,e.options,t);Mr("Invalid Firebase Database URL",s),Ne(s.path)||O("Database URL must point to the root of a Firebase Database (not including a child path).");var f=function(e,t,n,r){var i=bi[t.name];i||(i={},bi[t.name]=i);var o=i[e.toURLString()];o&&O("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return o=new Br(e,xi,n,r),i[e.toURLString()]=o,o}(u,e,c,new Q(e.name,n));return new Si(f,e)}var Si=function(){"use strict";function e(t,n){i.classCallCheck(this,e),this._repoInternal=t,this.app=n,this.type="database",this._instanceStarted=!1}return i.createClass(e,[{key:"_repo",get:function(){return this._instanceStarted||(Vr(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}},{key:"_root",get:function(){return this._rootInternal||(this._rootInternal=new vi(this._repo,Ce())),this._rootInternal}},{key:"_delete",value:function(){var e,t,n;return null!==this._rootInternal&&(e=this._repo,t=this.app.name,(n=bi[t])&&n[e.key]===e||O("Database ".concat(t,"(").concat(e.repoInfo_,") has already been deleted.")),Zr(e),delete n[e.key],this._repoInternal=null,this._rootInternal=null),Promise.resolve()}},{key:"_checkNotDeleted",value:function(e){null===this._rootInternal&&O("Cannot call "+e+" on a deleted database.")}}]),e}();function Ii(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.getApp(),t=arguments.length>1?arguments[1]:void 0;return s._getProvider(e,"database").getImmediate({identifier:t})}qe.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},qe.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var Ti,Ni;Ni=s.SDK_VERSION,p=Ni,s._registerComponent(new u.Component("database",(function(e,t){var n=t.instanceIdentifier;return Ei(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)}),"PUBLIC").setMultipleInstances(!0)),s.registerVersion(f,d,Ti),s.registerVersion(f,d,"esm2017")})),a.register("6qd2L",(function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var u,l=[],c=!1,h=-1;function f(){c&&u&&(c=!1,u.length?l=u.concat(l):h=-1,l.length&&d())}function d(){if(!c){var e=s(f);c=!0;for(var t=l.length;t;){for(u=l,l=[];++h<t;)u&&u[h].run();h=-1,t=l.length}u=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function v(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||c||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}}))}();
//# sourceMappingURL=index.0571f228.js.map
